var P=Object.defineProperty;var U=(O,e,t)=>e in O?P(O,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):O[e]=t;var y=(O,e,t)=>U(O,typeof e!="symbol"?e+"":e,t);import{C as _,l as N}from"./core-Bu-3NiyB.js";const l={MAX_CACHE_SIZE:1e3,CACHE_EXPIRY:3e5,UI:{TOOLTIP_SPACING:8,SMOOTH_SCROLL_DURATION:500,TOOLTIP_ID_LENGTH:8},SCORING:{PASSWORD_BASE_SCORE:20,PASSWORD_LENGTH_BONUS:10,PASSWORD_MIN_SECURE_LENGTH:12,PASSWORD_VARIETY_BONUS:15,PASSWORD_REPETITION_PENALTY:20,PASSWORD_STRENGTH_VERY_STRONG:80,PASSWORD_STRENGTH_STRONG:60,PASSWORD_STRENGTH_MODERATE:40,PASSWORD_STRENGTH_WEAK_THRESHOLD:60,ACCESSIBILITY_SCORE_PENALTY:25,NEUTRAL_SCORE:50,EXCELLENT_THRESHOLD:90,GOOD_THRESHOLD:80,SATISFACTORY_THRESHOLD:70,NEEDS_IMPROVEMENT_THRESHOLD:60,POOR_THRESHOLD:50,PASSING_THRESHOLD:60,SIGNIFICANT_CHANGE_THRESHOLD:20,POOR_PERFORMANCE_THRESHOLD:50,AVERAGE_PERFORMANCE_THRESHOLD:70,EXCELLENT_PERFORMANCE_THRESHOLD:90,DECLINING_TREND_THRESHOLD:-10,MAX_RECOMMENDATIONS:5},TEXT_ANALYSIS:{EXCESSIVE_CAPS_PENALTY:50,EXCESSIVE_PUNCTUATION_PENALTY:20,PUNCTUATION_THRESHOLD:.1,PUNCTUATION_PENALTY:15,MAX_WORDS_PER_SENTENCE:20},TIME:{SECONDS_PER_MINUTE:60,HOURS_PER_DAY:24,DAYS_PER_WEEK:7,DAYS_PER_MONTH:30,DAYS_PER_YEAR:365,MILLISECONDS_PER_SECOND:1e3,SUNDAY:0,SATURDAY:6,URL_CLEANUP_DELAY:1e3,GOOD_DECISION_TIME:3e4,QUICK_DECISION_TIME:1e4,SLOW_DECISION_TIME:6e4,QUICK_DECISION_RATIO:.5,FRAME_RATE_TARGET:16.67},get WEEKEND_DAYS(){return[this.TIME.SUNDAY,this.TIME.SATURDAY]},DEVICE:{MOBILE_BREAKPOINT:576,TABLET_BREAKPOINT:768,DESKTOP_BREAKPOINT:992,LARGE_DESKTOP_BREAKPOINT:1200,HIGH_DPI_THRESHOLD:1.5,LOW_BATTERY_THRESHOLD:.2},GENERATION:{ID_RADIX:36,ID_START_INDEX:2,ID_END_INDEX:11},FILE_SIZE:{BYTES_PER_KB:1024,KB_PER_MB:1024,DEFAULT_TEXT_LIMIT_MB:100,DEFAULT_BINARY_LIMIT_MB:50,SMALL_BINARY_LIMIT_MB:10,CONTROL_CHAR_THRESHOLD:32},ANIMATION:{EASING_THRESHOLD:.5,EASING_FACTOR_4:4,EASING_FACTOR_2:2,BOUNCE_DIVISOR:2.75,BOUNCE_MULTIPLIER:7.5625,BOUNCE_OFFSET_1_5:1.5,BOUNCE_OFFSET_2:2,BOUNCE_OFFSET_2_25:2.25,BOUNCE_OFFSET_2_5:2.5,BOUNCE_OFFSET_2_625:2.625,BOUNCE_RETURN_0_75:.75,BOUNCE_RETURN_0_9375:.9375,BOUNCE_RETURN_0_984375:.984375,ELASTIC_PERIOD_DIVISOR:4,FRAME_DELTA_TARGET:.016},ANALYSIS:{SLOW_DECISION_RATIO:.3,HIGH_PERFORMANCE_THRESHOLD:80,LOW_PERFORMANCE_THRESHOLD:40,ETHICS_WARNING_THRESHOLD:70,COMPLETION_WARNING_THRESHOLD:80,CRITICAL_VALUE_THRESHOLD:50,EXTENDED_RECOMMENDATIONS:8},COLOR:{RGB_MAX:255,HEX_SHORT_LENGTH:3,HEX_SHIFT_ALPHA:24,HEX_SHIFT_RED:16,HEX_SHIFT_GREEN:8,HEX_BASE:16,THRESHOLD_LOW:30,THRESHOLD_MEDIUM:60,THRESHOLD_HIGH:50,LUMINANCE_OFFSET:.05,LUMINANCE_THRESHOLD:.03928,LUMINANCE_DIVISOR:12.92,LUMINANCE_OFFSET_2:.055,LUMINANCE_DIVISOR_2:1.055,LUMINANCE_EXPONENT:2.4,LUMINANCE_RED_WEIGHT:.2126,LUMINANCE_GREEN_WEIGHT:.7152,LUMINANCE_BLUE_WEIGHT:.0722,HSL_HUE_CIRCLE:360,HSL_HUE_SECTIONS:6,HSL_HUE_RED_OFFSET:4,HSL_LIGHTNESS_THRESHOLD:.5,HSL_SATURATION_DIVISOR:2,FACTOR_LIGHTEN:.8},ACCESSIBILITY_COLORS:{HIGH_CONTRAST:{background:"#000000",text:"#ffffff",primary:"#ffff00",secondary:"#00ffff",danger:"#ff0000",success:"#00ff00"},LIGHT_MODE:{background:"#ffffff",text:"#333333",primary:"#007bff",secondary:"#28a745",danger:"#dc3545",success:"#28a745"}}};class w{static set(e,t,n=l.CACHE_EXPIRY){const r=Date.now()+n;this.cache.set(e,{value:t,expiry:r}),this.accessTimes.set(e,Date.now()),this.cleanup()}static get(e){const t=this.cache.get(e);return t?Date.now()>t.expiry?(this.cache.delete(e),this.accessTimes.delete(e),null):(this.accessTimes.set(e,Date.now()),t.value):null}static cleanup(){if(!(this.cache.size<=l.MAX_CACHE_SIZE)){for(const[e,t]of this.cache.entries())Date.now()>t.expiry&&(this.cache.delete(e),this.accessTimes.delete(e));this.cache.size>l.MAX_CACHE_SIZE&&[...this.accessTimes.entries()].sort(([,t],[,n])=>t-n).slice(0,this.cache.size-l.MAX_CACHE_SIZE).forEach(([t])=>{this.cache.delete(t),this.accessTimes.delete(t)})}}static clear(){this.cache.clear(),this.accessTimes.clear()}}y(w,"cache",new Map),y(w,"accessTimes",new Map);class F{static getCurrentTheme(){const e=window.matchMedia("(prefers-contrast: high)").matches,t=window.matchMedia("(prefers-reduced-motion: reduce)").matches;return{highContrast:e,reducedMotion:t,theme:e?"highContrast":"light"}}static getThemeColors(e=null){return(e||this.getCurrentTheme()).highContrast?l.ACCESSIBILITY_COLORS.HIGH_CONTRAST:l.ACCESSIBILITY_COLORS.LIGHT_MODE}static applyTheme(e,t=null){const n=this.getThemeColors(t),r=t||this.getCurrentTheme();return e.style.backgroundColor=n.background,e.style.color=n.text,e.classList.remove("theme-light","theme-high-contrast"),e.classList.add(`theme-${r.theme}`),r.reducedMotion&&e.classList.add("reduce-motion"),n}static createThemeObserver(e){const t=[],n=window.matchMedia("(prefers-contrast: high)"),r=c=>e("highContrast",c.matches);n.addEventListener("change",r),t.push(()=>n.removeEventListener("change",r));const o=window.matchMedia("(prefers-reduced-motion: reduce)"),i=c=>e("reducedMotion",c.matches);return o.addEventListener("change",i),t.push(()=>o.removeEventListener("change",i)),()=>t.forEach(c=>c())}}class B{static clamp(e,t,n){return typeof e!="number"||isNaN(e)?t:Math.min(Math.max(e,t),n)}static lerp(e,t,n){return n=this.clamp(n,0,1),e+(t-e)*n}static map(e,t,n,r,o){if(n===t)return r;const i=(e-t)/(n-t);return r+(o-r)*i}static randomBetween(e,t){return Math.random()*(t-e)+e}static randomInt(e,t){return Math.floor(Math.random()*(t-e+1))+e}static roundTo(e,t){return typeof e!="number"||isNaN(e)?0:+`${Math.round(`${e}e${t}`)}e-${t}`}static mean(e){if(!Array.isArray(e)||e.length===0)return 0;const t=e.filter(n=>typeof n=="number"&&!isNaN(n));return t.length>0?t.reduce((n,r)=>n+r,0)/t.length:0}static median(e){if(!Array.isArray(e)||e.length===0)return 0;const t=e.filter(r=>typeof r=="number"&&!isNaN(r)).sort((r,o)=>r-o),n=Math.floor(t.length/2);return t.length%2===0?(t[n-1]+t[n])/2:t[n]}static standardDeviation(e){const t=this.mean(e),r=e.filter(o=>typeof o=="number"&&!isNaN(o)).map(o=>Math.pow(o-t,2));return Math.sqrt(this.mean(r))}static correlation(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length||e.length===0)return 0;const n=this.mean(e),r=this.mean(t);let o=0,i=0,c=0;for(let a=0;a<e.length;a++){const u=e[a]-n,f=t[a]-r;o+=u*f,i+=u*u,c+=f*f}const s=Math.sqrt(i*c);return s===0?0:o/s}static shuffleArray(e){if(!Array.isArray(e))return[];const t=[...e];for(let n=t.length-1;n>0;n--){const r=Math.floor(Math.random()*(n+1));[t[n],t[r]]=[t[r],t[n]]}return t}static getRandomElement(e){if(!(!Array.isArray(e)||e.length===0))return e[Math.floor(Math.random()*e.length)]}static getRandomElements(e,t){if(!Array.isArray(e)||t<=0)return[];const n=this.shuffleArray(e);return n.slice(0,Math.min(t,n.length))}static groupBy(e,t){return!Array.isArray(e)||typeof t!="function"?{}:e.reduce((n,r)=>{const o=t(r);return n[o]||(n[o]=[]),n[o].push(r),n},{})}static unique(e,t=null){if(!Array.isArray(e))return[];if(t&&typeof t=="function"){const n=new Set;return e.filter(r=>{const o=t(r);return n.has(o)?!1:(n.add(o),!0)})}return[...new Set(e)]}static chunk(e,t){if(!Array.isArray(e)||t<=0)return[];const n=[];for(let r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}static flatten(e,t=1/0){return Array.isArray(e)?t>0?e.reduce((n,r)=>n.concat(Array.isArray(r)?this.flatten(r,t-1):r),[]):e.slice():[]}static intersection(...e){return e.length===0?[]:e.length===1?Array.isArray(e[0])?[...e[0]]:[]:e.reduce((t,n)=>Array.isArray(n)?t.filter(r=>n.includes(r)):[])}static sortBy(e,t){return!Array.isArray(e)||!Array.isArray(t)?[...e]:[...e].sort((n,r)=>{for(const o of t){const{key:i,direction:c="asc"}=o,s=typeof i=="function"?i(n):n[i],a=typeof i=="function"?i(r):r[i];if(s<a)return c==="asc"?-1:1;if(s>a)return c==="asc"?1:-1}return 0})}static capitalize(e){return typeof e!="string"||e.length===0?"":e.charAt(0).toUpperCase()+e.slice(1)}static camelToKebab(e){return typeof e!="string"?"":e.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g,"$1-$2").toLowerCase()}static kebabToCamel(e){return typeof e!="string"?"":e.replace(/-([a-z])/g,t=>t[1].toUpperCase())}static truncateText(e,t,n="..."){return typeof e!="string"||e.length<=t?e:e.substring(0,t-n.length)+n}static stripHtml(e){if(typeof e!="string")return"";const t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}static escapeHtml(e){if(typeof e!="string")return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}static generateRandomString(e=12,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"){let n="";const r=t.length;if(window.crypto&&window.crypto.getRandomValues){const o=new Uint8Array(e);window.crypto.getRandomValues(o);for(let i=0;i<e;i++)n+=t[o[i]%r]}else for(let o=0;o<e;o++)n+=t[Math.floor(Math.random()*r)];return n}static createSlug(e,t=50){return typeof e!="string"?"":e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").substring(0,t).replace(/-$/,"")}static formatForScreenReader(e,t={}){if(typeof e!="string")return"";const{expandAbbreviations:n=!0,addPunctuation:r=!0,slowDown:o=!1}=t;let i=e;return n&&Object.entries({AI:"Artificial Intelligence",ML:"Machine Learning",UI:"User Interface",UX:"User Experience",API:"Application Programming Interface"}).forEach(([s,a])=>{const u=new RegExp(`\\b${s}\\b`,"gi");i=i.replace(u,a)}),r&&!i.match(/[.!?]$/)&&(i+="."),o&&(i=i.replace(/[.!?]/g,"$&Â ")),i}static assessTextAccessibility(e){if(typeof e!="string")return{score:0,issues:["Invalid input"]};const t=[];let n=100;e.length===0&&(t.push("Text is empty"),n-=l.TEXT_ANALYSIS.EXCESSIVE_CAPS_PENALTY),e.length>10&&e===e.toUpperCase()&&(t.push("Text is all uppercase"),n-=l.TEXT_ANALYSIS.EXCESSIVE_PUNCTUATION_PENALTY),(e.match(/[!?]{2,}/g)||[]).length/e.length>l.TEXT_ANALYSIS.PUNCTUATION_THRESHOLD&&(t.push("Excessive punctuation detected"),n-=l.TEXT_ANALYSIS.PUNCTUATION_PENALTY);const o=e.split(/[.!?]+/).filter(s=>s.trim().length>0),i=e.split(/\s+/).filter(s=>s.length>0),c=i.length/Math.max(o.length,1);return c>l.TEXT_ANALYSIS.MAX_WORDS_PER_SENTENCE&&(t.push("Sentences may be too long"),n-=10),{score:Math.max(0,n),issues:t,wordCount:i.length,sentenceCount:o.length,avgWordsPerSentence:this.roundTo(c,1)}}static formatDuration(e,t={}){if(typeof e!="number"||e<0)return"0s";const{includeMilliseconds:n=!1,verbose:r=!1,screenReader:o=!1}=t,i=Math.floor(e/1e3),c=Math.floor(i/_.MINUTES_60),s=Math.floor(c/_.MINUTES_60),a=Math.floor(s/_.HOURS_24);if(r||o){const u=[];return a>0&&u.push(`${a} day${a>1?"s":""}`),s%_.HOURS_24>0&&u.push(`${s%_.HOURS_24} hour${s%_.HOURS_24>1?"s":""}`),c%l.TIME.SECONDS_PER_MINUTE>0&&u.push(`${c%l.TIME.SECONDS_PER_MINUTE} minute${c%l.TIME.SECONDS_PER_MINUTE>1?"s":""}`),i%_.MINUTES_60>0&&u.push(`${i%_.MINUTES_60} second${i%_.MINUTES_60>1?"s":""}`),u.length===0?o?"0 seconds":"0s":u.join(o?", ":" ")}return a>0?`${a}d ${s%_.HOURS_24}h ${c%_.MINUTES_60}m`:s>0?`${s}:${(c%l.TIME.SECONDS_PER_MINUTE).toString().padStart(2,"0")}:${(i%l.TIME.SECONDS_PER_MINUTE).toString().padStart(2,"0")}`:c>0?`${c}:${(i%l.TIME.SECONDS_PER_MINUTE).toString().padStart(2,"0")}`:n?`${i}.${Math.floor(e%l.TIME.MILLISECONDS_PER_SECOND/100)}s`:`${i}s`}static formatTimestamp(e,t="short"){if(typeof e!="number"||isNaN(e))return"Invalid date";const n=new Date(e);if(typeof t=="string")switch(t){case"short":return n.toLocaleDateString();case"long":return`${n.toLocaleDateString()} ${n.toLocaleTimeString()}`;case"time":return n.toLocaleTimeString();case"iso":return n.toISOString();case"relative":return this.getTimeAgo(e);case"accessible":return n.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"});default:return n.toString()}const r={locale:"en-US",includeTime:!0,includeWeekday:!1,...t},o={year:"numeric",month:r.monthFormat||"short",day:"numeric"};return r.includeWeekday&&(o.weekday="long"),r.includeTime&&(o.hour="numeric",o.minute="2-digit"),n.toLocaleDateString(r.locale,o)}static getTimeAgo(e,t={}){if(typeof e!="number"||isNaN(e))return"Unknown time";const{precise:n=!1,shortForm:r=!1}=t,i=Date.now()-e;if(i<0)return"In the future";const c=[{name:"year",short:"y",ms:l.TIME.DAYS_PER_YEAR*l.TIME.HOURS_PER_DAY*l.TIME.SECONDS_PER_MINUTE*l.TIME.SECONDS_PER_MINUTE*l.TIME.MILLISECONDS_PER_SECOND},{name:"month",short:"mo",ms:l.TIME.DAYS_PER_MONTH*l.TIME.HOURS_PER_DAY*l.TIME.SECONDS_PER_MINUTE*l.TIME.SECONDS_PER_MINUTE*l.TIME.MILLISECONDS_PER_SECOND},{name:"week",short:"w",ms:l.TIME.DAYS_PER_WEEK*l.TIME.HOURS_PER_DAY*l.TIME.SECONDS_PER_MINUTE*l.TIME.SECONDS_PER_MINUTE*l.TIME.MILLISECONDS_PER_SECOND},{name:"day",short:"d",ms:l.TIME.HOURS_PER_DAY*l.TIME.SECONDS_PER_MINUTE*l.TIME.SECONDS_PER_MINUTE*l.TIME.MILLISECONDS_PER_SECOND},{name:"hour",short:"h",ms:l.TIME.SECONDS_PER_MINUTE*l.TIME.SECONDS_PER_MINUTE*l.TIME.MILLISECONDS_PER_SECOND},{name:"minute",short:"m",ms:l.TIME.SECONDS_PER_MINUTE*l.TIME.MILLISECONDS_PER_SECOND},{name:"second",short:"s",ms:l.TIME.MILLISECONDS_PER_SECOND}];for(const s of c)if(i>=s.ms){const a=Math.floor(i/s.ms),u=r?s.short:s.name,f=!r&&a>1?"s":"";if(n&&c.indexOf(s)<c.length-1){const d=c[c.indexOf(s)+1],h=Math.floor(i%s.ms/d.ms);if(h>0){const m=r?d.short:d.name,p=!r&&h>1?"s":"";return`${a}${u}${f} ${h}${m}${p} ago`}}return`${a}${r?"":" "}${u}${f}${r?"":" ago"}`}return"Just now"}static parseDate(e){if(e instanceof Date)return e;if(typeof e=="number")return new Date(e);if(typeof e!="string")return null;if(e.match(/^\d{4}-\d{2}-\d{2}(T\d{2}:\d{2}:\d{2}(\.\d{3})?Z?)?$/)){const r=new Date(e);return isNaN(r.getTime())?null:r}const n=[/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/,/^(\d{4})\/(\d{1,2})\/(\d{1,2})$/,/^(\d{1,2})-(\d{1,2})-(\d{4})$/,/^(\d{4})-(\d{1,2})-(\d{1,2})$/];for(const r of n)if(e.match(r)){const i=new Date(e);return isNaN(i.getTime())?null:i}return null}static calculateBusinessDays(e,t,n=l.WEEKEND_DAYS){if(!(e instanceof Date)||!(t instanceof Date))return 0;let r=0;const o=new Date(e);for(;o<=t;)n.includes(o.getDay())||r++,o.setDate(o.getDate()+1);return r}static hexToRgb(e){if(typeof e!="string"||(e=e.replace("#",""),!/^[0-9A-Fa-f]{6}$/.test(e)&&!/^[0-9A-Fa-f]{3}$/.test(e)))return null;e.length===l.COLOR.HEX_SHORT_LENGTH&&(e=e.split("").map(n=>n+n).join(""));const t=/^([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}static rgbToHex(e,t,n){return e=this.clamp(Math.round(e),0,l.COLOR.RGB_MAX),t=this.clamp(Math.round(t),0,l.COLOR.RGB_MAX),n=this.clamp(Math.round(n),0,l.COLOR.RGB_MAX),`#${((1<<l.COLOR.HEX_SHIFT_ALPHA)+(e<<l.COLOR.HEX_SHIFT_RED)+(t<<l.COLOR.HEX_SHIFT_GREEN)+n).toString(l.COLOR.HEX_BASE).slice(1)}`}static interpolateColor(e,t,n){const r=this.hexToRgb(e),o=this.hexToRgb(t);if(!r||!o)return e;n=this.clamp(n,0,1);const i=Math.round(this.lerp(r.r,o.r,n)),c=Math.round(this.lerp(r.g,o.g,n)),s=Math.round(this.lerp(r.b,o.b,n));return this.rgbToHex(i,c,s)}static getEthicsColor(e,t={}){const{highContrast:n=!1,colorBlindSafe:r=!1}=t;return e=this.clamp(e,0,100),n?e<l.COLOR.THRESHOLD_LOW?"#ff0000":e<l.COLOR.THRESHOLD_MEDIUM?"#ffff00":"#00ff00":r?e<l.COLOR.THRESHOLD_LOW?"#d73027":e<l.COLOR.THRESHOLD_MEDIUM?"#fee08b":"#4575b4":e<l.COLOR.THRESHOLD_HIGH?this.interpolateColor("#ff4444","#ffaa00",e/l.COLOR.THRESHOLD_HIGH):this.interpolateColor("#ffaa00","#00aa00",(e-l.COLOR.THRESHOLD_HIGH)/l.COLOR.THRESHOLD_HIGH)}static getContrastRatio(e,t){const n=this.hexToRgb(e),r=this.hexToRgb(t);if(!n||!r)return 1;const o=this.getLuminance(n),i=this.getLuminance(r),c=Math.max(o,i),s=Math.min(o,i);return(c+l.COLOR.LUMINANCE_OFFSET)/(s+l.COLOR.LUMINANCE_OFFSET)}static getLuminance(e){const{r:t,g:n,b:r}=e,[o,i,c]=[t,n,r].map(s=>(s=s/l.COLOR.RGB_MAX,s<=l.COLOR.LUMINANCE_THRESHOLD?s/l.COLOR.LUMINANCE_DIVISOR:Math.pow((s+l.COLOR.LUMINANCE_OFFSET_2)/l.COLOR.LUMINANCE_DIVISOR_2,l.COLOR.LUMINANCE_EXPONENT)));return l.COLOR.LUMINANCE_RED_WEIGHT*o+l.COLOR.LUMINANCE_GREEN_WEIGHT*i+l.COLOR.LUMINANCE_BLUE_WEIGHT*c}static checkColorAccessibility(e,t,n="AA"){const r=this.getContrastRatio(e,t),o={AA:{normal:4.5,large:3},AAA:{normal:7,large:4.5}},i=o[n]||o.AA;return{ratio:this.roundTo(r,2),passesNormal:r>=i.normal,passesLarge:r>=i.large,level:n,grade:r>=i.normal?"Pass":"Fail",recommendation:r<i.normal?`Increase contrast to at least ${i.normal}:1`:"Contrast meets accessibility guidelines"}}static generateAccessiblePalette(e,t={}){const{steps:n=5,lightBackground:r="#ffffff"}=t;if(!this.hexToRgb(e))return null;const i={base:e,variations:[],accessible:{onLight:[]}};for(let c=0;c<n;c++){const s=c/(n-1),a=this.interpolateColor(e,"#ffffff",s*l.COLOR.FACTOR_LIGHTEN);i.variations.push({light:a,factor:this.roundTo(s,2)});const u=this.checkColorAccessibility(a,r);u.passesNormal&&i.accessible.onLight.push({color:a,contrast:u.ratio})}return i}static convertColor(e,t="hex"){const n=this.parseColorToRgb(e);if(!n)return null;switch(t.toLowerCase()){case"hex":return this.rgbToHex(n.r,n.g,n.b);case"rgb":return`rgb(${n.r}, ${n.g}, ${n.b})`;case"hsl":{const r=this.rgbToHsl(n);return`hsl(${r.h}, ${r.s}%, ${r.l}%)`}case"object":return n;default:return e}}static parseColorToRgb(e){if(typeof e!="string")return null;if(e.startsWith("#"))return this.hexToRgb(e);const t=e.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(t)return{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)};const r={red:"#ff0000",green:"#008000",blue:"#0000ff",white:"#ffffff",black:"#000000",yellow:"#ffff00",cyan:"#00ffff",magenta:"#ff00ff"}[e.toLowerCase()];return r?this.hexToRgb(r):null}static rgbToHsl(e){let{r:t,g:n,b:r}=e;t/=l.COLOR.RGB_MAX,n/=l.COLOR.RGB_MAX,r/=l.COLOR.RGB_MAX;const o=Math.max(t,n,r),i=Math.min(t,n,r);let c,s;const a=(o+i)/2;if(o===i)c=s=0;else{const u=o-i;switch(s=a>l.COLOR.HSL_LIGHTNESS_THRESHOLD?u/(l.COLOR.HSL_SATURATION_DIVISOR-o-i):u/(o+i),o){case t:c=(n-r)/u+(n<r?l.COLOR.HSL_HUE_SECTIONS:0);break;case n:c=(r-t)/u+2;break;case r:c=(t-n)/u+l.COLOR.HSL_HUE_RED_OFFSET;break}c/=l.COLOR.HSL_HUE_SECTIONS}return{h:Math.round(c*l.COLOR.HSL_HUE_CIRCLE),s:Math.round(s*100),l:Math.round(a*100)}}static createElement(e,t="",n={}){if(typeof e!="string"||e.trim()==="")throw new Error("Invalid tag name provided");const r=document.createElement(e);return typeof t=="object"&&t!==null&&(n={...t,...n},t=n.className||""),t&&(r.className=t),Object.entries(n).forEach(([o,i])=>{o==="style"&&typeof i=="object"?Object.assign(r.style,i):o==="dataset"&&typeof i=="object"?Object.entries(i).forEach(([c,s])=>{r.dataset[c]=s}):o==="listeners"&&typeof i=="object"?Object.entries(i).forEach(([c,s])=>{r.addEventListener(c,s)}):o==="children"&&Array.isArray(i)?i.forEach(c=>{c instanceof HTMLElement?r.appendChild(c):typeof c=="string"&&r.appendChild(document.createTextNode(c))}):o==="innerHTML"?r.innerHTML=i:o==="textContent"?r.textContent=i:o!=="className"&&r.setAttribute(o,i)}),r}static getElementPosition(e,t={}){if(!(e instanceof HTMLElement))return{x:0,y:0,width:0,height:0,visible:!1};const{includeMargin:n=!1,includePadding:r=!1,relativeTo:o=null}=t,i=e.getBoundingClientRect(),c=window.getComputedStyle(e),s={x:i.left+window.scrollX,y:i.top+window.scrollY,width:i.width,height:i.height,top:i.top,left:i.left,bottom:i.bottom,right:i.right,visible:this.isElementVisible(e)};if(n){const a={top:parseFloat(c.marginTop)||0,right:parseFloat(c.marginRight)||0,bottom:parseFloat(c.marginBottom)||0,left:parseFloat(c.marginLeft)||0};s.margin=a,s.outerWidth=s.width+a.left+a.right,s.outerHeight=s.height+a.top+a.bottom}if(r){const a={top:parseFloat(c.paddingTop)||0,right:parseFloat(c.paddingRight)||0,bottom:parseFloat(c.paddingBottom)||0,left:parseFloat(c.paddingLeft)||0};s.padding=a,s.innerWidth=s.width-a.left-a.right,s.innerHeight=s.height-a.top-a.bottom}if(o&&o instanceof HTMLElement){const a=o.getBoundingClientRect();s.relativeX=i.left-a.left,s.relativeY=i.top-a.top}return s}static isElementVisible(e,t={}){if(!(e instanceof HTMLElement))return!1;const{threshold:n=0,partial:r=!1,checkOpacity:o=!0,checkDisplay:i=!0,returnDetails:c=!1}=t,s=e.getBoundingClientRect(),a=window.getComputedStyle(e),u={width:window.innerWidth||document.documentElement.clientWidth,height:window.innerHeight||document.documentElement.clientHeight},f={inViewport:!1,percentageVisible:0,opacity:parseFloat(a.opacity),display:a.display,visibility:a.visibility,dimensions:{width:s.width,height:s.height}};if(i&&(a.display==="none"||a.visibility==="hidden")||o&&f.opacity<=0)return c?f:!1;const d=Math.max(0,Math.min(s.right,u.width)-Math.max(s.left,0)),h=Math.max(0,Math.min(s.bottom,u.height)-Math.max(s.top,0)),m=d*h,p=s.width*s.height;return f.percentageVisible=p>0?m/p*100:0,f.inViewport=f.percentageVisible>=n,r&&(f.inViewport=f.percentageVisible>0),c?f:f.inViewport}static scrollToElement(e,t={}){if(!(e instanceof HTMLElement))return;const{behavior:n="smooth",block:r="center",inline:o="nearest",offset:i=0,respectReducedMotion:c=!0,focus:s=!1,announceToScreenReader:a=!1}=t,u=window.matchMedia("(prefers-reduced-motion: reduce)").matches,f=c&&u?"auto":n;if(i!==0){const h=e.getBoundingClientRect().top+window.scrollY+i;window.scrollTo({top:h,behavior:f})}else e.scrollIntoView({behavior:f,block:r,inline:o});if(s&&(!e.hasAttribute("tabindex")&&!e.matches("a, button, input, select, textarea")&&e.setAttribute("tabindex","-1"),setTimeout(()=>{e.focus(),e.getAttribute("tabindex")==="-1"&&!e.matches("a, button, input, select, textarea")&&e.removeAttribute("tabindex")},f==="smooth"?l.UI.SMOOTH_SCROLL_DURATION:0)),a){const d=`Scrolled to ${e.textContent||e.getAttribute("aria-label")||"content"}`;this.announceToScreenReader(d)}}static announceToScreenReader(e,t="polite"){const n=document.createElement("div");n.setAttribute("aria-live",t),n.setAttribute("aria-atomic","true"),n.style.position="absolute",n.style.left="-10000px",n.style.width="1px",n.style.height="1px",n.style.overflow="hidden",document.body.appendChild(n),n.textContent=e,setTimeout(()=>{document.body.removeChild(n)},1e3)}static createAccessibleTooltip(e,t,n={}){const{position:r="top",delay:o=500,hideDelay:i=100,className:c="tooltip",id:s=`tooltip-${this.generateRandomString(l.UI.TOOLTIP_ID_LENGTH)}`}=n,a=this.createElement("div",{id:s,className:`${c} ${c}--${r}`,role:"tooltip","aria-hidden":"true",textContent:t,style:{position:"absolute",zIndex:"9999",visibility:"hidden",opacity:"0",transition:"opacity 0.2s, visibility 0.2s"}});document.body.appendChild(a),e.setAttribute("aria-describedby",s);let u,f;const d=()=>{clearTimeout(f),u=setTimeout(()=>{const m=e.getBoundingClientRect(),p=a.getBoundingClientRect();let E,g;switch(r){case"top":E=m.top-p.height-l.UI.TOOLTIP_SPACING,g=m.left+(m.width-p.width)/2;break;case"bottom":E=m.bottom+l.UI.TOOLTIP_SPACING,g=m.left+(m.width-p.width)/2;break;case"left":E=m.top+(m.height-p.height)/2,g=m.left-p.width-l.UI.TOOLTIP_SPACING;break;case"right":E=m.top+(m.height-p.height)/2,g=m.right+l.UI.TOOLTIP_SPACING;break}a.style.top=`${E+window.scrollY}px`,a.style.left=`${g+window.scrollX}px`,a.style.visibility="visible",a.style.opacity="1",a.setAttribute("aria-hidden","false")},o)},h=()=>{clearTimeout(u),f=setTimeout(()=>{a.style.visibility="hidden",a.style.opacity="0",a.setAttribute("aria-hidden","true")},i)};return e.addEventListener("mouseenter",d),e.addEventListener("mouseleave",h),e.addEventListener("focus",d),e.addEventListener("blur",h),a}static debounce(e,t,n={}){const{immediate:r=!1,maxWait:o=null,trackPerformance:i=!1,context:c=null}=n;let s,a,u=0;const f=function(...h){const m=Date.now(),p=c||this,E=()=>{if(s=null,a=null,!r)if(i){const T=performance.now(),I=e.apply(p,h),R=performance.now()-T;return N.debug(`Debounced function executed in ${R.toFixed(2)}ms`),I}else return e.apply(p,h)},g=r&&!s;if(clearTimeout(s),a&&clearTimeout(a),s=setTimeout(E,t),o&&m-u>=o?(E(),u=m):o&&!a&&(a=setTimeout(E,o-(m-u))),g)return u=m,e.apply(p,h)};return f.cancel=()=>{clearTimeout(s),a&&clearTimeout(a),s=a=null},f.flush=(...d)=>{if(s)return clearTimeout(s),s=null,e.apply(c,d)},f}static throttle(e,t,n={}){const{leading:r=!0,trailing:o=!0,respectReducedMotion:i=!0,trackPerformance:c=!1}=n;let s,a;return function(...f){i&&window.matchMedia("(prefers-reduced-motion: reduce)").matches&&(t=Math.max(t,100));const d=this,h=Date.now();if(!a&&r){if(c){const m=performance.now();e.apply(d,f);const p=performance.now()-m;N.debug(`Throttled function (leading) executed in ${p.toFixed(2)}ms`)}else e.apply(d,f);a=h}else clearTimeout(s),s=setTimeout(()=>{if(h-a>=t&&o){if(c){const m=performance.now();e.apply(d,f);const p=performance.now()-m;N.debug(`Throttled function (trailing) executed in ${p.toFixed(2)}ms`)}else e.apply(d,f);a=Date.now()}},t-(h-a))}}static once(e,t={}){const{resetAfter:n=null,trackCalls:r=!1}=t;let o=!1,i=0,c;const s=function(...u){return i++,r&&o&&N.warn(`Function called ${i} times, but can only execute once`),o||(o=!0,c=e.apply(this,u),n&&typeof n=="number"&&setTimeout(()=>{o=!1,i=0},n)),c};return s.reset=()=>{o=!1,i=0,c=void 0},s.hasBeenCalled=()=>o,s.getCallCount=()=>i,s}static createEventHandler(e,t,n,r={}){const{once:o=!1,passive:i=!0,capture:c=!1,debounce:s=null,throttle:a=null,preventDefault:u=!1,stopPropagation:f=!1,trackPerformance:d=!1}=r;let h=n;if(d){const p=h;h=function(...E){const g=performance.now(),T=p.apply(this,E),I=performance.now()-g;return N.debug(`Event handler for ${t} executed in ${I.toFixed(2)}ms`),T}}if(u||f){const p=h;h=function(E,...g){return u&&E.preventDefault(),f&&E.stopPropagation(),p.apply(this,[E,...g])}}s?h=this.debounce(h,s):a&&(h=this.throttle(h,a));const m={once:o,passive:i,capture:c};return e.addEventListener(t,h,m),()=>e.removeEventListener(t,h,m)}static createKeyboardNavigation(e,t={}){const{selector:n="[tabindex], a, button, input, select, textarea",circular:r=!0,skipHidden:o=!0,announceNavigation:i=!0}=t;let c=0,s=[];const a=()=>{s=Array.from(e.querySelectorAll(n)).filter(d=>!o||this.isElementVisible(d))},u=d=>{if(a(),s.length===0)return;const h=c;d==="next"?c=r?(c+1)%s.length:Math.min(c+1,s.length-1):d==="previous"?c=r?(c-1+s.length)%s.length:Math.max(c-1,0):d==="first"?c=0:d==="last"&&(c=s.length-1);const m=s[c];if(m&&(m.focus(),i&&c!==h)){const p=`Focused on ${m.textContent||m.getAttribute("aria-label")||"interactive element"}`;this.announceToScreenReader(p)}},f=d=>{switch(d.key){case"ArrowDown":case"ArrowRight":d.preventDefault(),u("next");break;case"ArrowUp":case"ArrowLeft":d.preventDefault(),u("previous");break;case"Home":d.preventDefault(),u("first");break;case"End":d.preventDefault(),u("last");break}};return e.addEventListener("keydown",f),a(),{navigate:u,updateElements:a,getCurrentElement:()=>s[c],destroy:()=>e.removeEventListener("keydown",f)}}static validateEmail(e,t={}){const{allowInternational:n=!0,maxLength:r=254,blockedDomains:o=[],requireTld:i=!0}=t;if(typeof e!="string")return{valid:!1,error:"Email must be a string"};if(e.length>r)return{valid:!1,error:`Email exceeds maximum length of ${r}`};if(!(n?/^[^\s@]+@[^\s@]+\.[^\s@]+$/:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/).test(e))return{valid:!1,error:"Invalid email format"};const s=e.split("@")[1];if(o.includes(s.toLowerCase()))return{valid:!1,error:"Email domain is not allowed"};if(i&&!s.includes("."))return{valid:!1,error:"Email must have a valid top-level domain"};const a=[];return e.includes("..")&&a.push("Consecutive dots not allowed"),(e.startsWith(".")||e.endsWith("."))&&a.push("Cannot start or end with dot"),a.length>0?{valid:!1,error:a.join(", ")}:{valid:!0,normalized:e.toLowerCase().trim(),domain:s,local:e.split("@")[0]}}static validateUrl(e,t={}){const{allowedProtocols:n=["http:","https:"],allowLocalhost:r=!1,allowPrivateIps:o=!1,maxLength:i=2048,requireTld:c=!0}=t;if(typeof e!="string")return{valid:!1,error:"URL must be a string"};if(e.length>i)return{valid:!1,error:`URL exceeds maximum length of ${i}`};try{const s=new URL(e);return n.includes(s.protocol)?!r&&(s.hostname==="localhost"||s.hostname==="127.0.0.1")?{valid:!1,error:"Localhost URLs not allowed"}:!o&&this.isPrivateIp(s.hostname)?{valid:!1,error:"Private IP addresses not allowed"}:c&&!s.hostname.includes(".")?{valid:!1,error:"URL must have a valid top-level domain"}:{valid:!0,parsed:{protocol:s.protocol,hostname:s.hostname,pathname:s.pathname,search:s.search,hash:s.hash}}:{valid:!1,error:`Protocol ${s.protocol} not allowed. Allowed: ${n.join(", ")}`}}catch{return{valid:!1,error:"Invalid URL format"}}}static isPrivateIp(e){return[/^10\./,/^172\.(1[6-9]|2[0-9]|3[0-1])\./,/^192\.168\./,/^127\./,/^169\.254\./,/^::1$/,/^fc00:/,/^fe80:/].some(n=>n.test(e))}static validatePassword(e,t={}){const{minLength:n=8,maxLength:r=128,requireUppercase:o=!0,requireLowercase:i=!0,requireNumbers:c=!0,requireSymbols:s=!0,blockedPatterns:a=[],provideFeedback:u=!0}=t;if(typeof e!="string")return{valid:!1,error:"Password must be a string",score:0};const f=[],d=[];let h=0;e.length<n?d.push(`Password must be at least ${n} characters long`):e.length>=n&&(h+=l.SCORING.PASSWORD_BASE_SCORE,e.length>=l.SCORING.PASSWORD_MIN_SECURE_LENGTH&&(h+=l.SCORING.PASSWORD_LENGTH_BONUS)),e.length>r&&d.push(`Password must not exceed ${r} characters`);const m=/[A-Z]/.test(e),p=/[a-z]/.test(e),E=/\d/.test(e),g=/[!@#$%^&*(),.?":{}|<>]/.test(e);o&&!m?d.push("Password must contain at least one uppercase letter"):m&&(h+=l.SCORING.PASSWORD_VARIETY_BONUS),i&&!p?d.push("Password must contain at least one lowercase letter"):p&&(h+=l.SCORING.PASSWORD_VARIETY_BONUS),c&&!E?d.push("Password must contain at least one number"):E&&(h+=l.SCORING.PASSWORD_VARIETY_BONUS),s&&!g?d.push("Password must contain at least one special character"):g&&(h+=l.SCORING.PASSWORD_VARIETY_BONUS);for(const R of a)R.test(e)&&(d.push("Password contains blocked pattern"),h-=l.SCORING.PASSWORD_REPETITION_PENALTY);const T=[/(.)\1{2,}/,/123456/,/abcdef/,/password/i,/qwerty/i];for(const R of T)if(R.test(e)){h-=10,u&&f.push("Avoid common patterns and repeated characters");break}let I="weak";return h>=l.SCORING.PASSWORD_STRENGTH_VERY_STRONG?I="very strong":h>=l.SCORING.PASSWORD_STRENGTH_STRONG?I="strong":h>=l.SCORING.PASSWORD_STRENGTH_MODERATE&&(I="moderate"),u&&(h<l.SCORING.PASSWORD_STRENGTH_WEAK_THRESHOLD&&f.push("Consider using a longer password with mixed character types"),!g&&s&&f.push("Adding special characters improves security")),{valid:d.length===0,errors:d,score:Math.max(0,Math.min(100,h)),strength:I,feedback:f,hasUppercase:m,hasLowercase:p,hasNumbers:E,hasSymbols:g,length:e.length}}static sanitizeInput(e,t={}){const{allowHtml:n=!1,allowUrls:r=!0,maxLength:o=null,trimWhitespace:i=!0,removeInvisibleChars:c=!0,normalizeUnicode:s=!0}=t;if(typeof e!="string")return"";let a=e;return i&&(a=a.trim()),c&&(a=a.replace(/[\u200B-\u200D\uFEFF]/g,"")),s&&(a=a.normalize("NFKC")),n||(a=this.escapeHtml(a)),r||(a=a.replace(/https?:\/\/[^\s]+/g,"[URL removed]")),o&&a.length>o&&(a=a.substring(0,o)),a}static isValidEmail(e){return this.validateEmail(e).valid}static isValidUrl(e){return this.validateUrl(e).valid}static isNumeric(e){return!isNaN(parseFloat(e))&&isFinite(e)}static isEmpty(e){return e==null||e===""||Array.isArray(e)&&e.length===0||typeof e=="object"&&Object.keys(e).length===0}static validateInputAccessibility(e){const t=[],n=[],r=e.getAttribute("id"),o=r&&document.querySelector(`label[for="${r}"]`),i=e.getAttribute("aria-label"),c=e.getAttribute("aria-labelledby");!o&&!i&&!c&&(t.push("Input lacks proper labeling"),n.push("Add a label element or aria-label attribute"));const s=e.hasAttribute("aria-invalid");if(e.checkValidity&&!e.checkValidity()&&!s&&(t.push("Invalid input lacks aria-invalid attribute"),n.push('Add aria-invalid="true" for invalid inputs')),this.isElementVisible(e)){const a=window.getComputedStyle(e),u=a.backgroundColor,f=a.color;if(u!=="rgba(0, 0, 0, 0)"&&f!=="rgba(0, 0, 0, 0)"){const d=this.checkColorAccessibility(f,u);d.passesNormal||(t.push(`Insufficient color contrast (${d.ratio}:1)`),n.push("Increase color contrast to at least 4.5:1"))}}return{accessible:t.length===0,issues:t,recommendations:n,score:Math.max(0,100-t.length*l.SCORING.ACCESSIBILITY_SCORE_PENALTY)}}static getBrowserInfo(e={}){const{includeVersion:t=!1,includeFeatureSupport:n=!1,respectPrivacy:r=!0}=e,o=navigator.userAgent,i={name:"unknown",version:"unknown",engine:"unknown",mobile:/Mobile|Android|iPhone|iPad/.test(o),touch:"ontouchstart"in window},c=[{name:"Chrome",pattern:/Chrome\/(\d+)/,engine:"Blink"},{name:"Firefox",pattern:/Firefox\/(\d+)/,engine:"Gecko"},{name:"Safari",pattern:/Safari\/(\d+)/,engine:"WebKit"},{name:"Edge",pattern:/Edg\/(\d+)/,engine:"Blink"},{name:"Opera",pattern:/OPR\/(\d+)/,engine:"Blink"},{name:"IE",pattern:/MSIE (\d+)|Trident.*rv:(\d+)/,engine:"Trident"}];for(const s of c){const a=o.match(s.pattern);if(a){i.name=s.name,i.engine=s.engine,t&&a[1]&&(i.version=a[1]);break}}return n&&(i.features={webgl:this.supportsWebGL(),webgl2:this.supportsWebGL2(),localStorage:this.supportsLocalStorage(),sessionStorage:this.supportsSessionStorage(),indexedDB:this.supportsIndexedDB(),webWorkers:typeof Worker<"u",serviceWorkers:"serviceWorker"in navigator,webAssembly:typeof WebAssembly<"u",es6Modules:this.supportsES6Modules(),css3:this.supportsCSS3(),mediaQueries:this.supportsMediaQueries(),geolocation:"geolocation"in navigator,notifications:"Notification"in window,fullscreen:this.supportsFullscreen(),webRTC:this.supportsWebRTC(),speechRecognition:this.supportsSpeechRecognition(),intersectionObserver:"IntersectionObserver"in window,resizeObserver:"ResizeObserver"in window}),r&&i.version&&i.version.length>2&&(i.version=`${i.version.substring(0,2)}x`),i}static supportsWebGL(e=1){try{const t=document.createElement("canvas");return!!(e===2?t.getContext("webgl2"):t.getContext("webgl")||t.getContext("experimental-webgl"))}catch{return!1}}static supportsWebGL2(){return this.supportsWebGL(2)}static supportsLocalStorage(){try{const e="__localStorage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch{return!1}}static supportsSessionStorage(){try{const e="__sessionStorage_test__";return sessionStorage.setItem(e,e),sessionStorage.removeItem(e),!0}catch{return!1}}static supportsIndexedDB(){return"indexedDB"in window}static supportsES6Modules(){try{return new Function('import("")'),!0}catch{return!1}}static supportsCSS3(){const e=document.createElement("div");return["transform","transition","animation","borderRadius"].some(n=>n in e.style)}static supportsMediaQueries(){return typeof window.matchMedia<"u"}static supportsFullscreen(){const e=document.documentElement;return!!(e.requestFullscreen||e.webkitRequestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen)}static supportsWebRTC(){return!!(window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection)}static supportsSpeechRecognition(){return!!(window.SpeechRecognition||window.webkitSpeechRecognition)}static getDeviceInfo(e={}){const{includeOrientation:t=!1,includePixelRatio:n=!1,includeTouchPoints:r=!1}=e,o=window.innerWidth,i=window.innerHeight;let c="desktop",s="xl";o<l.DEVICE.MOBILE_BREAKPOINT?(c="mobile",s="xs"):o<l.DEVICE.TABLET_BREAKPOINT?(c="mobile",s="sm"):o<l.DEVICE.DESKTOP_BREAKPOINT?(c="tablet",s="md"):o<l.DEVICE.LARGE_DESKTOP_BREAKPOINT&&(c="desktop",s="lg");const a={type:c,breakpoint:s,width:o,height:i,mobile:c==="mobile",tablet:c==="tablet",desktop:c==="desktop"};return t&&(a.orientation=o>i?"landscape":"portrait"),n&&(a.pixelRatio=window.devicePixelRatio||1,a.highDPI=a.pixelRatio>l.DEVICE.HIGH_DPI_THRESHOLD),r&&"maxTouchPoints"in navigator&&(a.maxTouchPoints=navigator.maxTouchPoints,a.multiTouch=navigator.maxTouchPoints>1),a}static getDeviceType(){return this.getDeviceInfo().type}static getAccessibilityPreferences(){const e={reduceMotion:!1,highContrast:!1,largeText:!1,reducedTransparency:!1};if(window.matchMedia){e.reduceMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches,e.highContrast=window.matchMedia("(prefers-contrast: high)").matches;try{e.reducedTransparency=window.matchMedia("(prefers-reduced-transparency: reduce)").matches}catch{}}return e}static getPerformanceMetrics(e={}){const{includeMemory:t=!1,includeConnection:n=!1,respectBattery:r=!0}=e,o={timestamp:Date.now(),userAgent:navigator.userAgent,language:navigator.language,platform:navigator.platform,cookieEnabled:navigator.cookieEnabled,onLine:navigator.onLine};if(performance&&performance.timing){const{timing:i}=performance;o.pageLoadTime=i.loadEventEnd-i.navigationStart,o.domContentLoaded=i.domContentLoadedEventEnd-i.navigationStart,o.domInteractive=i.domInteractive-i.navigationStart}if(t&&"memory"in performance&&(o.memory={usedJSHeapSize:performance.memory.usedJSHeapSize,totalJSHeapSize:performance.memory.totalJSHeapSize,jsHeapSizeLimit:performance.memory.jsHeapSizeLimit}),n&&"connection"in navigator){const{connection:i}=navigator;o.connection={effectiveType:i.effectiveType,downlink:i.downlink,rtt:i.rtt}}return r&&"getBattery"in navigator&&navigator.getBattery().then(i=>{i.level<l.DEVICE.LOW_BATTERY_THRESHOLD&&(o.lowBattery=!0)}).catch(()=>{}),o}static calculateEthicsScore(e,t={}){const{normalizationMethod:n="weighted",minScore:r=0,maxScore:o=100,defaultWeight:i=1,penalizeIncomplete:c=!0}=t;if(!e||(typeof e.size=="number"?e.size===0:Object.keys(e).length===0))return c?0:l.SCORING.NEUTRAL_SCORE;let s=0,a=0,u=0;const f=(h,m)=>{if(typeof h=="object"&&h!==null){const p=typeof h.value=="number"?h.value:0,E=typeof h.weight=="number"?h.weight:i,g=typeof h.importance=="number"?h.importance:1;p>=0&&p<=100&&(s+=p*E*g,a+=E*g,u++)}else typeof h=="number"&&h>=0&&h<=100&&(s+=h*i,a+=i,u++)};if(e instanceof Map?e.forEach(f):Object.entries(e).forEach(([h,m])=>f(m)),u===0)return c?0:l.SCORING.NEUTRAL_SCORE;let d;switch(n){case"weighted":d=a>0?s/a:0;break;case"average":d=s/u;break;case"harmonic":{const h=Array.from(e instanceof Map?e.values():Object.values(e)).filter(m=>typeof m=="number"||typeof m=="object"&&typeof m.value=="number").reduce((m,p)=>{const E=typeof p=="number"?p:p.value;return m+(E>0?1/E:0)},0);d=h>0?u/h:0;break}default:d=a>0?s/a:0}return this.clamp(Math.round(d),r,o)}static getEthicsGrade(e,t={}){const{includeAdvice:n=!0,includeAccessibility:r=!0}=t;if(typeof e!="number"||e<0||e>100)return{grade:"Invalid",description:"Invalid score provided",level:"error",color:"#ff0000",score:0};let o,i,c,s,a=[];e>=l.SCORING.EXCELLENT_THRESHOLD?(o="A+",i="Excellent",c="excellent",s="#00aa00",n&&(a=["Outstanding ethical decision-making","Continue to maintain these high standards","Consider mentoring others in ethical practices"])):e>=l.SCORING.GOOD_THRESHOLD?(o="A",i="Very Good",c="very-good",s="#44aa00",n&&(a=["Strong ethical performance","Look for opportunities to reach excellence","Review any areas that scored below 90"])):e>=l.SCORING.SATISFACTORY_THRESHOLD?(o="B",i="Good",c="good",s="#88aa00",n&&(a=["Good ethical foundation","Focus on improving consistency","Consider additional ethical training"])):e>=l.SCORING.NEEDS_IMPROVEMENT_THRESHOLD?(o="C",i="Fair",c="fair",s="#aaaa00",n&&(a=["Meets basic ethical standards","Significant room for improvement","Review ethical guidelines and principles"])):e>=l.SCORING.POOR_THRESHOLD?(o="D",i="Needs Improvement",c="needs-improvement",s="#aa6600",n&&(a=["Below acceptable ethical standards","Immediate attention required","Seek guidance from ethical advisors"])):(o="F",i="Poor",c="poor",s="#aa0000",n&&(a=["Serious ethical concerns identified","Comprehensive ethical review needed","Consider professional ethical training"]));const u={score:e,grade:o,description:i,level:c,color:s,percentile:Math.round(e),passed:e>=l.SCORING.PASSING_THRESHOLD};return n&&(u.advice=a),r&&(u.accessibility={ariaLabel:`Ethics score: ${e} out of 100, Grade ${o}, ${i}`,colorBlindSafeColor:this.getEthicsColor(e,{colorBlindSafe:!0}),highContrastColor:this.getEthicsColor(e,{highContrast:!0}),screenReaderText:this.formatForScreenReader(`Your ethics score is ${e} points out of 100, earning a grade of ${o}, which is considered ${i.toLowerCase()}.`)}),u}static generateEthicsInsight(e,t,n,r={}){const{includePercentage:o=!0,includeRecommendations:i=!0,includeAccessibility:c=!0}=r,s=t-e,a=Math.abs(s),u=e>0?s/e*100:0;let f="slightly",d="minor";a>l.SCORING.SIGNIFICANT_CHANGE_THRESHOLD?(f="significantly",d="major"):a>10&&(f="moderately",d="moderate");const h=s>0?"improved":"declined",m=s>0?"#00aa00":"#aa0000";let p=`${n} has ${f} ${h} by ${a} points`;o&&e>0&&(p+=` (${Math.abs(u).toFixed(1)}%)`);const E={category:n,oldValue:e,newValue:t,change:s,absChange:a,percentageChange:u,direction:h,intensity:f,significance:d,message:p,color:m,trend:s>0?"positive":s<0?"negative":"stable"};return i&&(E.recommendations=this.generateEthicsRecommendations(t,n,s)),c&&(E.accessibility={ariaLabel:`${n}: ${h} from ${e} to ${t} points`,screenReaderText:this.formatForScreenReader(p),announcement:`${n} score has ${h} ${f}. New score: ${t} points.`}),E}static generateEthicsRecommendations(e,t,n=0){const r=[];e<l.SCORING.POOR_PERFORMANCE_THRESHOLD?(r.push(`Critical: ${t} requires immediate attention and improvement`),r.push("Consider consulting with ethics experts"),r.push("Review fundamental ethical principles")):e<l.SCORING.AVERAGE_PERFORMANCE_THRESHOLD?(r.push(`${t} needs improvement to meet standards`),r.push("Implement additional training or guidelines")):e<l.SCORING.EXCELLENT_PERFORMANCE_THRESHOLD?(r.push(`${t} is performing well but has room for excellence`),r.push("Fine-tune processes for optimal performance")):r.push(`Excellent ${t} performance - maintain current standards`),n<l.SCORING.DECLINING_TREND_THRESHOLD?(r.push("Investigate causes of recent decline"),r.push("Implement corrective measures immediately")):n>10&&(r.push("Identify successful practices to replicate"),r.push("Document improvements for future reference"));const o={privacy:["Review data collection practices","Ensure transparent privacy policies","Implement data minimization principles"],fairness:["Audit for algorithmic bias","Ensure equal treatment across demographics","Implement fairness metrics and monitoring"],transparency:["Improve explainability of decisions","Provide clear documentation","Enable user understanding of processes"],accountability:["Establish clear responsibility chains","Implement audit trails","Create feedback mechanisms"]},i=t.toLowerCase();return o[i]&&r.push(...o[i].slice(0,2)),r.slice(0,l.SCORING.MAX_RECOMMENDATIONS)}static generateScenarioId(e={}){const{prefix:t="scenario",includeTimestamp:n=!0,includeRandom:r=!0,includeVersion:o=!1,version:i="1.0"}=e,c=[t];return n&&c.push(Date.now().toString()),r&&c.push(Math.random().toString(l.GENERATION.ID_RADIX).substring(l.GENERATION.ID_START_INDEX,l.GENERATION.ID_END_INDEX)),o&&c.push(`v${i}`),c.join("_")}static createProgressBar(e,t,n={}){const{width:r=200,includePercentage:o=!0,includeEstimate:i=!1,startTime:c=null,precision:s=1,accessibleText:a=!0}=n,u=Math.max(t,1),f=Math.max(0,Math.min(e,u)),d=f/u*100,h=d/100*r,m={current:f,total:u,percentage:this.roundTo(d,s),width:this.roundTo(h,s),completed:f>=u,remaining:u-f};if(m.text=`${f}/${u}`,o&&(m.percentageText=`${m.percentage}%`),i&&c&&f>0){const p=Date.now()-c,E=f/p,g=u/E,T=g-p;m.timeEstimate={elapsed:this.formatDuration(p),remaining:this.formatDuration(Math.max(0,T)),total:this.formatDuration(g)}}return a&&(m.accessibility={ariaValueNow:f,ariaValueMin:0,ariaValueMax:u,ariaLabel:`Progress: ${f} of ${u} completed`,ariaValueText:`${m.percentage}% complete`,screenReaderText:this.formatForScreenReader(`Progress is ${m.percentage} percent complete. ${m.remaining} items remaining.`)}),m}static generateSimulationReport(e,t={}){const{includeMetrics:n=!0,includeInsights:r=!0,includeRecommendations:o=!0,includeAccessibility:i=!0}=t;if(!e||typeof e!="object")throw new Error("Invalid simulation data provided");const c=this.calculateEthicsScore(e.ethicsMetrics||new Map),s=this.getEthicsGrade(c,{includeAdvice:!0,includeAccessibility:i}),a={metadata:{simulationId:e.id||this.generateScenarioId(),title:e.title||"Untitled Simulation",completedAt:new Date().toISOString(),duration:e.state?.timeElapsed||0,version:e.version||"1.0",reportGenerated:Date.now()},performance:{score:c,grade:s.grade,gradeDescription:s.description,level:s.level,passed:s.passed},statistics:{decisions:e.state?.decisions?.length||0,scenarios:e.scenarios?.length||0,completionRate:this.calculateCompletionRate(e),averageDecisionTime:this.calculateAverageDecisionTime(e)}};return n&&e.ethicsMetrics&&(a.ethicsMetrics=this.processEthicsMetrics(e.ethicsMetrics)),r&&(a.insights=this.generateSimulationInsights(e)),o&&(a.recommendations=this.generateSimulationRecommendations(e)),i&&(a.accessibility={summary:this.formatForScreenReader(`Simulation ${a.metadata.title} completed with a score of ${c} points, earning grade ${s.grade}.`),ariaLabel:`Simulation report for ${a.metadata.title}`,keyFindings:this.generateAccessibleSummary(a),navigation:this.generateReportNavigation(a)}),a}static calculateCompletionRate(e){if(!e.scenarios||e.scenarios.length===0)return 0;const t=e.scenarios.filter(n=>n.completed||n.status==="completed").length;return this.roundTo(t/e.scenarios.length*100,1)}static calculateAverageDecisionTime(e){const t=e.state?.decisions||[];if(t.length===0)return 0;const n=t.reduce((r,o)=>r+(o.timeSpent||o.duration||0),0);return Math.round(n/t.length)}static processEthicsMetrics(e){const t={},n=(r,o)=>{typeof r=="object"&&r!==null?t[o]={value:r.value||0,weight:r.weight||1,label:r.label||o,description:r.description||"",category:r.category||"general"}:typeof r=="number"&&(t[o]={value:r,weight:1,label:o,description:"",category:"general"})};return e instanceof Map?e.forEach(n):typeof e=="object"&&Object.entries(e).forEach(([r,o])=>n(o,r)),t}static generateSimulationInsights(e){const t=[],n=e.state?.decisions||[],r=e.ethicsMetrics||new Map;if(n.length>0){const i=this.calculateAverageDecisionTime(e);t.push({type:"performance",category:"time",message:`Average decision time: ${this.formatDuration(i)}`,value:i,benchmark:3e4,status:i<=l.TIME.GOOD_DECISION_TIME?"good":"attention"});const c=n.filter(a=>(a.timeSpent||0)<l.TIME.QUICK_DECISION_TIME).length,s=n.filter(a=>(a.timeSpent||0)>l.TIME.SLOW_DECISION_TIME).length;c>n.length*l.TIME.QUICK_DECISION_RATIO&&t.push({type:"behavior",category:"decision-speed",message:"Tendency to make quick decisions - consider taking more time for complex scenarios",value:c,status:"caution"}),s>n.length*l.ANALYSIS.SLOW_DECISION_RATIO&&t.push({type:"behavior",category:"decision-speed",message:"Some decisions took longer than usual - this suggests careful consideration",value:s,status:"positive"})}const o=(i,c)=>{const s=typeof i=="object"?i.value:i,a=typeof i=="object"?i.label:c;typeof s=="number"&&(s>=l.ANALYSIS.HIGH_PERFORMANCE_THRESHOLD?t.push({type:"ethics",category:c,message:`Strong performance in ${a}`,value:s,status:"excellent"}):s<=l.ANALYSIS.LOW_PERFORMANCE_THRESHOLD&&t.push({type:"ethics",category:c,message:`Opportunity to improve ${a}`,value:s,status:"needs-improvement"}))};return r instanceof Map?r.forEach(o):typeof r=="object"&&Object.entries(r).forEach(([i,c])=>o(c,i)),t.slice(0,10)}static generateSimulationRecommendations(e){const t=[],n=this.calculateEthicsScore(e.ethicsMetrics||new Map),r=this.calculateCompletionRate(e);n<l.ANALYSIS.ETHICS_WARNING_THRESHOLD&&(t.push({priority:"high",category:"ethics",title:"Review Ethical Principles",description:"Consider reviewing the ethical principles before retrying",action:"study",resources:["Ethics Guidelines","Decision Framework"]}),t.push({priority:"high",category:"process",title:"Take More Time",description:"Take more time to consider the consequences of each decision",action:"reflect",resources:["Decision Checklist","Impact Assessment"]})),r<l.ANALYSIS.COMPLETION_WARNING_THRESHOLD&&t.push({priority:"medium",category:"completion",title:"Complete All Scenarios",description:"Try to complete all scenarios for a comprehensive evaluation",action:"continue",resources:["Scenario Guide","Progress Tracker"]});const o=(c,s)=>{const a=typeof c=="object"?c.value:c,u=typeof c=="object"?c.label:s;typeof a=="number"&&a<l.ANALYSIS.CRITICAL_VALUE_THRESHOLD&&t.push({priority:"medium",category:"improvement",title:`Improve ${u}`,description:`Focus on improving ${u} in future simulations`,action:"focus",resources:[`${u} Guide`,"Best Practices"]})},i=e.ethicsMetrics||new Map;return i instanceof Map?i.forEach(o):typeof i=="object"&&Object.entries(i).forEach(([c,s])=>o(s,c)),t.slice(0,l.ANALYSIS.EXTENDED_RECOMMENDATIONS)}static generateAccessibleSummary(e){const t=[`Simulation ${e.metadata.title} has been completed.`,`Final score: ${e.performance.score} out of 100 points.`,`Grade: ${e.performance.grade}, ${e.performance.gradeDescription}.`,`${e.statistics.decisions} decisions made across ${e.statistics.scenarios} scenarios.`];return e.insights&&e.insights.length>0&&t.push(`${e.insights.length} key insights identified.`),e.recommendations&&e.recommendations.length>0&&t.push(`${e.recommendations.length} recommendations provided for improvement.`),this.formatForScreenReader(t.join(" "))}static generateReportNavigation(e){return[{section:"metadata",label:"Simulation Information",priority:1},{section:"performance",label:"Performance Summary",priority:1},{section:"statistics",label:"Statistics",priority:2},...e.ethicsMetrics?[{section:"ethicsMetrics",label:"Ethics Metrics",priority:2}]:[],...e.insights?[{section:"insights",label:"Insights",priority:3}]:[],...e.recommendations?[{section:"recommendations",label:"Recommendations",priority:3}]:[]]}static downloadFile(e,t,n={}){const{mimeType:r="text/plain",charset:o="utf-8",validateFilename:i=!0,announceDownload:c=!0,maxSizeBytes:s=l.FILE_SIZE.DEFAULT_TEXT_LIMIT_MB*l.FILE_SIZE.BYTES_PER_KB*l.FILE_SIZE.KB_PER_MB,allowedExtensions:a=null}=n;if(i){const d=this.validateFilename(t,{allowedExtensions:a});if(!d.valid)throw new Error(`Invalid filename: ${d.error}`);t=d.sanitized}let u;if(e instanceof Blob)u=e;else{const d=r.includes("charset")?r:`${r};charset=${o}`;u=new Blob([e],{type:d})}if(u.size>s)throw new Error(`File size (${u.size} bytes) exceeds maximum allowed size (${s} bytes)`);const f=URL.createObjectURL(u);try{const d=document.createElement("a");d.href=f,d.download=t,d.style.display="none",d.setAttribute("aria-label",`Download ${t}`),document.body.appendChild(d),d.click(),document.body.removeChild(d),c&&this.announceToScreenReader(`Download started for ${t}`,"polite")}finally{setTimeout(()=>URL.revokeObjectURL(f),l.TIME.URL_CLEANUP_DELAY)}}static validateFilename(e,t={}){const{maxLength:n=255,allowedExtensions:r=null,allowSpaces:o=!0,allowUnicode:i=!0}=t;if(typeof e!="string")return{valid:!1,error:"Filename must be a string"};if(e.length===0)return{valid:!1,error:"Filename cannot be empty"};if(e.length>n)return{valid:!1,error:`Filename too long (max ${n} characters)`};const c=/[<>:"|?*\\/]/,s=e.split("").some(f=>f.charCodeAt(0)<l.FILE_SIZE.CONTROL_CHAR_THRESHOLD);if(c.test(e)||s)return{valid:!1,error:"Filename contains invalid characters"};if(/^(CON|PRN|AUX|NUL|COM[1-9]|LPT[1-9])(\.|$)/i.test(e))return{valid:!1,error:"Filename uses a reserved name"};if(r){const f=e.split(".").pop()?.toLowerCase();if(!f||!r.includes(f))return{valid:!1,error:`File extension not allowed. Allowed: ${r.join(", ")}`}}let u=e;return o||(u=u.replace(/\s+/g,"_")),i||(u=u.replace(/[^\u0020-\u007F]/g,"")),u=u.trim().replace(/^\.+|\.+$/g,""),{valid:!0,sanitized:u,original:e}}static readFileAsText(e,t={}){const{encoding:n="UTF-8",maxSizeBytes:r=l.FILE_SIZE.DEFAULT_BINARY_LIMIT_MB*l.FILE_SIZE.BYTES_PER_KB*l.FILE_SIZE.KB_PER_MB,onProgress:o=null,validateType:i=!0,allowedTypes:c=["text/plain","text/csv","application/json","text/xml"]}=t;return new Promise((s,a)=>{if(!(e instanceof File)){a(new Error("Invalid file object"));return}if(e.size>r){a(new Error(`File size (${e.size} bytes) exceeds maximum (${r} bytes)`));return}if(i&&!c.includes(e.type)){a(new Error(`File type ${e.type} not allowed. Allowed: ${c.join(", ")}`));return}const u=new FileReader;u.onload=f=>{try{s(f.target.result)}catch(d){a(new Error(`Failed to read file: ${d.message}`))}},u.onerror=()=>{a(new Error("File reading failed"))},u.onabort=()=>{a(new Error("File reading was aborted"))},o&&typeof o=="function"&&(u.onprogress=f=>{if(f.lengthComputable){const d=f.loaded/f.total*100;o(d,f.loaded,f.total)}}),u.readAsText(e,n)})}static readFileAsDataURL(e,t={}){const{maxSizeBytes:n=l.FILE_SIZE.SMALL_BINARY_LIMIT_MB*l.FILE_SIZE.BYTES_PER_KB*l.FILE_SIZE.KB_PER_MB,allowedTypes:r=["image/jpeg","image/png","image/gif","image/webp"],onProgress:o=null}=t;return new Promise((i,c)=>{if(!(e instanceof File)){c(new Error("Invalid file object"));return}if(e.size>n){c(new Error("File size exceeds maximum allowed size"));return}if(!r.includes(e.type)){c(new Error("File type not allowed"));return}const s=new FileReader;s.onload=a=>i(a.target.result),s.onerror=()=>c(new Error("File reading failed")),s.onabort=()=>c(new Error("File reading was aborted")),o&&typeof o=="function"&&(s.onprogress=a=>{a.lengthComputable&&o(a.loaded/a.total*100)}),s.readAsDataURL(e)})}static parseCSV(e,t={}){const{delimiter:n=",",hasHeader:r=!0,skipEmptyLines:o=!0,maxRows:i=1e4,validateData:c=!0}=t;if(typeof e!="string")throw new Error("CSV content must be a string");const s=e.split(`
`),a={headers:[],data:[],metadata:{totalRows:s.length,totalColumns:0,parsedRows:0,skippedRows:0,errors:[]}};let u=0;r&&s.length>0&&(a.headers=this.parseCSVLine(s[0],n),a.metadata.totalColumns=a.headers.length,u=1);for(let f=u;f<s.length&&a.data.length<i;f++){const d=s[f].trim();if(o&&d===""){a.metadata.skippedRows++;continue}try{const h=this.parseCSVLine(d,n);if(c&&r&&h.length!==a.headers.length){a.metadata.errors.push(`Row ${f+1}: Column count mismatch`);continue}a.data.push(r?Object.fromEntries(a.headers.map((m,p)=>[m,h[p]||""])):h),a.metadata.parsedRows++}catch(h){a.metadata.errors.push(`Row ${f+1}: ${h.message}`)}}return a}static parseCSVLine(e,t=","){const n=[];let r="",o=!1,i=0;for(;i<e.length;){const c=e[i];c==='"'?o&&e[i+1]==='"'?(r+='"',i+=2):(o=!o,i++):c===t&&!o?(n.push(r.trim()),r="",i++):(r+=c,i++)}return n.push(r.trim()),n}static exportToCSV(e,t={}){const{headers:n=null,delimiter:r=",",includeHeaders:o=!0,quote:i='"',lineBreak:c=`
`}=t;if(!Array.isArray(e)||e.length===0)return"";const s=[];let a=n;return!a&&e.length>0&&typeof e[0]=="object"&&e[0]!==null&&(a=Object.keys(e[0])),o&&a&&s.push(a.map(u=>this.escapeCSVField(u,r,i)).join(r)),e.forEach(u=>{let f;Array.isArray(u)?f=u.map(d=>this.escapeCSVField(d,r,i)):typeof u=="object"&&u!==null?f=a?a.map(d=>this.escapeCSVField(u[d],r,i)):Object.values(u).map(d=>this.escapeCSVField(d,r,i)):f=[this.escapeCSVField(u,r,i)],s.push(f.join(r))}),s.join(c)}static escapeCSVField(e,t=",",n='"'){if(e==null)return"";const r=String(e);return r.includes(t)||r.includes(n)||r.includes(`
`)||r.includes("\r")?n+r.replace(new RegExp(n,"g"),n+n)+n:r}static easeInOut(e,t={}){const{respectReducedMotion:n=!0,strength:r=1}=t;if(n&&window.matchMedia("(prefers-reduced-motion: reduce)").matches)return e;const o=Math.pow(e,r);return o<l.ANIMATION.EASING_THRESHOLD?2*o*o:-1+(l.ANIMATION.EASING_FACTOR_4-l.ANIMATION.EASING_FACTOR_2*o)*o}static easeIn(e,t={}){const{respectReducedMotion:n=!0,strength:r=2}=t;return n&&window.matchMedia("(prefers-reduced-motion: reduce)").matches?e:Math.pow(e,r)}static easeOut(e,t={}){const{respectReducedMotion:n=!0,strength:r=2}=t;return n&&window.matchMedia("(prefers-reduced-motion: reduce)").matches?e:1-Math.pow(1-e,r)}static easeBounce(e,t={}){const{respectReducedMotion:n=!0}=t;return n&&window.matchMedia("(prefers-reduced-motion: reduce)").matches?e:e<1/l.ANIMATION.BOUNCE_DIVISOR?l.ANIMATION.BOUNCE_MULTIPLIER*e*e:e<l.ANIMATION.BOUNCE_OFFSET_2/l.ANIMATION.BOUNCE_DIVISOR?l.ANIMATION.BOUNCE_MULTIPLIER*(e-=l.ANIMATION.BOUNCE_OFFSET_1_5/l.ANIMATION.BOUNCE_DIVISOR)*e+l.ANIMATION.BOUNCE_RETURN_0_75:e<l.ANIMATION.BOUNCE_OFFSET_2_5/l.ANIMATION.BOUNCE_DIVISOR?l.ANIMATION.BOUNCE_MULTIPLIER*(e-=l.ANIMATION.BOUNCE_OFFSET_2_25/l.ANIMATION.BOUNCE_DIVISOR)*e+l.ANIMATION.BOUNCE_RETURN_0_9375:l.ANIMATION.BOUNCE_MULTIPLIER*(e-=l.ANIMATION.BOUNCE_OFFSET_2_625/l.ANIMATION.BOUNCE_DIVISOR)*e+l.ANIMATION.BOUNCE_RETURN_0_984375}static easeElastic(e,t={}){const{respectReducedMotion:n=!0,amplitude:r=1,period:o=.3}=t;if(n&&window.matchMedia("(prefers-reduced-motion: reduce)").matches||e===0||e===1)return e;const i=o/l.ANIMATION.ELASTIC_PERIOD_DIVISOR;return-(r*Math.pow(2,10*(e-=1))*Math.sin((e-i)*(2*Math.PI)/o))}static animate(e={}){const{duration:t=300,easing:n=this.easeInOut,updateCallback:r=null,completeCallback:o=null,respectReducedMotion:i=!0,fps:c=null,pauseOnVisibilityChange:s=!0,trackPerformance:a=!1}=e;if(typeof r!="function")throw new Error("updateCallback is required");const f=i&&window.matchMedia("(prefers-reduced-motion: reduce)").matches?Math.min(t,100):t,d=c?1e3/c:null;let h=null,m=null,p=!1,E=0,g=0,T=0,I=0,R=!1;const S=a?{startTime:0,frameCount:0,droppedFrames:0,averageFrameTime:0,totalFrameTime:0}:null,L=A=>{if(R)return;h||(h=A,S&&(S.startTime=A));const v=A-h-g,M=Math.min(v/f,1);if(d&&A-T<d){m=requestAnimationFrame(L);return}if(S&&I>0){const C=A-T;S.totalFrameTime+=C,S.frameCount++,C>l.TIME.FRAME_RATE_TARGET&&S.droppedFrames++,S.averageFrameTime=S.totalFrameTime/S.frameCount}if(T=A,I++,!p){const C=typeof n=="function"?n(M,{respectReducedMotion:i}):M;try{r(C,M,v)}catch(H){N.error("Animation update callback error:",H),b.cancel();return}}if(M<1)m=requestAnimationFrame(L);else if(o&&typeof o=="function")try{o(S)}catch(C){N.error("Animation complete callback error:",C)}},D=()=>{s&&(document.hidden&&!p?b.pause():!document.hidden&&p&&b.resume())};s&&document.addEventListener("visibilitychange",D);const b={start(){return!R&&!m&&(m=requestAnimationFrame(L)),this},pause(){return!p&&m&&(p=!0,E=S.now(),cancelAnimationFrame(m),m=null),this},resume(){return p&&(p=!1,g+=S.now()-E,m=requestAnimationFrame(L)),this},cancel(){return R=!0,m&&(cancelAnimationFrame(m),m=null),s&&document.removeEventListener("visibilitychange",D),this},getProgress(){if(!h)return 0;const A=S.now()-h-g;return Math.min(A/f,1)},isPaused(){return p},isCancelled(){return R},getPerformance(){return S?{...S}:null}};return b}static createSpringAnimation(e={}){const{from:t=0,to:n=1,stiffness:r=100,damping:o=10,mass:i=1,precision:c=.01,updateCallback:s=null,completeCallback:a=null,respectReducedMotion:u=!0}=e;if(u&&window.matchMedia("(prefers-reduced-motion: reduce)").matches)return this.animate({duration:200,easing:g=>g,updateCallback:g=>{const T=t+(n-t)*g;s&&s(T,g)},completeCallback:a,respectReducedMotion:!1});let f=t,d=0,h=null,m=null,p=!1;const E=g=>{if(p)return;h||(h=g);const T=Math.min((g-(h||g))/1e3,l.ANIMATION.FRAME_DELTA_TARGET);h=g;const I=-r*(f-n),R=-o*d,S=(I+R)/i;d+=S*T,f+=d*T,s&&s(f,Math.abs(n-f)/Math.abs(n-t)),Math.abs(n-f)<c&&Math.abs(d)<c?(f=n,s&&s(f,1),a&&a()):m=requestAnimationFrame(E)};return{start(){return!p&&!m&&(m=requestAnimationFrame(E)),this},cancel(){return p=!0,m&&(cancelAnimationFrame(m),m=null),this},getCurrentValue(){return f},getVelocity(){return d},isCancelled(){return p}}}static createAnimationBatch(e,t={}){const{sequential:n=!1,delay:r=0,onProgress:o=null,onComplete:i=null}=t,c=[];let s=0,a=!1;const u=()=>{s++;const d=s/e.length;o&&o(d),s===e.length&&i&&i()},f=(d,h)=>{const m={...d,completeCallback:()=>{d.completeCallback&&d.completeCallback(),u()}};return this.animate(m)};return e.forEach((d,h)=>{c.push(f(d))}),{start(){if(a)return this;if(a=!0,n){const d=h=>{h<c.length&&setTimeout(()=>{c[h].start(),d(h+1)},h===0?r:0)};d(0)}else setTimeout(()=>{c.forEach(d=>d.start())},r);return this},pause(){return c.forEach(d=>d.pause()),this},resume(){return c.forEach(d=>d.resume()),this},cancel(){return c.forEach(d=>d.cancel()),this},getProgress(){return s/e.length},getControllers(){return[...c]}}}}window.addEventListener("beforeunload",()=>{w.clear()});typeof window<"u"&&F.createThemeObserver((O,e)=>{window.dispatchEvent(new CustomEvent("themeChange",{detail:{property:O,value:e}}))});export{B as H};
//# sourceMappingURL=utils-BNgYPo66.js.map

{"version":3,"file":"utils-BNgYPo66.js","sources":["../../src/js/utils/helpers.js"],"sourcesContent":["/**\n * Copyright 2025 Armando Sori\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Enhanced Helper Utilities for SimulateAI Platform\n * Comprehensive utility functions for modern web applications\n *\n * Features:\n * - Mathematical and statistical operations\n * - Advanced array and string manipulation\n * - Theme and accessibility integration\n * - Performance optimization utilities\n * - Privacy and security helpers\n * - Educational analytics support\n * - Cross-browser compatibility\n * - Memory management utilities\n * - Advanced validation and sanitization\n *\n * @version 2.0.0\n * @author SimulateAI Team\n * @license Apache-2.0\n */\n\nimport logger from './logger.js';\nimport { COMMON } from './constants.js';\n\n// Enhanced constants and configuration\nconst HELPERS_CONSTANTS = {\n  VERSION: '2.0.0',\n  MAX_CACHE_SIZE: 1000,\n  CACHE_EXPIRY: 300000, // 5 minutes\n  PERFORMANCE_SAMPLE_RATE: 0.1,\n\n  // UI and spacing constants\n  UI: {\n    TOOLTIP_SPACING: 8,\n    SMOOTH_SCROLL_DURATION: 500,\n    TOOLTIP_ID_LENGTH: 8,\n    DEFAULT_SPACING: 8,\n  },\n\n  // Scoring constants\n  SCORING: {\n    PASSWORD_BASE_SCORE: 20,\n    PASSWORD_LENGTH_BONUS: 10,\n    PASSWORD_MIN_SECURE_LENGTH: 12,\n    PASSWORD_VARIETY_BONUS: 15,\n    PASSWORD_REPETITION_PENALTY: 20,\n    PASSWORD_STRENGTH_VERY_STRONG: 80,\n    PASSWORD_STRENGTH_STRONG: 60,\n    PASSWORD_STRENGTH_MODERATE: 40,\n    PASSWORD_STRENGTH_WEAK_THRESHOLD: 60,\n    ACCESSIBILITY_SCORE_PENALTY: 25,\n    NEUTRAL_SCORE: 50,\n    EXCELLENT_THRESHOLD: 90,\n    GOOD_THRESHOLD: 80,\n    SATISFACTORY_THRESHOLD: 70,\n    NEEDS_IMPROVEMENT_THRESHOLD: 60,\n    POOR_THRESHOLD: 50,\n    PASSING_THRESHOLD: 60,\n    SIGNIFICANT_CHANGE_THRESHOLD: 20,\n    POOR_PERFORMANCE_THRESHOLD: 50,\n    AVERAGE_PERFORMANCE_THRESHOLD: 70,\n    EXCELLENT_PERFORMANCE_THRESHOLD: 90,\n    DECLINING_TREND_THRESHOLD: -10,\n    MAX_RECOMMENDATIONS: 5,\n  },\n\n  // Text analysis constants\n  TEXT_ANALYSIS: {\n    EXCESSIVE_CAPS_PENALTY: 50,\n    EXCESSIVE_PUNCTUATION_PENALTY: 20,\n    PUNCTUATION_THRESHOLD: 0.1,\n    PUNCTUATION_PENALTY: 15,\n    MAX_WORDS_PER_SENTENCE: 20,\n  }, // Time constants\n  TIME: {\n    SECONDS_PER_MINUTE: 60,\n    MINUTES_PER_HOUR: 60,\n    HOURS_PER_DAY: 24,\n    DAYS_PER_WEEK: 7,\n    DAYS_PER_MONTH: 30,\n    DAYS_PER_YEAR: 365,\n    MILLISECONDS_PER_SECOND: 1000,\n    SUNDAY: 0,\n    SATURDAY: 6,\n    URL_CLEANUP_DELAY: 1000, // 1 second for URL cleanup\n    GOOD_DECISION_TIME: 30000, // 30 seconds\n    QUICK_DECISION_TIME: 10000, // 10 seconds\n    SLOW_DECISION_TIME: 60000, // 60 seconds\n    QUICK_DECISION_RATIO: 0.5, // 50% threshold\n    SLOW_DECISION_RATIO: 0.3, // 30% threshold\n    FRAME_RATE_TARGET: 16.67, // Target 60fps\n  },\n\n  // Weekend days (derived from TIME constants)\n  get WEEKEND_DAYS() {\n    return [this.TIME.SUNDAY, this.TIME.SATURDAY];\n  },\n\n  // Device and responsiveness constants\n  DEVICE: {\n    MOBILE_BREAKPOINT: 576,\n    TABLET_BREAKPOINT: 768,\n    DESKTOP_BREAKPOINT: 992,\n    LARGE_DESKTOP_BREAKPOINT: 1200,\n    HIGH_DPI_THRESHOLD: 1.5,\n    LOW_BATTERY_THRESHOLD: 0.2, // 20%\n  },\n\n  // ID and string generation constants\n  GENERATION: {\n    ID_RADIX: 36,\n    ID_START_INDEX: 2,\n    ID_END_INDEX: 11,\n  },\n\n  // File size constants (in bytes)\n  FILE_SIZE: {\n    BYTES_PER_KB: 1024,\n    KB_PER_MB: 1024,\n    DEFAULT_TEXT_LIMIT_MB: 100,\n    DEFAULT_BINARY_LIMIT_MB: 50,\n    SMALL_BINARY_LIMIT_MB: 10,\n    CONTROL_CHAR_THRESHOLD: 32, // ASCII control characters\n  },\n\n  // Performance and animation constants\n  ANIMATION: {\n    EASING_THRESHOLD: 0.5,\n    EASING_FACTOR_4: 4,\n    EASING_FACTOR_2: 2,\n    BOUNCE_DIVISOR: 2.75,\n    BOUNCE_MULTIPLIER: 7.5625,\n    BOUNCE_OFFSET_1_5: 1.5,\n    BOUNCE_OFFSET_2: 2,\n    BOUNCE_OFFSET_2_25: 2.25,\n    BOUNCE_OFFSET_2_5: 2.5,\n    BOUNCE_OFFSET_2_625: 2.625,\n    BOUNCE_RETURN_0_75: 0.75,\n    BOUNCE_RETURN_0_9375: 0.9375,\n    BOUNCE_RETURN_0_984375: 0.984375,\n    ELASTIC_PERIOD_DIVISOR: 4,\n    FRAME_DELTA_TARGET: 0.016, // 60fps target\n  },\n\n  // Additional scoring thresholds\n  ANALYSIS: {\n    SLOW_DECISION_RATIO: 0.3,\n    HIGH_PERFORMANCE_THRESHOLD: 80,\n    LOW_PERFORMANCE_THRESHOLD: 40,\n    ETHICS_WARNING_THRESHOLD: 70,\n    COMPLETION_WARNING_THRESHOLD: 80,\n    CRITICAL_VALUE_THRESHOLD: 50,\n    EXTENDED_RECOMMENDATIONS: 8,\n  },\n\n  // Color constants\n  COLOR: {\n    RGB_MAX: 255,\n    HEX_SHORT_LENGTH: 3,\n    HEX_SHIFT_ALPHA: 24,\n    HEX_SHIFT_RED: 16,\n    HEX_SHIFT_GREEN: 8,\n    HEX_BASE: 16,\n    THRESHOLD_LOW: 30,\n    THRESHOLD_MEDIUM: 60,\n    THRESHOLD_HIGH: 50,\n    LUMINANCE_OFFSET: 0.05,\n    LUMINANCE_THRESHOLD: 0.03928,\n    LUMINANCE_DIVISOR: 12.92,\n    LUMINANCE_OFFSET_2: 0.055,\n    LUMINANCE_DIVISOR_2: 1.055,\n    LUMINANCE_EXPONENT: 2.4,\n    // Color science constants for luminance calculation\n    LUMINANCE_RED_WEIGHT: 0.2126,\n    LUMINANCE_GREEN_WEIGHT: 0.7152,\n    LUMINANCE_BLUE_WEIGHT: 0.0722,\n    // HSL conversion constants\n    HSL_HUE_CIRCLE: 360,\n    HSL_HUE_SECTIONS: 6,\n    HSL_HUE_RED_OFFSET: 4,\n    HSL_LIGHTNESS_THRESHOLD: 0.5,\n    HSL_SATURATION_DIVISOR: 2,\n    FACTOR_LIGHTEN: 0.8,\n  },\n\n  VALIDATION_PATTERNS: {\n    EMAIL: /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/,\n    URL: /^https?:\\/\\/[^\\s/$.?#].[^\\s]*$/i,\n    UUID: /^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,\n    SLUG: /^[a-z0-9]+(?:-[a-z0-9]+)*$/,\n    PASSWORD_STRONG:\n      /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{8,}$/,\n  },\n  ACCESSIBILITY_COLORS: {\n    HIGH_CONTRAST: {\n      background: '#000000',\n      text: '#ffffff',\n      primary: '#ffff00',\n      secondary: '#00ffff',\n      danger: '#ff0000',\n      success: '#00ff00',\n    },\n    LIGHT_MODE: {\n      background: '#ffffff',\n      text: '#333333',\n      primary: '#007bff',\n      secondary: '#28a745',\n      danger: '#dc3545',\n      success: '#28a745',\n    },\n  },\n};\n\n/**\n * Memory management for caching and performance\n */\nclass HelperCache {\n  static cache = new Map();\n  static accessTimes = new Map();\n\n  static set(key, value, ttl = HELPERS_CONSTANTS.CACHE_EXPIRY) {\n    const expiry = Date.now() + ttl;\n    this.cache.set(key, { value, expiry });\n    this.accessTimes.set(key, Date.now());\n    this.cleanup();\n  }\n\n  static get(key) {\n    const entry = this.cache.get(key);\n    if (!entry) return null;\n\n    if (Date.now() > entry.expiry) {\n      this.cache.delete(key);\n      this.accessTimes.delete(key);\n      return null;\n    }\n\n    this.accessTimes.set(key, Date.now());\n    return entry.value;\n  }\n\n  static cleanup() {\n    if (this.cache.size <= HELPERS_CONSTANTS.MAX_CACHE_SIZE) return;\n\n    // Remove expired entries first\n    for (const [key, entry] of this.cache.entries()) {\n      if (Date.now() > entry.expiry) {\n        this.cache.delete(key);\n        this.accessTimes.delete(key);\n      }\n    }\n\n    // If still over limit, remove least recently used\n    if (this.cache.size > HELPERS_CONSTANTS.MAX_CACHE_SIZE) {\n      const sortedByAccess = [...this.accessTimes.entries()]\n        .sort(([, a], [, b]) => a - b)\n        .slice(0, this.cache.size - HELPERS_CONSTANTS.MAX_CACHE_SIZE);\n\n      sortedByAccess.forEach(([key]) => {\n        this.cache.delete(key);\n        this.accessTimes.delete(key);\n      });\n    }\n  }\n\n  static clear() {\n    this.cache.clear();\n    this.accessTimes.clear();\n  }\n}\n\n/**\n * Theme and accessibility utilities\n */\nclass ThemeHelpers {\n  static getCurrentTheme() {\n    const prefersHighContrast = window.matchMedia(\n      '(prefers-contrast: high)'\n    ).matches;\n    const prefersReducedMotion = window.matchMedia(\n      '(prefers-reduced-motion: reduce)'\n    ).matches;\n\n    return {\n      highContrast: prefersHighContrast,\n      reducedMotion: prefersReducedMotion,\n      theme: prefersHighContrast ? 'highContrast' : 'light',\n    };\n  }\n\n  static getThemeColors(theme = null) {\n    const currentTheme = theme || this.getCurrentTheme();\n\n    if (currentTheme.highContrast) {\n      return HELPERS_CONSTANTS.ACCESSIBILITY_COLORS.HIGH_CONTRAST;\n    }\n\n    return HELPERS_CONSTANTS.ACCESSIBILITY_COLORS.LIGHT_MODE;\n  }\n\n  static applyTheme(element, theme = null) {\n    const colors = this.getThemeColors(theme);\n    const currentTheme = theme || this.getCurrentTheme();\n\n    element.style.backgroundColor = colors.background;\n    element.style.color = colors.text;\n\n    // Add theme-specific classes\n    element.classList.remove('theme-light', 'theme-high-contrast');\n    element.classList.add(`theme-${currentTheme.theme}`);\n\n    if (currentTheme.reducedMotion) {\n      element.classList.add('reduce-motion');\n    }\n\n    return colors;\n  }\n\n  static createThemeObserver(callback) {\n    const observers = [];\n\n    // High contrast observer\n    const contrastQuery = window.matchMedia('(prefers-contrast: high)');\n    const contrastHandler = e => callback('highContrast', e.matches);\n    contrastQuery.addEventListener('change', contrastHandler);\n    observers.push(() =>\n      contrastQuery.removeEventListener('change', contrastHandler)\n    );\n\n    // Reduced motion observer\n    const motionQuery = window.matchMedia('(prefers-reduced-motion: reduce)');\n    const motionHandler = e => callback('reducedMotion', e.matches);\n    motionQuery.addEventListener('change', motionHandler);\n    observers.push(() =>\n      motionQuery.removeEventListener('change', motionHandler)\n    );\n\n    return () => observers.forEach(cleanup => cleanup());\n  }\n}\n\n/**\n * Enhanced Helpers class with modern utilities\n */\nclass Helpers {\n  // Enhanced Math utilities with performance optimization and caching\n  /**\n   * Clamp a value between min and max bounds\n   * @param {number} value - Value to clamp\n   * @param {number} min - Minimum bound\n   * @param {number} max - Maximum bound\n   * @returns {number} Clamped value\n   */\n  static clamp(value, min, max) {\n    if (typeof value !== 'number' || isNaN(value)) return min;\n    return Math.min(Math.max(value, min), max);\n  }\n\n  /**\n   * Linear interpolation between two values\n   * @param {number} start - Start value\n   * @param {number} end - End value\n   * @param {number} factor - Interpolation factor (0-1)\n   * @returns {number} Interpolated value\n   */\n  static lerp(start, end, factor) {\n    factor = this.clamp(factor, 0, 1);\n    return start + (end - start) * factor;\n  }\n\n  /**\n   * Map a value from one range to another\n   * @param {number} value - Value to map\n   * @param {number} inputMin - Input range minimum\n   * @param {number} inputMax - Input range maximum\n   * @param {number} outputMin - Output range minimum\n   * @param {number} outputMax - Output range maximum\n   * @returns {number} Mapped value\n   */\n  static map(value, inputMin, inputMax, outputMin, outputMax) {\n    if (inputMax === inputMin) return outputMin;\n    const factor = (value - inputMin) / (inputMax - inputMin);\n    return outputMin + (outputMax - outputMin) * factor;\n  }\n\n  /**\n   * Generate a random number between min and max\n   * @param {number} min - Minimum value\n   * @param {number} max - Maximum value\n   * @returns {number} Random number\n   */\n  static randomBetween(min, max) {\n    return Math.random() * (max - min) + min;\n  }\n\n  /**\n   * Generate a random integer between min and max (inclusive)\n   * @param {number} min - Minimum value\n   * @param {number} max - Maximum value\n   * @returns {number} Random integer\n   */\n  static randomInt(min, max) {\n    return Math.floor(Math.random() * (max - min + 1)) + min;\n  }\n\n  /**\n   * Round a number to specified decimal places\n   * @param {number} number - Number to round\n   * @param {number} decimals - Number of decimal places\n   * @returns {number} Rounded number\n   */\n  static roundTo(number, decimals) {\n    if (typeof number !== 'number' || isNaN(number)) return 0;\n    return Number(`${Math.round(`${number}e${decimals}`)}e-${decimals}`);\n  }\n\n  /**\n   * Calculate statistical mean\n   * @param {number[]} values - Array of numbers\n   * @returns {number} Mean value\n   */\n  static mean(values) {\n    if (!Array.isArray(values) || values.length === 0) return 0;\n    const validValues = values.filter(v => typeof v === 'number' && !isNaN(v));\n    return validValues.length > 0\n      ? validValues.reduce((a, b) => a + b, 0) / validValues.length\n      : 0;\n  }\n\n  /**\n   * Calculate statistical median\n   * @param {number[]} values - Array of numbers\n   * @returns {number} Median value\n   */\n  static median(values) {\n    if (!Array.isArray(values) || values.length === 0) return 0;\n    const validValues = values\n      .filter(v => typeof v === 'number' && !isNaN(v))\n      .sort((a, b) => a - b);\n    const mid = Math.floor(validValues.length / 2);\n    return validValues.length % 2 === 0\n      ? (validValues[mid - 1] + validValues[mid]) / 2\n      : validValues[mid];\n  }\n\n  /**\n   * Calculate standard deviation\n   * @param {number[]} values - Array of numbers\n   * @returns {number} Standard deviation\n   */\n  static standardDeviation(values) {\n    const average = this.mean(values);\n    const validValues = values.filter(v => typeof v === 'number' && !isNaN(v));\n    const squaredDiffs = validValues.map(v => Math.pow(v - average, 2));\n    return Math.sqrt(this.mean(squaredDiffs));\n  }\n\n  /**\n   * Calculate correlation coefficient between two datasets\n   * @param {number[]} x - First dataset\n   * @param {number[]} y - Second dataset\n   * @returns {number} Correlation coefficient (-1 to 1)\n   */\n  static correlation(x, y) {\n    if (\n      !Array.isArray(x) ||\n      !Array.isArray(y) ||\n      x.length !== y.length ||\n      x.length === 0\n    )\n      return 0;\n\n    const meanX = this.mean(x);\n    const meanY = this.mean(y);\n\n    let numerator = 0;\n    let sumSqX = 0;\n    let sumSqY = 0;\n\n    for (let i = 0; i < x.length; i++) {\n      const deltaX = x[i] - meanX;\n      const deltaY = y[i] - meanY;\n      numerator += deltaX * deltaY;\n      sumSqX += deltaX * deltaX;\n      sumSqY += deltaY * deltaY;\n    }\n\n    const denominator = Math.sqrt(sumSqX * sumSqY);\n    return denominator === 0 ? 0 : numerator / denominator;\n  } // Enhanced Array utilities with performance optimization\n  /**\n   * Shuffle an array using Fisher-Yates algorithm (non-mutating)\n   * @param {Array} array - Array to shuffle\n   * @returns {Array} Shuffled copy of the array\n   */\n  static shuffleArray(array) {\n    if (!Array.isArray(array)) return [];\n    const shuffled = [...array];\n    for (let i = shuffled.length - 1; i > 0; i--) {\n      const j = Math.floor(Math.random() * (i + 1));\n      [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];\n    }\n    return shuffled;\n  }\n\n  /**\n   * Get a random element from an array\n   * @param {Array} array - Source array\n   * @returns {*} Random element or undefined if array is empty\n   */\n  static getRandomElement(array) {\n    if (!Array.isArray(array) || array.length === 0) return undefined;\n    return array[Math.floor(Math.random() * array.length)];\n  }\n\n  /**\n   * Get multiple random elements from an array (without replacement)\n   * @param {Array} array - Source array\n   * @param {number} count - Number of elements to select\n   * @returns {Array} Array of selected elements\n   */\n  static getRandomElements(array, count) {\n    if (!Array.isArray(array) || count <= 0) return [];\n    const shuffled = this.shuffleArray(array);\n    return shuffled.slice(0, Math.min(count, shuffled.length));\n  }\n\n  /**\n   * Group array elements by a key function\n   * @param {Array} array - Array to group\n   * @param {Function} keyFn - Function that returns the grouping key\n   * @returns {Object} Grouped object\n   */\n  static groupBy(array, keyFn) {\n    if (!Array.isArray(array) || typeof keyFn !== 'function') return {};\n    return array.reduce((groups, item) => {\n      const key = keyFn(item);\n      if (!groups[key]) {\n        groups[key] = [];\n      }\n      groups[key].push(item);\n      return groups;\n    }, {});\n  }\n\n  /**\n   * Remove duplicates from an array\n   * @param {Array} array - Array with potential duplicates\n   * @param {Function} keyFn - Optional key function for object comparison\n   * @returns {Array} Array without duplicates\n   */\n  static unique(array, keyFn = null) {\n    if (!Array.isArray(array)) return [];\n\n    if (keyFn && typeof keyFn === 'function') {\n      const seen = new Set();\n      return array.filter(item => {\n        const key = keyFn(item);\n        if (seen.has(key)) return false;\n        seen.add(key);\n        return true;\n      });\n    }\n\n    return [...new Set(array)];\n  }\n\n  /**\n   * Chunk an array into smaller arrays of specified size\n   * @param {Array} array - Array to chunk\n   * @param {number} size - Size of each chunk\n   * @returns {Array[]} Array of chunks\n   */\n  static chunk(array, size) {\n    if (!Array.isArray(array) || size <= 0) return [];\n    const chunks = [];\n    for (let i = 0; i < array.length; i += size) {\n      chunks.push(array.slice(i, i + size));\n    }\n    return chunks;\n  }\n\n  /**\n   * Flatten a nested array structure\n   * @param {Array} array - Nested array\n   * @param {number} depth - Maximum depth to flatten (default: Infinity)\n   * @returns {Array} Flattened array\n   */\n  static flatten(array, depth = Infinity) {\n    if (!Array.isArray(array)) return [];\n    return depth > 0\n      ? array.reduce(\n          (acc, val) =>\n            acc.concat(Array.isArray(val) ? this.flatten(val, depth - 1) : val),\n          []\n        )\n      : array.slice();\n  }\n\n  /**\n   * Find the intersection of multiple arrays\n   * @param {...Array} arrays - Arrays to intersect\n   * @returns {Array} Intersection of all arrays\n   */\n  static intersection(...arrays) {\n    if (arrays.length === 0) return [];\n    if (arrays.length === 1)\n      return Array.isArray(arrays[0]) ? [...arrays[0]] : [];\n\n    return arrays.reduce((result, array) => {\n      if (!Array.isArray(array)) return [];\n      return result.filter(item => array.includes(item));\n    });\n  }\n\n  /**\n   * Sort array of objects by multiple criteria\n   * @param {Array} array - Array to sort\n   * @param {Array} criteria - Array of {key, direction} objects\n   * @returns {Array} Sorted array\n   */\n  static sortBy(array, criteria) {\n    if (!Array.isArray(array) || !Array.isArray(criteria)) return [...array];\n\n    return [...array].sort((a, b) => {\n      for (const criterion of criteria) {\n        const { key, direction = 'asc' } = criterion;\n        const aVal = typeof key === 'function' ? key(a) : a[key];\n        const bVal = typeof key === 'function' ? key(b) : b[key];\n\n        if (aVal < bVal) return direction === 'asc' ? -1 : 1;\n        if (aVal > bVal) return direction === 'asc' ? 1 : -1;\n      }\n      return 0;\n    });\n  } // Enhanced String utilities with security and accessibility features\n  /**\n   * Capitalize the first letter of a string\n   * @param {string} str - String to capitalize\n   * @returns {string} Capitalized string\n   */\n  static capitalize(str) {\n    if (typeof str !== 'string' || str.length === 0) return '';\n    return str.charAt(0).toUpperCase() + str.slice(1);\n  }\n\n  /**\n   * Convert camelCase to kebab-case\n   * @param {string} str - camelCase string\n   * @returns {string} kebab-case string\n   */\n  static camelToKebab(str) {\n    if (typeof str !== 'string') return '';\n    return str.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g, '$1-$2').toLowerCase();\n  }\n\n  /**\n   * Convert kebab-case to camelCase\n   * @param {string} str - kebab-case string\n   * @returns {string} camelCase string\n   */\n  static kebabToCamel(str) {\n    if (typeof str !== 'string') return '';\n    return str.replace(/-([a-z])/g, g => g[1].toUpperCase());\n  }\n\n  /**\n   * Truncate text with optional suffix\n   * @param {string} text - Text to truncate\n   * @param {number} maxLength - Maximum length\n   * @param {string} suffix - Suffix to add (default: '...')\n   * @returns {string} Truncated text\n   */\n  static truncateText(text, maxLength, suffix = '...') {\n    if (typeof text !== 'string' || text.length <= maxLength) return text;\n    return text.substring(0, maxLength - suffix.length) + suffix;\n  }\n\n  /**\n   * Strip HTML tags from a string (security-conscious)\n   * @param {string} html - HTML string\n   * @returns {string} Plain text\n   */\n  static stripHtml(html) {\n    if (typeof html !== 'string') return '';\n    // Create a temporary element and use textContent for security\n    const div = document.createElement('div');\n    div.innerHTML = html;\n    return div.textContent || div.innerText || '';\n  }\n\n  /**\n   * Escape HTML entities for security\n   * @param {string} text - Text to escape\n   * @returns {string} HTML-escaped text\n   */\n  static escapeHtml(text) {\n    if (typeof text !== 'string') return '';\n    const div = document.createElement('div');\n    div.textContent = text;\n    return div.innerHTML;\n  }\n\n  /**\n   * Generate a secure random string\n   * @param {number} length - Length of the string\n   * @param {string} charset - Character set to use\n   * @returns {string} Random string\n   */\n  static generateRandomString(\n    length = 12,\n    charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'\n  ) {\n    let result = '';\n    const charsetLength = charset.length;\n\n    if (window.crypto && window.crypto.getRandomValues) {\n      // Use cryptographically secure random\n      const randomValues = new Uint8Array(length);\n      window.crypto.getRandomValues(randomValues);\n      for (let i = 0; i < length; i++) {\n        result += charset[randomValues[i] % charsetLength];\n      }\n    } else {\n      // Fallback to Math.random\n      for (let i = 0; i < length; i++) {\n        result += charset[Math.floor(Math.random() * charsetLength)];\n      }\n    }\n\n    return result;\n  }\n\n  /**\n   * Create a URL-friendly slug from text\n   * @param {string} text - Text to convert\n   * @param {number} maxLength - Maximum length (default: 50)\n   * @returns {string} URL slug\n   */\n  static createSlug(text, maxLength = 50) {\n    if (typeof text !== 'string') return '';\n\n    return text\n      .toLowerCase()\n      .trim()\n      .replace(/[^\\w\\s-]/g, '') // Remove special characters\n      .replace(/\\s+/g, '-') // Replace spaces with hyphens\n      .replace(/-+/g, '-') // Replace multiple hyphens with single\n      .substring(0, maxLength)\n      .replace(/-$/, ''); // Remove trailing hyphen\n  }\n\n  /**\n   * Format text for screen readers\n   * @param {string} text - Text to format\n   * @param {Object} options - Formatting options\n   * @returns {string} Screen reader friendly text\n   */\n  static formatForScreenReader(text, options = {}) {\n    if (typeof text !== 'string') return '';\n\n    const {\n      expandAbbreviations = true,\n      addPunctuation = true,\n      slowDown = false,\n    } = options;\n\n    let formatted = text;\n\n    if (expandAbbreviations) {\n      const abbreviations = {\n        AI: 'Artificial Intelligence',\n        ML: 'Machine Learning',\n        UI: 'User Interface',\n        UX: 'User Experience',\n        API: 'Application Programming Interface',\n      };\n\n      Object.entries(abbreviations).forEach(([abbr, full]) => {\n        const regex = new RegExp(`\\\\b${abbr}\\\\b`, 'gi');\n        formatted = formatted.replace(regex, full);\n      });\n    }\n\n    if (addPunctuation && !formatted.match(/[.!?]$/)) {\n      formatted += '.';\n    }\n\n    if (slowDown) {\n      // Add pauses for screen readers\n      formatted = formatted.replace(/[.!?]/g, '$&\\u00A0'); // Non-breaking space\n    }\n\n    return formatted;\n  }\n\n  /**\n   * Check if text meets accessibility guidelines\n   * @param {string} text - Text to check\n   * @returns {Object} Accessibility assessment\n   */\n  static assessTextAccessibility(text) {\n    if (typeof text !== 'string')\n      return { score: 0, issues: ['Invalid input'] };\n\n    const issues = [];\n    let score = 100;\n\n    // Check length\n    if (text.length === 0) {\n      issues.push('Text is empty');\n      score -= HELPERS_CONSTANTS.TEXT_ANALYSIS.EXCESSIVE_CAPS_PENALTY;\n    }\n\n    // Check for all caps (poor for screen readers)\n    if (text.length > 10 && text === text.toUpperCase()) {\n      issues.push('Text is all uppercase');\n      score -= HELPERS_CONSTANTS.TEXT_ANALYSIS.EXCESSIVE_PUNCTUATION_PENALTY;\n    }\n\n    // Check for excessive punctuation\n    const punctuationRatio =\n      (text.match(/[!?]{2,}/g) || []).length / text.length;\n    if (\n      punctuationRatio > HELPERS_CONSTANTS.TEXT_ANALYSIS.PUNCTUATION_THRESHOLD\n    ) {\n      issues.push('Excessive punctuation detected');\n      score -= HELPERS_CONSTANTS.TEXT_ANALYSIS.PUNCTUATION_PENALTY;\n    }\n\n    // Check reading level (simplified)\n    const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 0);\n    const words = text.split(/\\s+/).filter(w => w.length > 0);\n    const avgWordsPerSentence = words.length / Math.max(sentences.length, 1);\n\n    if (\n      avgWordsPerSentence >\n      HELPERS_CONSTANTS.TEXT_ANALYSIS.MAX_WORDS_PER_SENTENCE\n    ) {\n      issues.push('Sentences may be too long');\n      score -= 10;\n    }\n\n    return {\n      score: Math.max(0, score),\n      issues,\n      wordCount: words.length,\n      sentenceCount: sentences.length,\n      avgWordsPerSentence: this.roundTo(avgWordsPerSentence, 1),\n    };\n  } // Enhanced Time utilities with internationalization and accessibility\n  /**\n   * Format duration with accessibility support\n   * @param {number} milliseconds - Duration in milliseconds\n   * @param {Object} options - Formatting options\n   * @returns {string} Formatted duration\n   */\n  static formatDuration(milliseconds, options = {}) {\n    if (typeof milliseconds !== 'number' || milliseconds < 0) return '0s';\n\n    const {\n      includeMilliseconds = false,\n      verbose = false,\n      screenReader = false,\n    } = options;\n\n    const seconds = Math.floor(milliseconds / 1000);\n    const minutes = Math.floor(seconds / COMMON.MINUTES_60);\n    const hours = Math.floor(minutes / COMMON.MINUTES_60);\n    const days = Math.floor(hours / COMMON.HOURS_24);\n\n    if (verbose || screenReader) {\n      const parts = [];\n      if (days > 0) parts.push(`${days} day${days > 1 ? 's' : ''}`);\n      if (hours % COMMON.HOURS_24 > 0)\n        parts.push(\n          `${hours % COMMON.HOURS_24} hour${hours % COMMON.HOURS_24 > 1 ? 's' : ''}`\n        );\n      if (minutes % HELPERS_CONSTANTS.TIME.SECONDS_PER_MINUTE > 0)\n        parts.push(\n          `${minutes % HELPERS_CONSTANTS.TIME.SECONDS_PER_MINUTE} minute${minutes % HELPERS_CONSTANTS.TIME.SECONDS_PER_MINUTE > 1 ? 's' : ''}`\n        );\n      if (seconds % COMMON.MINUTES_60 > 0)\n        parts.push(\n          `${seconds % COMMON.MINUTES_60} second${seconds % COMMON.MINUTES_60 > 1 ? 's' : ''}`\n        );\n\n      if (parts.length === 0) return screenReader ? '0 seconds' : '0s';\n      return parts.join(screenReader ? ', ' : ' ');\n    }\n\n    if (days > 0) {\n      return `${days}d ${hours % COMMON.HOURS_24}h ${minutes % COMMON.MINUTES_60}m`;\n    } else if (hours > 0) {\n      return `${hours}:${(minutes % HELPERS_CONSTANTS.TIME.SECONDS_PER_MINUTE).toString().padStart(2, '0')}:${(seconds % HELPERS_CONSTANTS.TIME.SECONDS_PER_MINUTE).toString().padStart(2, '0')}`;\n    } else if (minutes > 0) {\n      return `${minutes}:${(seconds % HELPERS_CONSTANTS.TIME.SECONDS_PER_MINUTE).toString().padStart(2, '0')}`;\n    } else {\n      return includeMilliseconds\n        ? `${seconds}.${Math.floor((milliseconds % HELPERS_CONSTANTS.TIME.MILLISECONDS_PER_SECOND) / 100)}s`\n        : `${seconds}s`;\n    }\n  }\n\n  /**\n   * Format timestamp with enhanced options and accessibility\n   * @param {number} timestamp - Timestamp to format\n   * @param {string|Object} format - Format string or options object\n   * @returns {string} Formatted timestamp\n   */\n  static formatTimestamp(timestamp, format = 'short') {\n    if (typeof timestamp !== 'number' || isNaN(timestamp))\n      return 'Invalid date';\n\n    const date = new Date(timestamp);\n\n    if (typeof format === 'string') {\n      switch (format) {\n        case 'short':\n          return date.toLocaleDateString();\n        case 'long':\n          return `${date.toLocaleDateString()} ${date.toLocaleTimeString()}`;\n        case 'time':\n          return date.toLocaleTimeString();\n        case 'iso':\n          return date.toISOString();\n        case 'relative':\n          return this.getTimeAgo(timestamp);\n        case 'accessible':\n          return date.toLocaleDateString('en-US', {\n            weekday: 'long',\n            year: 'numeric',\n            month: 'long',\n            day: 'numeric',\n            hour: 'numeric',\n            minute: '2-digit',\n          });\n        default:\n          return date.toString();\n      }\n    }\n\n    // Format object with options\n    const options = {\n      locale: 'en-US',\n      includeTime: true,\n      includeWeekday: false,\n      ...format,\n    };\n\n    const dateOptions = {\n      year: 'numeric',\n      month: options.monthFormat || 'short',\n      day: 'numeric',\n    };\n\n    if (options.includeWeekday) {\n      dateOptions.weekday = 'long';\n    }\n\n    if (options.includeTime) {\n      dateOptions.hour = 'numeric';\n      dateOptions.minute = '2-digit';\n    }\n\n    return date.toLocaleDateString(options.locale, dateOptions);\n  }\n\n  /**\n   * Get human-readable time ago with enhanced precision\n   * @param {number} timestamp - Past timestamp\n   * @param {Object} options - Formatting options\n   * @returns {string} Time ago string\n   */\n  static getTimeAgo(timestamp, options = {}) {\n    if (typeof timestamp !== 'number' || isNaN(timestamp))\n      return 'Unknown time';\n\n    const { precise = false, shortForm = false } = options;\n\n    const now = Date.now();\n    const diff = now - timestamp;\n\n    if (diff < 0) return 'In the future';\n\n    const units = [\n      {\n        name: 'year',\n        short: 'y',\n        ms:\n          HELPERS_CONSTANTS.TIME.DAYS_PER_YEAR *\n          HELPERS_CONSTANTS.TIME.HOURS_PER_DAY *\n          HELPERS_CONSTANTS.TIME.SECONDS_PER_MINUTE *\n          HELPERS_CONSTANTS.TIME.SECONDS_PER_MINUTE *\n          HELPERS_CONSTANTS.TIME.MILLISECONDS_PER_SECOND,\n      },\n      {\n        name: 'month',\n        short: 'mo',\n        ms:\n          HELPERS_CONSTANTS.TIME.DAYS_PER_MONTH *\n          HELPERS_CONSTANTS.TIME.HOURS_PER_DAY *\n          HELPERS_CONSTANTS.TIME.SECONDS_PER_MINUTE *\n          HELPERS_CONSTANTS.TIME.SECONDS_PER_MINUTE *\n          HELPERS_CONSTANTS.TIME.MILLISECONDS_PER_SECOND,\n      },\n      {\n        name: 'week',\n        short: 'w',\n        ms:\n          HELPERS_CONSTANTS.TIME.DAYS_PER_WEEK *\n          HELPERS_CONSTANTS.TIME.HOURS_PER_DAY *\n          HELPERS_CONSTANTS.TIME.SECONDS_PER_MINUTE *\n          HELPERS_CONSTANTS.TIME.SECONDS_PER_MINUTE *\n          HELPERS_CONSTANTS.TIME.MILLISECONDS_PER_SECOND,\n      },\n      {\n        name: 'day',\n        short: 'd',\n        ms:\n          HELPERS_CONSTANTS.TIME.HOURS_PER_DAY *\n          HELPERS_CONSTANTS.TIME.SECONDS_PER_MINUTE *\n          HELPERS_CONSTANTS.TIME.SECONDS_PER_MINUTE *\n          HELPERS_CONSTANTS.TIME.MILLISECONDS_PER_SECOND,\n      },\n      {\n        name: 'hour',\n        short: 'h',\n        ms:\n          HELPERS_CONSTANTS.TIME.SECONDS_PER_MINUTE *\n          HELPERS_CONSTANTS.TIME.SECONDS_PER_MINUTE *\n          HELPERS_CONSTANTS.TIME.MILLISECONDS_PER_SECOND,\n      },\n      {\n        name: 'minute',\n        short: 'm',\n        ms:\n          HELPERS_CONSTANTS.TIME.SECONDS_PER_MINUTE *\n          HELPERS_CONSTANTS.TIME.MILLISECONDS_PER_SECOND,\n      },\n      {\n        name: 'second',\n        short: 's',\n        ms: HELPERS_CONSTANTS.TIME.MILLISECONDS_PER_SECOND,\n      },\n    ];\n\n    // Find the appropriate unit\n    for (const unit of units) {\n      if (diff >= unit.ms) {\n        const value = Math.floor(diff / unit.ms);\n        const unitName = shortForm ? unit.short : unit.name;\n        const plural = !shortForm && value > 1 ? 's' : '';\n\n        if (precise && units.indexOf(unit) < units.length - 1) {\n          const nextUnit = units[units.indexOf(unit) + 1];\n          const remainder = Math.floor((diff % unit.ms) / nextUnit.ms);\n          if (remainder > 0) {\n            const nextUnitName = shortForm ? nextUnit.short : nextUnit.name;\n            const nextPlural = !shortForm && remainder > 1 ? 's' : '';\n            return `${value}${unitName}${plural} ${remainder}${nextUnitName}${nextPlural} ago`;\n          }\n        }\n\n        return `${value}${shortForm ? '' : ' '}${unitName}${plural}${shortForm ? '' : ' ago'}`;\n      }\n    }\n\n    return 'Just now';\n  }\n\n  /**\n   * Parse various date formats\n   * @param {string|number} input - Date input\n   * @returns {Date|null} Parsed date or null if invalid\n   */\n  static parseDate(input) {\n    if (input instanceof Date) return input;\n    if (typeof input === 'number') return new Date(input);\n    if (typeof input !== 'string') return null;\n\n    // Try parsing ISO format first\n    const isoMatch = input.match(\n      /^\\d{4}-\\d{2}-\\d{2}(T\\d{2}:\\d{2}:\\d{2}(\\.\\d{3})?Z?)?$/\n    );\n    if (isoMatch) {\n      const date = new Date(input);\n      return isNaN(date.getTime()) ? null : date;\n    }\n\n    // Try common formats\n    const commonFormats = [\n      /^(\\d{1,2})\\/(\\d{1,2})\\/(\\d{4})$/, // MM/DD/YYYY\n      /^(\\d{4})\\/(\\d{1,2})\\/(\\d{1,2})$/, // YYYY/MM/DD\n      /^(\\d{1,2})-(\\d{1,2})-(\\d{4})$/, // MM-DD-YYYY\n      /^(\\d{4})-(\\d{1,2})-(\\d{1,2})$/, // YYYY-MM-DD\n    ];\n\n    for (const format of commonFormats) {\n      const match = input.match(format);\n      if (match) {\n        const date = new Date(input);\n        return isNaN(date.getTime()) ? null : date;\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Calculate business days between two dates\n   * @param {Date} startDate - Start date\n   * @param {Date} endDate - End date\n   * @param {number[]} excludedDays - Days to exclude (0=Sunday, 6=Saturday)\n   * @returns {number} Number of business days\n   */\n  static calculateBusinessDays(\n    startDate,\n    endDate,\n    excludedDays = HELPERS_CONSTANTS.WEEKEND_DAYS\n  ) {\n    if (!(startDate instanceof Date) || !(endDate instanceof Date)) return 0;\n\n    let count = 0;\n    const current = new Date(startDate);\n\n    while (current <= endDate) {\n      if (!excludedDays.includes(current.getDay())) {\n        count++;\n      }\n      current.setDate(current.getDate() + 1);\n    }\n\n    return count;\n  } // Enhanced Color utilities with accessibility and theme support\n  /**\n   * Convert hex color to RGB object\n   * @param {string} hex - Hex color string\n   * @returns {Object|null} RGB object or null if invalid\n   */\n  static hexToRgb(hex) {\n    if (typeof hex !== 'string') return null;\n\n    // Remove # if present and validate\n    hex = hex.replace('#', '');\n    if (!/^[0-9A-Fa-f]{6}$/.test(hex) && !/^[0-9A-Fa-f]{3}$/.test(hex))\n      return null;\n\n    // Expand 3-digit hex to 6-digit\n    if (hex.length === HELPERS_CONSTANTS.COLOR.HEX_SHORT_LENGTH) {\n      hex = hex\n        .split('')\n        .map(char => char + char)\n        .join('');\n    }\n\n    const result = /^([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    return result\n      ? {\n          r: parseInt(result[1], 16),\n          g: parseInt(result[2], 16),\n          b: parseInt(result[3], 16),\n        }\n      : null;\n  }\n\n  /**\n   * Convert RGB values to hex color\n   * @param {number} r - Red value (0-255)\n   * @param {number} g - Green value (0-255)\n   * @param {number} b - Blue value (0-255)\n   * @returns {string} Hex color string\n   */\n  static rgbToHex(r, g, b) {\n    r = this.clamp(Math.round(r), 0, HELPERS_CONSTANTS.COLOR.RGB_MAX);\n    g = this.clamp(Math.round(g), 0, HELPERS_CONSTANTS.COLOR.RGB_MAX);\n    b = this.clamp(Math.round(b), 0, HELPERS_CONSTANTS.COLOR.RGB_MAX);\n\n    return `#${((1 << HELPERS_CONSTANTS.COLOR.HEX_SHIFT_ALPHA) + (r << HELPERS_CONSTANTS.COLOR.HEX_SHIFT_RED) + (g << HELPERS_CONSTANTS.COLOR.HEX_SHIFT_GREEN) + b).toString(HELPERS_CONSTANTS.COLOR.HEX_BASE).slice(1)}`;\n  }\n\n  /**\n   * Interpolate between two colors\n   * @param {string} color1 - Start color (hex)\n   * @param {string} color2 - End color (hex)\n   * @param {number} factor - Interpolation factor (0-1)\n   * @returns {string} Interpolated color\n   */\n  static interpolateColor(color1, color2, factor) {\n    const rgb1 = this.hexToRgb(color1);\n    const rgb2 = this.hexToRgb(color2);\n\n    if (!rgb1 || !rgb2) return color1;\n\n    factor = this.clamp(factor, 0, 1);\n\n    const r = Math.round(this.lerp(rgb1.r, rgb2.r, factor));\n    const g = Math.round(this.lerp(rgb1.g, rgb2.g, factor));\n    const b = Math.round(this.lerp(rgb1.b, rgb2.b, factor));\n\n    return this.rgbToHex(r, g, b);\n  }\n\n  /**\n   * Get ethics-appropriate color based on score with accessibility support\n   * @param {number} value - Score value (0-100)\n   * @param {Object} options - Color options\n   * @returns {string} Color string\n   */\n  static getEthicsColor(value, options = {}) {\n    const { highContrast = false, colorBlindSafe = false } = options;\n\n    value = this.clamp(value, 0, 100);\n\n    if (highContrast) {\n      // High contrast colors for accessibility\n      if (value < HELPERS_CONSTANTS.COLOR.THRESHOLD_LOW) return '#ff0000'; // Red\n      if (value < HELPERS_CONSTANTS.COLOR.THRESHOLD_MEDIUM) return '#ffff00'; // Yellow\n      return '#00ff00'; // Green\n    }\n\n    if (colorBlindSafe) {\n      // Color-blind friendly palette\n      if (value < HELPERS_CONSTANTS.COLOR.THRESHOLD_LOW) return '#d73027'; // Red-orange\n      if (value < HELPERS_CONSTANTS.COLOR.THRESHOLD_MEDIUM) return '#fee08b'; // Yellow-orange\n      return '#4575b4'; // Blue\n    }\n\n    // Default light theme\n    if (value < HELPERS_CONSTANTS.COLOR.THRESHOLD_HIGH) {\n      return this.interpolateColor(\n        '#ff4444',\n        '#ffaa00',\n        value / HELPERS_CONSTANTS.COLOR.THRESHOLD_HIGH\n      );\n    } else {\n      return this.interpolateColor(\n        '#ffaa00',\n        '#00aa00',\n        (value - HELPERS_CONSTANTS.COLOR.THRESHOLD_HIGH) /\n          HELPERS_CONSTANTS.COLOR.THRESHOLD_HIGH\n      );\n    }\n  }\n\n  /**\n   * Calculate color contrast ratio for accessibility\n   * @param {string} color1 - First color (hex)\n   * @param {string} color2 - Second color (hex)\n   * @returns {number} Contrast ratio (1-21)\n   */\n  static getContrastRatio(color1, color2) {\n    const rgb1 = this.hexToRgb(color1);\n    const rgb2 = this.hexToRgb(color2);\n\n    if (!rgb1 || !rgb2) return 1;\n\n    const luminance1 = this.getLuminance(rgb1);\n    const luminance2 = this.getLuminance(rgb2);\n\n    const lighter = Math.max(luminance1, luminance2);\n    const darker = Math.min(luminance1, luminance2);\n\n    return (\n      (lighter + HELPERS_CONSTANTS.COLOR.LUMINANCE_OFFSET) /\n      (darker + HELPERS_CONSTANTS.COLOR.LUMINANCE_OFFSET)\n    );\n  }\n\n  /**\n   * Calculate relative luminance of a color\n   * @param {Object} rgb - RGB color object\n   * @returns {number} Relative luminance (0-1)\n   */\n  static getLuminance(rgb) {\n    const { r, g, b } = rgb;\n\n    const [rs, gs, bs] = [r, g, b].map(c => {\n      c = c / HELPERS_CONSTANTS.COLOR.RGB_MAX;\n      return c <= HELPERS_CONSTANTS.COLOR.LUMINANCE_THRESHOLD\n        ? c / HELPERS_CONSTANTS.COLOR.LUMINANCE_DIVISOR\n        : Math.pow(\n            (c + HELPERS_CONSTANTS.COLOR.LUMINANCE_OFFSET_2) /\n              HELPERS_CONSTANTS.COLOR.LUMINANCE_DIVISOR_2,\n            HELPERS_CONSTANTS.COLOR.LUMINANCE_EXPONENT\n          );\n    });\n\n    return (\n      HELPERS_CONSTANTS.COLOR.LUMINANCE_RED_WEIGHT * rs +\n      HELPERS_CONSTANTS.COLOR.LUMINANCE_GREEN_WEIGHT * gs +\n      HELPERS_CONSTANTS.COLOR.LUMINANCE_BLUE_WEIGHT * bs\n    );\n  }\n\n  /**\n   * Check if color combination meets WCAG accessibility standards\n   * @param {string} foreground - Foreground color (hex)\n   * @param {string} background - Background color (hex)\n   * @param {string} level - WCAG level ('AA' or 'AAA')\n   * @returns {Object} Accessibility assessment\n   */\n  static checkColorAccessibility(foreground, background, level = 'AA') {\n    const ratio = this.getContrastRatio(foreground, background);\n\n    const requirements = {\n      AA: { normal: 4.5, large: 3.0 },\n      AAA: { normal: 7.0, large: 4.5 },\n    };\n\n    const req = requirements[level] || requirements['AA'];\n\n    return {\n      ratio: this.roundTo(ratio, 2),\n      passesNormal: ratio >= req.normal,\n      passesLarge: ratio >= req.large,\n      level,\n      grade: ratio >= req.normal ? 'Pass' : 'Fail',\n      recommendation:\n        ratio < req.normal\n          ? `Increase contrast to at least ${req.normal}:1`\n          : 'Contrast meets accessibility guidelines',\n    };\n  }\n\n  /**\n   * Generate accessible color palette\n   * @param {string} baseColor - Base color (hex)\n   * @param {Object} options - Generation options\n   * @returns {Object} Color palette\n   */\n  static generateAccessiblePalette(baseColor, options = {}) {\n    const { steps = 5, lightBackground = '#ffffff' } = options;\n\n    const rgb = this.hexToRgb(baseColor);\n    if (!rgb) return null;\n\n    const palette = {\n      base: baseColor,\n      variations: [],\n      accessible: {\n        onLight: [],\n      },\n    };\n\n    // Generate variations\n    for (let i = 0; i < steps; i++) {\n      const factor = i / (steps - 1);\n      const lightVariation = this.interpolateColor(\n        baseColor,\n        '#ffffff',\n        factor * HELPERS_CONSTANTS.COLOR.FACTOR_LIGHTEN\n      );\n\n      palette.variations.push({\n        light: lightVariation,\n        factor: this.roundTo(factor, 2),\n      });\n\n      // Check accessibility on light background\n      const lightContrast = this.checkColorAccessibility(\n        lightVariation,\n        lightBackground\n      );\n\n      if (lightContrast.passesNormal) {\n        palette.accessible.onLight.push({\n          color: lightVariation,\n          contrast: lightContrast.ratio,\n        });\n      }\n    }\n\n    return palette;\n  }\n\n  /**\n   * Convert color to different formats\n   * @param {string} color - Input color (hex, rgb, hsl)\n   * @param {string} outputFormat - Output format ('hex', 'rgb', 'hsl')\n   * @returns {string|Object} Converted color\n   */\n  static convertColor(color, outputFormat = 'hex') {\n    const rgb = this.parseColorToRgb(color);\n    if (!rgb) return null;\n\n    switch (outputFormat.toLowerCase()) {\n      case 'hex': {\n        return this.rgbToHex(rgb.r, rgb.g, rgb.b);\n      }\n      case 'rgb': {\n        return `rgb(${rgb.r}, ${rgb.g}, ${rgb.b})`;\n      }\n      case 'hsl': {\n        const hsl = this.rgbToHsl(rgb);\n        return `hsl(${hsl.h}, ${hsl.s}%, ${hsl.l}%)`;\n      }\n      case 'object': {\n        return rgb;\n      }\n      default: {\n        return color;\n      }\n    }\n  }\n\n  /**\n   * Parse various color formats to RGB\n   * @param {string} color - Color string\n   * @returns {Object|null} RGB object\n   */\n  static parseColorToRgb(color) {\n    if (typeof color !== 'string') return null;\n\n    // Hex format\n    if (color.startsWith('#')) {\n      return this.hexToRgb(color);\n    }\n\n    // RGB format\n    const rgbMatch = color.match(/rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/);\n    if (rgbMatch) {\n      return {\n        r: parseInt(rgbMatch[1], 10),\n        g: parseInt(rgbMatch[2], 10),\n        b: parseInt(rgbMatch[3], 10),\n      };\n    }\n\n    // Named colors (basic set)\n    const namedColors = {\n      red: '#ff0000',\n      green: '#008000',\n      blue: '#0000ff',\n      white: '#ffffff',\n      black: '#000000',\n      yellow: '#ffff00',\n      cyan: '#00ffff',\n      magenta: '#ff00ff',\n    };\n\n    const namedColor = namedColors[color.toLowerCase()];\n    if (namedColor) {\n      return this.hexToRgb(namedColor);\n    }\n\n    return null;\n  }\n\n  /**\n   * Convert RGB to HSL\n   * @param {Object} rgb - RGB color object\n   * @returns {Object} HSL color object\n   */\n  static rgbToHsl(rgb) {\n    let { r, g, b } = rgb;\n    r /= HELPERS_CONSTANTS.COLOR.RGB_MAX;\n    g /= HELPERS_CONSTANTS.COLOR.RGB_MAX;\n    b /= HELPERS_CONSTANTS.COLOR.RGB_MAX;\n\n    const max = Math.max(r, g, b);\n    const min = Math.min(r, g, b);\n    let h;\n    let s;\n    const l = (max + min) / 2;\n\n    if (max === min) {\n      h = s = 0; // achromatic\n    } else {\n      const d = max - min;\n      s =\n        l > HELPERS_CONSTANTS.COLOR.HSL_LIGHTNESS_THRESHOLD\n          ? d / (HELPERS_CONSTANTS.COLOR.HSL_SATURATION_DIVISOR - max - min)\n          : d / (max + min);\n\n      switch (max) {\n        case r:\n          h =\n            (g - b) / d +\n            (g < b ? HELPERS_CONSTANTS.COLOR.HSL_HUE_SECTIONS : 0);\n          break;\n        case g:\n          h = (b - r) / d + 2;\n          break;\n        case b:\n          h = (r - g) / d + HELPERS_CONSTANTS.COLOR.HSL_HUE_RED_OFFSET;\n          break;\n      }\n      h /= HELPERS_CONSTANTS.COLOR.HSL_HUE_SECTIONS;\n    }\n\n    return {\n      h: Math.round(h * HELPERS_CONSTANTS.COLOR.HSL_HUE_CIRCLE),\n      s: Math.round(s * 100),\n      l: Math.round(l * 100),\n    };\n  } // Enhanced DOM utilities with accessibility and performance features\n  /**\n   * Create an element with comprehensive options\n   * @param {string} tag - HTML tag name\n   * @param {string|Object} className - CSS class name or options object\n   * @param {Object} attributes - Element attributes\n   * @returns {HTMLElement} Created element\n   */\n  static createElement(tag, className = '', attributes = {}) {\n    if (typeof tag !== 'string' || tag.trim() === '') {\n      throw new Error('Invalid tag name provided');\n    }\n\n    const element = document.createElement(tag);\n\n    // Handle className parameter\n    if (typeof className === 'object' && className !== null) {\n      // If className is actually an options object\n      attributes = { ...className, ...attributes };\n      className = attributes.className || '';\n    }\n\n    if (className) element.className = className;\n\n    Object.entries(attributes).forEach(([key, value]) => {\n      if (key === 'style' && typeof value === 'object') {\n        Object.assign(element.style, value);\n      } else if (key === 'dataset' && typeof value === 'object') {\n        Object.entries(value).forEach(([dataKey, dataValue]) => {\n          element.dataset[dataKey] = dataValue;\n        });\n      } else if (key === 'listeners' && typeof value === 'object') {\n        Object.entries(value).forEach(([event, handler]) => {\n          element.addEventListener(event, handler);\n        });\n      } else if (key === 'children' && Array.isArray(value)) {\n        value.forEach(child => {\n          if (child instanceof HTMLElement) {\n            element.appendChild(child);\n          } else if (typeof child === 'string') {\n            element.appendChild(document.createTextNode(child));\n          }\n        });\n      } else if (key === 'innerHTML') {\n        element.innerHTML = value;\n      } else if (key === 'textContent') {\n        element.textContent = value;\n      } else if (key !== 'className') {\n        element.setAttribute(key, value);\n      }\n    });\n\n    return element;\n  }\n\n  /**\n   * Get comprehensive element position and dimensions\n   * @param {HTMLElement} element - Target element\n   * @param {Object} options - Position calculation options\n   * @returns {Object} Position and dimension data\n   */\n  static getElementPosition(element, options = {}) {\n    if (!(element instanceof HTMLElement)) {\n      return { x: 0, y: 0, width: 0, height: 0, visible: false };\n    }\n\n    const {\n      includeMargin = false,\n      includePadding = false,\n      relativeTo = null,\n    } = options;\n\n    const rect = element.getBoundingClientRect();\n    const styles = window.getComputedStyle(element);\n\n    const position = {\n      x: rect.left + window.scrollX,\n      y: rect.top + window.scrollY,\n      width: rect.width,\n      height: rect.height,\n      top: rect.top,\n      left: rect.left,\n      bottom: rect.bottom,\n      right: rect.right,\n      visible: this.isElementVisible(element),\n    };\n\n    if (includeMargin) {\n      const margin = {\n        top: parseFloat(styles.marginTop) || 0,\n        right: parseFloat(styles.marginRight) || 0,\n        bottom: parseFloat(styles.marginBottom) || 0,\n        left: parseFloat(styles.marginLeft) || 0,\n      };\n\n      position.margin = margin;\n      position.outerWidth = position.width + margin.left + margin.right;\n      position.outerHeight = position.height + margin.top + margin.bottom;\n    }\n\n    if (includePadding) {\n      const padding = {\n        top: parseFloat(styles.paddingTop) || 0,\n        right: parseFloat(styles.paddingRight) || 0,\n        bottom: parseFloat(styles.paddingBottom) || 0,\n        left: parseFloat(styles.paddingLeft) || 0,\n      };\n\n      position.padding = padding;\n      position.innerWidth = position.width - padding.left - padding.right;\n      position.innerHeight = position.height - padding.top - padding.bottom;\n    }\n\n    if (relativeTo && relativeTo instanceof HTMLElement) {\n      const relativeRect = relativeTo.getBoundingClientRect();\n      position.relativeX = rect.left - relativeRect.left;\n      position.relativeY = rect.top - relativeRect.top;\n    }\n\n    return position;\n  }\n\n  /**\n   * Enhanced element visibility checking\n   * @param {HTMLElement} element - Element to check\n   * @param {Object} options - Visibility options\n   * @returns {boolean|Object} Visibility status\n   */\n  static isElementVisible(element, options = {}) {\n    if (!(element instanceof HTMLElement)) return false;\n\n    const {\n      threshold = 0,\n      partial = false,\n      checkOpacity = true,\n      checkDisplay = true,\n      returnDetails = false,\n    } = options;\n\n    const rect = element.getBoundingClientRect();\n    const styles = window.getComputedStyle(element);\n\n    const viewport = {\n      width: window.innerWidth || document.documentElement.clientWidth,\n      height: window.innerHeight || document.documentElement.clientHeight,\n    };\n\n    const visibility = {\n      inViewport: false,\n      percentageVisible: 0,\n      opacity: parseFloat(styles.opacity),\n      display: styles.display,\n      visibility: styles.visibility,\n      dimensions: { width: rect.width, height: rect.height },\n    };\n\n    // Check basic visibility styles\n    if (\n      checkDisplay &&\n      (styles.display === 'none' || styles.visibility === 'hidden')\n    ) {\n      return returnDetails ? visibility : false;\n    }\n\n    if (checkOpacity && visibility.opacity <= 0) {\n      return returnDetails ? visibility : false;\n    }\n\n    // Calculate viewport intersection\n    const intersectionWidth = Math.max(\n      0,\n      Math.min(rect.right, viewport.width) - Math.max(rect.left, 0)\n    );\n    const intersectionHeight = Math.max(\n      0,\n      Math.min(rect.bottom, viewport.height) - Math.max(rect.top, 0)\n    );\n    const intersectionArea = intersectionWidth * intersectionHeight;\n    const elementArea = rect.width * rect.height;\n\n    visibility.percentageVisible =\n      elementArea > 0 ? (intersectionArea / elementArea) * 100 : 0;\n    visibility.inViewport = visibility.percentageVisible >= threshold;\n\n    if (partial) {\n      visibility.inViewport = visibility.percentageVisible > 0;\n    }\n\n    return returnDetails ? visibility : visibility.inViewport;\n  }\n\n  /**\n   * Enhanced scroll to element with accessibility support\n   * @param {HTMLElement} element - Element to scroll to\n   * @param {Object} options - Scroll options\n   */\n  static scrollToElement(element, options = {}) {\n    if (!(element instanceof HTMLElement)) return;\n\n    const {\n      behavior = 'smooth',\n      block = 'center',\n      inline = 'nearest',\n      offset = 0,\n      respectReducedMotion = true,\n      focus = false,\n      announceToScreenReader = false,\n    } = options;\n\n    // Respect user's motion preferences\n    const prefersReducedMotion = window.matchMedia(\n      '(prefers-reduced-motion: reduce)'\n    ).matches;\n    const actualBehavior =\n      respectReducedMotion && prefersReducedMotion ? 'auto' : behavior;\n\n    // Calculate target position with offset\n    if (offset !== 0) {\n      const elementRect = element.getBoundingClientRect();\n      const targetY = elementRect.top + window.scrollY + offset;\n\n      window.scrollTo({\n        top: targetY,\n        behavior: actualBehavior,\n      });\n    } else {\n      element.scrollIntoView({\n        behavior: actualBehavior,\n        block,\n        inline,\n      });\n    }\n\n    // Optional focus management\n    if (focus) {\n      // Ensure element is focusable\n      if (\n        !element.hasAttribute('tabindex') &&\n        !element.matches('a, button, input, select, textarea')\n      ) {\n        element.setAttribute('tabindex', '-1');\n      }\n\n      setTimeout(\n        () => {\n          element.focus();\n\n          // Remove temporary tabindex\n          if (\n            element.getAttribute('tabindex') === '-1' &&\n            !element.matches('a, button, input, select, textarea')\n          ) {\n            element.removeAttribute('tabindex');\n          }\n        },\n        actualBehavior === 'smooth'\n          ? HELPERS_CONSTANTS.UI.SMOOTH_SCROLL_DURATION\n          : 0\n      );\n    }\n\n    // Screen reader announcement\n    if (announceToScreenReader) {\n      const announcement = `Scrolled to ${element.textContent || element.getAttribute('aria-label') || 'content'}`;\n      this.announceToScreenReader(announcement);\n    }\n  }\n\n  /**\n   * Announce message to screen readers\n   * @param {string} message - Message to announce\n   * @param {string} priority - Priority level ('polite' or 'assertive')\n   */\n  static announceToScreenReader(message, priority = 'polite') {\n    const announcer = document.createElement('div');\n    announcer.setAttribute('aria-live', priority);\n    announcer.setAttribute('aria-atomic', 'true');\n    announcer.style.position = 'absolute';\n    announcer.style.left = '-10000px';\n    announcer.style.width = '1px';\n    announcer.style.height = '1px';\n    announcer.style.overflow = 'hidden';\n\n    document.body.appendChild(announcer);\n    announcer.textContent = message;\n\n    setTimeout(() => {\n      document.body.removeChild(announcer);\n    }, 1000);\n  }\n\n  /**\n   * Create accessible tooltip\n   * @param {HTMLElement} trigger - Element that triggers tooltip\n   * @param {string} content - Tooltip content\n   * @param {Object} options - Tooltip options\n   * @returns {HTMLElement} Tooltip element\n   */\n  static createAccessibleTooltip(trigger, content, options = {}) {\n    const {\n      position = 'top',\n      delay = 500,\n      hideDelay = 100,\n      className = 'tooltip',\n      id = `tooltip-${this.generateRandomString(HELPERS_CONSTANTS.UI.TOOLTIP_ID_LENGTH)}`,\n    } = options;\n\n    const tooltip = this.createElement('div', {\n      id,\n      className: `${className} ${className}--${position}`,\n      role: 'tooltip',\n      'aria-hidden': 'true',\n      textContent: content,\n      style: {\n        position: 'absolute',\n        zIndex: '9999',\n        visibility: 'hidden',\n        opacity: '0',\n        transition: 'opacity 0.2s, visibility 0.2s',\n      },\n    });\n\n    document.body.appendChild(tooltip);\n\n    // Set up ARIA relationship\n    trigger.setAttribute('aria-describedby', id);\n\n    let showTimeout, hideTimeout;\n\n    const showTooltip = () => {\n      clearTimeout(hideTimeout);\n      showTimeout = setTimeout(() => {\n        const triggerRect = trigger.getBoundingClientRect();\n        const tooltipRect = tooltip.getBoundingClientRect();\n\n        let top, left;\n\n        switch (position) {\n          case 'top':\n            top =\n              triggerRect.top -\n              tooltipRect.height -\n              HELPERS_CONSTANTS.UI.TOOLTIP_SPACING;\n            left =\n              triggerRect.left + (triggerRect.width - tooltipRect.width) / 2;\n            break;\n          case 'bottom':\n            top = triggerRect.bottom + HELPERS_CONSTANTS.UI.TOOLTIP_SPACING;\n            left =\n              triggerRect.left + (triggerRect.width - tooltipRect.width) / 2;\n            break;\n          case 'left':\n            top =\n              triggerRect.top + (triggerRect.height - tooltipRect.height) / 2;\n            left =\n              triggerRect.left -\n              tooltipRect.width -\n              HELPERS_CONSTANTS.UI.TOOLTIP_SPACING;\n            break;\n          case 'right':\n            top =\n              triggerRect.top + (triggerRect.height - tooltipRect.height) / 2;\n            left = triggerRect.right + HELPERS_CONSTANTS.UI.TOOLTIP_SPACING;\n            break;\n        }\n\n        tooltip.style.top = `${top + window.scrollY}px`;\n        tooltip.style.left = `${left + window.scrollX}px`;\n        tooltip.style.visibility = 'visible';\n        tooltip.style.opacity = '1';\n        tooltip.setAttribute('aria-hidden', 'false');\n      }, delay);\n    };\n\n    const hideTooltip = () => {\n      clearTimeout(showTimeout);\n      hideTimeout = setTimeout(() => {\n        tooltip.style.visibility = 'hidden';\n        tooltip.style.opacity = '0';\n        tooltip.setAttribute('aria-hidden', 'true');\n      }, hideDelay);\n    };\n\n    trigger.addEventListener('mouseenter', showTooltip);\n    trigger.addEventListener('mouseleave', hideTooltip);\n    trigger.addEventListener('focus', showTooltip);\n    trigger.addEventListener('blur', hideTooltip);\n\n    return tooltip;\n  } // Enhanced Event utilities with performance monitoring and accessibility\n  /**\n   * Create a debounced function with performance monitoring\n   * @param {Function} func - Function to debounce\n   * @param {number} wait - Wait time in milliseconds\n   * @param {Object} options - Debounce options\n   * @returns {Function} Debounced function\n   */\n  static debounce(func, wait, options = {}) {\n    const {\n      immediate = false,\n      maxWait = null,\n      trackPerformance = false,\n      context = null,\n    } = options;\n\n    let timeout,\n      maxTimeout,\n      lastCallTime = 0;\n\n    const debounced = function executedFunction(...args) {\n      const currentTime = Date.now();\n      const ctx = context || this;\n\n      const later = () => {\n        timeout = null;\n        maxTimeout = null;\n        if (!immediate) {\n          if (trackPerformance) {\n            const start = performance.now();\n            const result = func.apply(ctx, args);\n            const duration = performance.now() - start;\n            logger.debug(\n              `Debounced function executed in ${duration.toFixed(2)}ms`\n            );\n            return result;\n          } else {\n            return func.apply(ctx, args);\n          }\n        }\n        return undefined;\n      };\n\n      const callNow = immediate && !timeout;\n\n      clearTimeout(timeout);\n      if (maxTimeout) clearTimeout(maxTimeout);\n\n      timeout = setTimeout(later, wait);\n\n      // Ensure function is called within maxWait if specified\n      if (maxWait && currentTime - lastCallTime >= maxWait) {\n        later();\n        lastCallTime = currentTime;\n      } else if (maxWait && !maxTimeout) {\n        maxTimeout = setTimeout(later, maxWait - (currentTime - lastCallTime));\n      }\n\n      if (callNow) {\n        lastCallTime = currentTime;\n        return func.apply(ctx, args);\n      }\n      return undefined;\n    };\n\n    debounced.cancel = () => {\n      clearTimeout(timeout);\n      if (maxTimeout) clearTimeout(maxTimeout);\n      timeout = maxTimeout = null;\n    };\n\n    debounced.flush = (...args) => {\n      if (timeout) {\n        clearTimeout(timeout);\n        timeout = null;\n        return func.apply(context, args);\n      }\n      return undefined;\n    };\n\n    return debounced;\n  }\n\n  /**\n   * Create a throttled function with accessibility considerations\n   * @param {Function} func - Function to throttle\n   * @param {number} limit - Throttle limit in milliseconds\n   * @param {Object} options - Throttle options\n   * @returns {Function} Throttled function\n   */\n  static throttle(func, limit, options = {}) {\n    const {\n      leading = true,\n      trailing = true,\n      respectReducedMotion = true,\n      trackPerformance = false,\n    } = options;\n\n    let lastFunc, lastRan;\n\n    return function executedFunction(...args) {\n      // Respect user's motion preferences for visual updates\n      if (\n        respectReducedMotion &&\n        window.matchMedia('(prefers-reduced-motion: reduce)').matches\n      ) {\n        // Increase throttle limit for reduced motion users\n        limit = Math.max(limit, 100);\n      }\n\n      const context = this;\n      const now = Date.now();\n\n      if (!lastRan && leading) {\n        if (trackPerformance) {\n          const start = performance.now();\n          func.apply(context, args);\n          const duration = performance.now() - start;\n          logger.debug(\n            `Throttled function (leading) executed in ${duration.toFixed(2)}ms`\n          );\n        } else {\n          func.apply(context, args);\n        }\n        lastRan = now;\n      } else {\n        clearTimeout(lastFunc);\n        lastFunc = setTimeout(\n          () => {\n            if (now - lastRan >= limit && trailing) {\n              if (trackPerformance) {\n                const start = performance.now();\n                func.apply(context, args);\n                const duration = performance.now() - start;\n                logger.debug(\n                  `Throttled function (trailing) executed in ${duration.toFixed(2)}ms`\n                );\n              } else {\n                func.apply(context, args);\n              }\n              lastRan = Date.now();\n            }\n          },\n          limit - (now - lastRan)\n        );\n      }\n    };\n  }\n\n  /**\n   * Create a function that can only be called once\n   * @param {Function} func - Function to call once\n   * @param {Object} options - Once options\n   * @returns {Function} Once function\n   */\n  static once(func, options = {}) {\n    const { resetAfter = null, trackCalls = false } = options;\n\n    let called = false;\n    let callCount = 0;\n    let result;\n\n    const onceFunction = function executedFunction(...args) {\n      callCount++;\n\n      if (trackCalls && called) {\n        logger.warn(\n          `Function called ${callCount} times, but can only execute once`\n        );\n      }\n\n      if (!called) {\n        called = true;\n        result = func.apply(this, args);\n\n        // Optional reset mechanism\n        if (resetAfter && typeof resetAfter === 'number') {\n          setTimeout(() => {\n            called = false;\n            callCount = 0;\n          }, resetAfter);\n        }\n      }\n\n      return result;\n    };\n\n    onceFunction.reset = () => {\n      called = false;\n      callCount = 0;\n      result = undefined;\n    };\n\n    onceFunction.hasBeenCalled = () => called;\n    onceFunction.getCallCount = () => callCount;\n\n    return onceFunction;\n  }\n\n  /**\n   * Create an event handler with enhanced features\n   * @param {HTMLElement} element - Target element\n   * @param {string} event - Event type\n   * @param {Function} handler - Event handler\n   * @param {Object} options - Event options\n   * @returns {Function} Cleanup function\n   */\n  static createEventHandler(element, event, handler, options = {}) {\n    const {\n      once = false,\n      passive = true,\n      capture = false,\n      debounce: debounceTime = null,\n      throttle: throttleTime = null,\n      preventDefault = false,\n      stopPropagation = false,\n      trackPerformance = false,\n    } = options;\n\n    let processedHandler = handler;\n\n    // Add performance tracking\n    if (trackPerformance) {\n      const originalHandler = processedHandler;\n      processedHandler = function (...args) {\n        const start = performance.now();\n        const result = originalHandler.apply(this, args);\n        const duration = performance.now() - start;\n        logger.debug(\n          `Event handler for ${event} executed in ${duration.toFixed(2)}ms`\n        );\n        return result;\n      };\n    }\n\n    // Add event control\n    if (preventDefault || stopPropagation) {\n      const originalHandler = processedHandler;\n      processedHandler = function (e, ...args) {\n        if (preventDefault) e.preventDefault();\n        if (stopPropagation) e.stopPropagation();\n        return originalHandler.apply(this, [e, ...args]);\n      };\n    }\n\n    // Add debounce or throttle\n    if (debounceTime) {\n      processedHandler = this.debounce(processedHandler, debounceTime);\n    } else if (throttleTime) {\n      processedHandler = this.throttle(processedHandler, throttleTime);\n    }\n\n    const eventOptions = { once, passive, capture };\n    element.addEventListener(event, processedHandler, eventOptions);\n\n    return () =>\n      element.removeEventListener(event, processedHandler, eventOptions);\n  }\n\n  /**\n   * Create a keyboard navigation helper\n   * @param {HTMLElement} container - Container element\n   * @param {Object} options - Navigation options\n   * @returns {Object} Navigation controller\n   */\n  static createKeyboardNavigation(container, options = {}) {\n    const {\n      selector = '[tabindex], a, button, input, select, textarea',\n      circular = true,\n      skipHidden = true,\n      announceNavigation = true,\n    } = options;\n\n    let currentIndex = 0;\n    let elements = [];\n\n    const updateElements = () => {\n      elements = Array.from(container.querySelectorAll(selector)).filter(\n        el => !skipHidden || this.isElementVisible(el)\n      );\n    };\n\n    const navigate = direction => {\n      updateElements();\n      if (elements.length === 0) return;\n\n      const oldIndex = currentIndex;\n\n      if (direction === 'next') {\n        currentIndex = circular\n          ? (currentIndex + 1) % elements.length\n          : Math.min(currentIndex + 1, elements.length - 1);\n      } else if (direction === 'previous') {\n        currentIndex = circular\n          ? (currentIndex - 1 + elements.length) % elements.length\n          : Math.max(currentIndex - 1, 0);\n      } else if (direction === 'first') {\n        currentIndex = 0;\n      } else if (direction === 'last') {\n        currentIndex = elements.length - 1;\n      }\n\n      const targetElement = elements[currentIndex];\n      if (targetElement) {\n        targetElement.focus();\n\n        if (announceNavigation && currentIndex !== oldIndex) {\n          const announcement = `Focused on ${targetElement.textContent || targetElement.getAttribute('aria-label') || 'interactive element'}`;\n          this.announceToScreenReader(announcement);\n        }\n      }\n    };\n\n    const keydownHandler = e => {\n      switch (e.key) {\n        case 'ArrowDown':\n        case 'ArrowRight':\n          e.preventDefault();\n          navigate('next');\n          break;\n        case 'ArrowUp':\n        case 'ArrowLeft':\n          e.preventDefault();\n          navigate('previous');\n          break;\n        case 'Home':\n          e.preventDefault();\n          navigate('first');\n          break;\n        case 'End':\n          e.preventDefault();\n          navigate('last');\n          break;\n      }\n    };\n\n    container.addEventListener('keydown', keydownHandler);\n    updateElements();\n\n    return {\n      navigate,\n      updateElements,\n      getCurrentElement: () => elements[currentIndex],\n      destroy: () => container.removeEventListener('keydown', keydownHandler),\n    };\n  } // Enhanced Validation utilities with security and accessibility\n  /**\n   * Comprehensive email validation with security features\n   * @param {string} email - Email to validate\n   * @param {Object} options - Validation options\n   * @returns {Object} Validation result\n   */\n  static validateEmail(email, options = {}) {\n    const {\n      allowInternational = true,\n      maxLength = 254,\n      blockedDomains = [],\n      requireTld = true,\n    } = options;\n\n    if (typeof email !== 'string') {\n      return { valid: false, error: 'Email must be a string' };\n    }\n\n    if (email.length > maxLength) {\n      return {\n        valid: false,\n        error: `Email exceeds maximum length of ${maxLength}`,\n      };\n    }\n\n    // Basic format validation\n    const basicPattern = allowInternational\n      ? /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/\n      : /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/;\n\n    if (!basicPattern.test(email)) {\n      return { valid: false, error: 'Invalid email format' };\n    }\n\n    // Check for blocked domains\n    const domain = email.split('@')[1];\n    if (blockedDomains.includes(domain.toLowerCase())) {\n      return { valid: false, error: 'Email domain is not allowed' };\n    }\n\n    // TLD validation\n    if (requireTld && !domain.includes('.')) {\n      return {\n        valid: false,\n        error: 'Email must have a valid top-level domain',\n      };\n    }\n\n    // Additional security checks\n    const securityIssues = [];\n    if (email.includes('..'))\n      securityIssues.push('Consecutive dots not allowed');\n    if (email.startsWith('.') || email.endsWith('.'))\n      securityIssues.push('Cannot start or end with dot');\n\n    if (securityIssues.length > 0) {\n      return { valid: false, error: securityIssues.join(', ') };\n    }\n\n    return {\n      valid: true,\n      normalized: email.toLowerCase().trim(),\n      domain,\n      local: email.split('@')[0],\n    };\n  }\n\n  /**\n   * Enhanced URL validation with security checks\n   * @param {string} url - URL to validate\n   * @param {Object} options - Validation options\n   * @returns {Object} Validation result\n   */\n  static validateUrl(url, options = {}) {\n    const {\n      allowedProtocols = ['http:', 'https:'],\n      allowLocalhost = false,\n      allowPrivateIps = false,\n      maxLength = 2048,\n      requireTld = true,\n    } = options;\n\n    if (typeof url !== 'string') {\n      return { valid: false, error: 'URL must be a string' };\n    }\n\n    if (url.length > maxLength) {\n      return {\n        valid: false,\n        error: `URL exceeds maximum length of ${maxLength}`,\n      };\n    }\n\n    try {\n      const urlObj = new URL(url);\n\n      // Protocol validation\n      if (!allowedProtocols.includes(urlObj.protocol)) {\n        return {\n          valid: false,\n          error: `Protocol ${urlObj.protocol} not allowed. Allowed: ${allowedProtocols.join(', ')}`,\n        };\n      }\n\n      // Localhost validation\n      if (\n        !allowLocalhost &&\n        (urlObj.hostname === 'localhost' || urlObj.hostname === '127.0.0.1')\n      ) {\n        return { valid: false, error: 'Localhost URLs not allowed' };\n      }\n\n      // Private IP validation\n      if (!allowPrivateIps && this.isPrivateIp(urlObj.hostname)) {\n        return { valid: false, error: 'Private IP addresses not allowed' };\n      }\n\n      // TLD validation\n      if (requireTld && !urlObj.hostname.includes('.')) {\n        return {\n          valid: false,\n          error: 'URL must have a valid top-level domain',\n        };\n      }\n\n      return {\n        valid: true,\n        parsed: {\n          protocol: urlObj.protocol,\n          hostname: urlObj.hostname,\n          pathname: urlObj.pathname,\n          search: urlObj.search,\n          hash: urlObj.hash,\n        },\n      };\n    } catch (error) {\n      return { valid: false, error: 'Invalid URL format' };\n    }\n  }\n\n  /**\n   * Check if IP address is private\n   * @param {string} ip - IP address to check\n   * @returns {boolean} True if private IP\n   */\n  static isPrivateIp(ip) {\n    const privateRanges = [\n      /^10\\./,\n      /^172\\.(1[6-9]|2[0-9]|3[0-1])\\./,\n      /^192\\.168\\./,\n      /^127\\./,\n      /^169\\.254\\./,\n      /^::1$/,\n      /^fc00:/,\n      /^fe80:/,\n    ];\n\n    return privateRanges.some(range => range.test(ip));\n  }\n\n  /**\n   * Validate password strength with accessibility feedback\n   * @param {string} password - Password to validate\n   * @param {Object} options - Validation options\n   * @returns {Object} Validation result with accessibility features\n   */\n  static validatePassword(password, options = {}) {\n    const {\n      minLength = 8,\n      maxLength = 128,\n      requireUppercase = true,\n      requireLowercase = true,\n      requireNumbers = true,\n      requireSymbols = true,\n      blockedPatterns = [],\n      provideFeedback = true,\n    } = options;\n\n    if (typeof password !== 'string') {\n      return { valid: false, error: 'Password must be a string', score: 0 };\n    }\n\n    const feedback = [];\n    const errors = [];\n    let score = 0;\n\n    // Length validation\n    if (password.length < minLength) {\n      errors.push(`Password must be at least ${minLength} characters long`);\n    } else if (password.length >= minLength) {\n      score += HELPERS_CONSTANTS.SCORING.PASSWORD_BASE_SCORE;\n      if (\n        password.length >= HELPERS_CONSTANTS.SCORING.PASSWORD_MIN_SECURE_LENGTH\n      )\n        score += HELPERS_CONSTANTS.SCORING.PASSWORD_LENGTH_BONUS;\n    }\n\n    if (password.length > maxLength) {\n      errors.push(`Password must not exceed ${maxLength} characters`);\n    }\n\n    // Character type validation\n    const hasUppercase = /[A-Z]/.test(password);\n    const hasLowercase = /[a-z]/.test(password);\n    const hasNumbers = /\\d/.test(password);\n    const hasSymbols = /[!@#$%^&*(),.?\":{}|<>]/.test(password);\n\n    if (requireUppercase && !hasUppercase) {\n      errors.push('Password must contain at least one uppercase letter');\n    } else if (hasUppercase) {\n      score += HELPERS_CONSTANTS.SCORING.PASSWORD_VARIETY_BONUS;\n    }\n\n    if (requireLowercase && !hasLowercase) {\n      errors.push('Password must contain at least one lowercase letter');\n    } else if (hasLowercase) {\n      score += HELPERS_CONSTANTS.SCORING.PASSWORD_VARIETY_BONUS;\n    }\n\n    if (requireNumbers && !hasNumbers) {\n      errors.push('Password must contain at least one number');\n    } else if (hasNumbers) {\n      score += HELPERS_CONSTANTS.SCORING.PASSWORD_VARIETY_BONUS;\n    }\n\n    if (requireSymbols && !hasSymbols) {\n      errors.push('Password must contain at least one special character');\n    } else if (hasSymbols) {\n      score += HELPERS_CONSTANTS.SCORING.PASSWORD_VARIETY_BONUS;\n    }\n\n    // Pattern validation\n    for (const pattern of blockedPatterns) {\n      if (pattern.test(password)) {\n        errors.push('Password contains blocked pattern');\n        score -= HELPERS_CONSTANTS.SCORING.PASSWORD_REPETITION_PENALTY;\n      }\n    }\n\n    // Common patterns check\n    const commonPatterns = [\n      /(.)\\1{2,}/, // Repeated characters\n      /123456/, // Sequential numbers\n      /abcdef/, // Sequential letters\n      /password/i, // Common word\n      /qwerty/i, // Keyboard pattern\n    ];\n\n    for (const pattern of commonPatterns) {\n      if (pattern.test(password)) {\n        score -= 10;\n        if (provideFeedback) {\n          feedback.push('Avoid common patterns and repeated characters');\n        }\n        break;\n      }\n    }\n\n    // Generate strength feedback\n    let strength = 'weak';\n    if (score >= HELPERS_CONSTANTS.SCORING.PASSWORD_STRENGTH_VERY_STRONG)\n      strength = 'very strong';\n    else if (score >= HELPERS_CONSTANTS.SCORING.PASSWORD_STRENGTH_STRONG)\n      strength = 'strong';\n    else if (score >= HELPERS_CONSTANTS.SCORING.PASSWORD_STRENGTH_MODERATE)\n      strength = 'moderate';\n\n    if (provideFeedback) {\n      if (score < HELPERS_CONSTANTS.SCORING.PASSWORD_STRENGTH_WEAK_THRESHOLD) {\n        feedback.push(\n          'Consider using a longer password with mixed character types'\n        );\n      }\n      if (!hasSymbols && requireSymbols) {\n        feedback.push('Adding special characters improves security');\n      }\n    }\n\n    return {\n      valid: errors.length === 0,\n      errors,\n      score: Math.max(0, Math.min(100, score)),\n      strength,\n      feedback,\n      hasUppercase,\n      hasLowercase,\n      hasNumbers,\n      hasSymbols,\n      length: password.length,\n    };\n  }\n\n  /**\n   * Advanced input sanitization with security features\n   * @param {string} input - Input to sanitize\n   * @param {Object} options - Sanitization options\n   * @returns {string} Sanitized input\n   */\n  static sanitizeInput(input, options = {}) {\n    const {\n      allowHtml = false,\n      allowUrls = true,\n      maxLength = null,\n      trimWhitespace = true,\n      removeInvisibleChars = true,\n      normalizeUnicode = true,\n    } = options;\n\n    if (typeof input !== 'string') return '';\n\n    let sanitized = input;\n\n    // Trim whitespace\n    if (trimWhitespace) {\n      sanitized = sanitized.trim();\n    }\n\n    // Remove invisible characters\n    if (removeInvisibleChars) {\n      sanitized = sanitized.replace(/[\\u200B-\\u200D\\uFEFF]/g, '');\n    }\n\n    // Normalize unicode\n    if (normalizeUnicode) {\n      sanitized = sanitized.normalize('NFKC');\n    }\n\n    // HTML sanitization\n    if (!allowHtml) {\n      sanitized = this.escapeHtml(sanitized);\n    }\n\n    // URL validation\n    if (!allowUrls) {\n      sanitized = sanitized.replace(/https?:\\/\\/[^\\s]+/g, '[URL removed]');\n    }\n\n    // Length limiting\n    if (maxLength && sanitized.length > maxLength) {\n      sanitized = sanitized.substring(0, maxLength);\n    }\n\n    return sanitized;\n  }\n\n  /**\n   * Legacy validation methods with enhanced features\n   */\n  static isValidEmail(email) {\n    const result = this.validateEmail(email);\n    return result.valid;\n  }\n\n  static isValidUrl(url) {\n    const result = this.validateUrl(url);\n    return result.valid;\n  }\n\n  static isNumeric(value) {\n    return !isNaN(parseFloat(value)) && isFinite(value);\n  }\n\n  static isEmpty(value) {\n    return (\n      value == null ||\n      value === '' ||\n      (Array.isArray(value) && value.length === 0) ||\n      (typeof value === 'object' && Object.keys(value).length === 0)\n    );\n  }\n\n  /**\n   * Validate accessibility requirements for form inputs\n   * @param {HTMLElement} input - Input element to validate\n   * @returns {Object} Accessibility validation result\n   */\n  static validateInputAccessibility(input) {\n    const issues = [];\n    const recommendations = [];\n\n    // Check for label association\n    const id = input.getAttribute('id');\n    const hasLabel = id && document.querySelector(`label[for=\"${id}\"]`);\n    const hasAriaLabel = input.getAttribute('aria-label');\n    const hasAriaLabelledBy = input.getAttribute('aria-labelledby');\n\n    if (!hasLabel && !hasAriaLabel && !hasAriaLabelledBy) {\n      issues.push('Input lacks proper labeling');\n      recommendations.push('Add a label element or aria-label attribute');\n    }\n\n    // Check for error handling\n    const hasAriaInvalid = input.hasAttribute('aria-invalid');\n\n    if (input.checkValidity && !input.checkValidity() && !hasAriaInvalid) {\n      issues.push('Invalid input lacks aria-invalid attribute');\n      recommendations.push('Add aria-invalid=\"true\" for invalid inputs');\n    }\n\n    // Check contrast for visible elements\n    if (this.isElementVisible(input)) {\n      const styles = window.getComputedStyle(input);\n      const bgColor = styles.backgroundColor;\n      const textColor = styles.color;\n\n      if (bgColor !== 'rgba(0, 0, 0, 0)' && textColor !== 'rgba(0, 0, 0, 0)') {\n        const contrastInfo = this.checkColorAccessibility(textColor, bgColor);\n        if (!contrastInfo.passesNormal) {\n          issues.push(`Insufficient color contrast (${contrastInfo.ratio}:1)`);\n          recommendations.push('Increase color contrast to at least 4.5:1');\n        }\n      }\n    }\n\n    return {\n      accessible: issues.length === 0,\n      issues,\n      recommendations,\n      score: Math.max(\n        0,\n        100 -\n          issues.length * HELPERS_CONSTANTS.SCORING.ACCESSIBILITY_SCORE_PENALTY\n      ),\n    };\n  } // Enhanced Browser detection with privacy and feature support\n  /**\n   * Comprehensive browser information with privacy considerations\n   * @param {Object} options - Detection options\n   * @returns {Object} Browser information\n   */\n  static getBrowserInfo(options = {}) {\n    const {\n      includeVersion = false,\n      includeFeatureSupport = false,\n      respectPrivacy = true,\n    } = options;\n\n    const ua = navigator.userAgent;\n    const info = {\n      name: 'unknown',\n      version: 'unknown',\n      engine: 'unknown',\n      mobile: /Mobile|Android|iPhone|iPad/.test(ua),\n      touch: 'ontouchstart' in window,\n    };\n\n    // Browser detection with version extraction\n    const browsers = [\n      { name: 'Chrome', pattern: /Chrome\\/(\\d+)/, engine: 'Blink' },\n      { name: 'Firefox', pattern: /Firefox\\/(\\d+)/, engine: 'Gecko' },\n      { name: 'Safari', pattern: /Safari\\/(\\d+)/, engine: 'WebKit' },\n      { name: 'Edge', pattern: /Edg\\/(\\d+)/, engine: 'Blink' },\n      { name: 'Opera', pattern: /OPR\\/(\\d+)/, engine: 'Blink' },\n      {\n        name: 'IE',\n        pattern: /MSIE (\\d+)|Trident.*rv:(\\d+)/,\n        engine: 'Trident',\n      },\n    ];\n\n    for (const browser of browsers) {\n      const match = ua.match(browser.pattern);\n      if (match) {\n        info.name = browser.name;\n        info.engine = browser.engine;\n        if (includeVersion && match[1]) {\n          info.version = match[1];\n        }\n        break;\n      }\n    }\n\n    // Feature support detection\n    if (includeFeatureSupport) {\n      info.features = {\n        webgl: this.supportsWebGL(),\n        webgl2: this.supportsWebGL2(),\n        localStorage: this.supportsLocalStorage(),\n        sessionStorage: this.supportsSessionStorage(),\n        indexedDB: this.supportsIndexedDB(),\n        webWorkers: typeof Worker !== 'undefined',\n        serviceWorkers: 'serviceWorker' in navigator,\n        webAssembly: typeof WebAssembly !== 'undefined',\n        es6Modules: this.supportsES6Modules(),\n        css3: this.supportsCSS3(),\n        mediaQueries: this.supportsMediaQueries(),\n        geolocation: 'geolocation' in navigator,\n        notifications: 'Notification' in window,\n        fullscreen: this.supportsFullscreen(),\n        webRTC: this.supportsWebRTC(),\n        speechRecognition: this.supportsSpeechRecognition(),\n        intersectionObserver: 'IntersectionObserver' in window,\n        resizeObserver: 'ResizeObserver' in window,\n      };\n    }\n\n    // Privacy-conscious reporting\n    if (respectPrivacy) {\n      // Avoid fingerprinting by limiting detailed version info\n      if (info.version && info.version.length > 2) {\n        info.version = `${info.version.substring(0, 2)}x`;\n      }\n    }\n\n    return info;\n  }\n\n  /**\n   * Enhanced WebGL support detection\n   * @param {number} version - WebGL version to check (1 or 2)\n   * @returns {boolean} WebGL support status\n   */\n  static supportsWebGL(version = 1) {\n    try {\n      const canvas = document.createElement('canvas');\n      const context =\n        version === 2\n          ? canvas.getContext('webgl2')\n          : canvas.getContext('webgl') ||\n            canvas.getContext('experimental-webgl');\n      return !!context;\n    } catch {\n      return false;\n    }\n  }\n\n  static supportsWebGL2() {\n    return this.supportsWebGL(2);\n  }\n\n  /**\n   * Enhanced storage support detection\n   * @param {string} type - Storage type ('local', 'session', 'indexed')\n   * @returns {boolean} Storage support status\n   */\n  static supportsLocalStorage() {\n    try {\n      const test = '__localStorage_test__';\n      localStorage.setItem(test, test);\n      localStorage.removeItem(test);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  static supportsSessionStorage() {\n    try {\n      const test = '__sessionStorage_test__';\n      sessionStorage.setItem(test, test);\n      sessionStorage.removeItem(test);\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  static supportsIndexedDB() {\n    return 'indexedDB' in window;\n  }\n\n  /**\n   * Check for ES6 modules support\n   * @returns {boolean} ES6 modules support\n   */\n  static supportsES6Modules() {\n    try {\n      new Function('import(\"\")');\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Check for CSS3 support\n   * @returns {boolean} CSS3 support\n   */\n  static supportsCSS3() {\n    const testElement = document.createElement('div');\n    const cssProperties = [\n      'transform',\n      'transition',\n      'animation',\n      'borderRadius',\n    ];\n    return cssProperties.some(prop => prop in testElement.style);\n  }\n\n  /**\n   * Check for media queries support\n   * @returns {boolean} Media queries support\n   */\n  static supportsMediaQueries() {\n    return typeof window.matchMedia !== 'undefined';\n  }\n\n  /**\n   * Check for fullscreen API support\n   * @returns {boolean} Fullscreen support\n   */\n  static supportsFullscreen() {\n    const element = document.documentElement;\n    return !!(\n      element.requestFullscreen ||\n      element.webkitRequestFullscreen ||\n      element.mozRequestFullScreen ||\n      element.msRequestFullscreen\n    );\n  }\n\n  /**\n   * Check for WebRTC support\n   * @returns {boolean} WebRTC support\n   */\n  static supportsWebRTC() {\n    return !!(\n      window.RTCPeerConnection ||\n      window.webkitRTCPeerConnection ||\n      window.mozRTCPeerConnection\n    );\n  }\n\n  /**\n   * Check for speech recognition support\n   * @returns {boolean} Speech recognition support\n   */\n  static supportsSpeechRecognition() {\n    return !!(window.SpeechRecognition || window.webkitSpeechRecognition);\n  }\n\n  /**\n   * Responsive device type detection with accessibility considerations\n   * @param {Object} options - Detection options\n   * @returns {Object} Device information\n   */\n  static getDeviceInfo(options = {}) {\n    const {\n      includeOrientation = false,\n      includePixelRatio = false,\n      includeTouchPoints = false,\n    } = options;\n\n    const width = window.innerWidth;\n    const height = window.innerHeight;\n\n    let deviceType = 'desktop';\n    let breakpoint = 'xl';\n\n    if (width < HELPERS_CONSTANTS.DEVICE.MOBILE_BREAKPOINT) {\n      deviceType = 'mobile';\n      breakpoint = 'xs';\n    } else if (width < HELPERS_CONSTANTS.DEVICE.TABLET_BREAKPOINT) {\n      deviceType = 'mobile';\n      breakpoint = 'sm';\n    } else if (width < HELPERS_CONSTANTS.DEVICE.DESKTOP_BREAKPOINT) {\n      deviceType = 'tablet';\n      breakpoint = 'md';\n    } else if (width < HELPERS_CONSTANTS.DEVICE.LARGE_DESKTOP_BREAKPOINT) {\n      deviceType = 'desktop';\n      breakpoint = 'lg';\n    }\n\n    const deviceInfo = {\n      type: deviceType,\n      breakpoint,\n      width,\n      height,\n      mobile: deviceType === 'mobile',\n      tablet: deviceType === 'tablet',\n      desktop: deviceType === 'desktop',\n    };\n\n    if (includeOrientation) {\n      deviceInfo.orientation = width > height ? 'landscape' : 'portrait';\n    }\n\n    if (includePixelRatio) {\n      deviceInfo.pixelRatio = window.devicePixelRatio || 1;\n      deviceInfo.highDPI =\n        deviceInfo.pixelRatio > HELPERS_CONSTANTS.DEVICE.HIGH_DPI_THRESHOLD;\n    }\n\n    if (includeTouchPoints && 'maxTouchPoints' in navigator) {\n      deviceInfo.maxTouchPoints = navigator.maxTouchPoints;\n      deviceInfo.multiTouch = navigator.maxTouchPoints > 1;\n    }\n\n    return deviceInfo;\n  }\n\n  /**\n   * Legacy compatibility method\n   */\n  static getDeviceType() {\n    return this.getDeviceInfo().type;\n  }\n\n  /**\n   * Check for accessibility preferences\n   * @returns {Object} Accessibility preferences\n   */\n  static getAccessibilityPreferences() {\n    const preferences = {\n      reduceMotion: false,\n      highContrast: false,\n      largeText: false,\n      reducedTransparency: false,\n    };\n\n    // Check for prefers-reduced-motion\n    if (window.matchMedia) {\n      preferences.reduceMotion = window.matchMedia(\n        '(prefers-reduced-motion: reduce)'\n      ).matches;\n      preferences.highContrast = window.matchMedia(\n        '(prefers-contrast: high)'\n      ).matches;\n\n      // Check for other accessibility preferences if supported\n      try {\n        preferences.reducedTransparency = window.matchMedia(\n          '(prefers-reduced-transparency: reduce)'\n        ).matches;\n      } catch (e) {\n        // Not all browsers support this yet\n      }\n    }\n\n    return preferences;\n  }\n\n  /**\n   * Performance testing with accessibility considerations\n   * @param {Object} options - Performance test options\n   * @returns {Object} Performance metrics\n   */\n  static getPerformanceMetrics(options = {}) {\n    const {\n      includeMemory = false,\n      includeConnection = false,\n      respectBattery = true,\n    } = options;\n\n    const metrics = {\n      timestamp: Date.now(),\n      userAgent: navigator.userAgent,\n      language: navigator.language,\n      platform: navigator.platform,\n      cookieEnabled: navigator.cookieEnabled,\n      onLine: navigator.onLine,\n    };\n\n    // Performance timing\n    if (performance && performance.timing) {\n      const { timing } = performance;\n      metrics.pageLoadTime = timing.loadEventEnd - timing.navigationStart;\n      metrics.domContentLoaded =\n        timing.domContentLoadedEventEnd - timing.navigationStart;\n      metrics.domInteractive = timing.domInteractive - timing.navigationStart;\n    }\n\n    // Memory information (if available and permission granted)\n    if (includeMemory && 'memory' in performance) {\n      metrics.memory = {\n        usedJSHeapSize: performance.memory.usedJSHeapSize,\n        totalJSHeapSize: performance.memory.totalJSHeapSize,\n        jsHeapSizeLimit: performance.memory.jsHeapSizeLimit,\n      };\n    }\n\n    // Connection information (if available)\n    if (includeConnection && 'connection' in navigator) {\n      const { connection } = navigator;\n      metrics.connection = {\n        effectiveType: connection.effectiveType,\n        downlink: connection.downlink,\n        rtt: connection.rtt,\n      };\n    }\n\n    // Battery consideration\n    if (respectBattery && 'getBattery' in navigator) {\n      navigator\n        .getBattery()\n        .then(battery => {\n          if (battery.level < HELPERS_CONSTANTS.DEVICE.LOW_BATTERY_THRESHOLD) {\n            metrics.lowBattery = true;\n          }\n        })\n        .catch(() => {\n          // Battery API not available\n        });\n    }\n\n    return metrics;\n  } // Enhanced Ethics-specific utilities with accessibility and privacy\n  /**\n   * Advanced ethics score calculation with weighting and normalization\n   * @param {Map|Object} metrics - Ethics metrics\n   * @param {Object} options - Calculation options\n   * @returns {number} Normalized ethics score (0-100)\n   */\n  static calculateEthicsScore(metrics, options = {}) {\n    const {\n      normalizationMethod = 'weighted',\n      minScore = 0,\n      maxScore = 100,\n      defaultWeight = 1,\n      penalizeIncomplete = true,\n    } = options;\n\n    if (\n      !metrics ||\n      (typeof metrics.size === 'number'\n        ? metrics.size === 0\n        : Object.keys(metrics).length === 0)\n    ) {\n      return penalizeIncomplete ? 0 : HELPERS_CONSTANTS.SCORING.NEUTRAL_SCORE; // Neutral score for incomplete data\n    }\n\n    let totalScore = 0;\n    let totalWeight = 0;\n    let validMetrics = 0;\n\n    const processMetric = (metric, _key) => {\n      if (typeof metric === 'object' && metric !== null) {\n        const value = typeof metric.value === 'number' ? metric.value : 0;\n        const weight =\n          typeof metric.weight === 'number' ? metric.weight : defaultWeight;\n        const importance =\n          typeof metric.importance === 'number' ? metric.importance : 1;\n\n        if (value >= 0 && value <= 100) {\n          totalScore += value * weight * importance;\n          totalWeight += weight * importance;\n          validMetrics++;\n        }\n      } else if (typeof metric === 'number' && metric >= 0 && metric <= 100) {\n        totalScore += metric * defaultWeight;\n        totalWeight += defaultWeight;\n        validMetrics++;\n      }\n    };\n\n    if (metrics instanceof Map) {\n      metrics.forEach(processMetric);\n    } else {\n      Object.entries(metrics).forEach(([key, metric]) =>\n        processMetric(metric, key)\n      );\n    }\n\n    if (validMetrics === 0) {\n      return penalizeIncomplete ? 0 : HELPERS_CONSTANTS.SCORING.NEUTRAL_SCORE;\n    }\n\n    let finalScore;\n\n    switch (normalizationMethod) {\n      case 'weighted':\n        finalScore = totalWeight > 0 ? totalScore / totalWeight : 0;\n        break;\n      case 'average':\n        finalScore = totalScore / validMetrics;\n        break;\n      case 'harmonic': {\n        // Harmonic mean - more sensitive to low scores\n        const harmonicSum = Array.from(\n          metrics instanceof Map ? metrics.values() : Object.values(metrics)\n        )\n          .filter(\n            m =>\n              typeof m === 'number' ||\n              (typeof m === 'object' && typeof m.value === 'number')\n          )\n          .reduce((sum, m) => {\n            const value = typeof m === 'number' ? m : m.value;\n            return sum + (value > 0 ? 1 / value : 0);\n          }, 0);\n        finalScore = harmonicSum > 0 ? validMetrics / harmonicSum : 0;\n        break;\n      }\n      default:\n        finalScore = totalWeight > 0 ? totalScore / totalWeight : 0;\n    }\n\n    return this.clamp(Math.round(finalScore), minScore, maxScore);\n  }\n\n  /**\n   * Enhanced ethics grading with detailed feedback\n   * @param {number} score - Ethics score (0-100)\n   * @param {Object} options - Grading options\n   * @returns {Object} Detailed grade information\n   */\n  static getEthicsGrade(score, options = {}) {\n    const { includeAdvice = true, includeAccessibility = true } = options;\n\n    if (typeof score !== 'number' || score < 0 || score > 100) {\n      return {\n        grade: 'Invalid',\n        description: 'Invalid score provided',\n        level: 'error',\n        color: '#ff0000',\n        score: 0,\n      };\n    }\n\n    let grade,\n      description,\n      level,\n      color,\n      advice = [];\n\n    if (score >= HELPERS_CONSTANTS.SCORING.EXCELLENT_THRESHOLD) {\n      grade = 'A+';\n      description = 'Excellent';\n      level = 'excellent';\n      color = '#00aa00';\n      if (includeAdvice) {\n        advice = [\n          'Outstanding ethical decision-making',\n          'Continue to maintain these high standards',\n          'Consider mentoring others in ethical practices',\n        ];\n      }\n    } else if (score >= HELPERS_CONSTANTS.SCORING.GOOD_THRESHOLD) {\n      grade = 'A';\n      description = 'Very Good';\n      level = 'very-good';\n      color = '#44aa00';\n      if (includeAdvice) {\n        advice = [\n          'Strong ethical performance',\n          'Look for opportunities to reach excellence',\n          'Review any areas that scored below 90',\n        ];\n      }\n    } else if (score >= HELPERS_CONSTANTS.SCORING.SATISFACTORY_THRESHOLD) {\n      grade = 'B';\n      description = 'Good';\n      level = 'good';\n      color = '#88aa00';\n      if (includeAdvice) {\n        advice = [\n          'Good ethical foundation',\n          'Focus on improving consistency',\n          'Consider additional ethical training',\n        ];\n      }\n    } else if (score >= HELPERS_CONSTANTS.SCORING.NEEDS_IMPROVEMENT_THRESHOLD) {\n      grade = 'C';\n      description = 'Fair';\n      level = 'fair';\n      color = '#aaaa00';\n      if (includeAdvice) {\n        advice = [\n          'Meets basic ethical standards',\n          'Significant room for improvement',\n          'Review ethical guidelines and principles',\n        ];\n      }\n    } else if (score >= HELPERS_CONSTANTS.SCORING.POOR_THRESHOLD) {\n      grade = 'D';\n      description = 'Needs Improvement';\n      level = 'needs-improvement';\n      color = '#aa6600';\n      if (includeAdvice) {\n        advice = [\n          'Below acceptable ethical standards',\n          'Immediate attention required',\n          'Seek guidance from ethical advisors',\n        ];\n      }\n    } else {\n      grade = 'F';\n      description = 'Poor';\n      level = 'poor';\n      color = '#aa0000';\n      if (includeAdvice) {\n        advice = [\n          'Serious ethical concerns identified',\n          'Comprehensive ethical review needed',\n          'Consider professional ethical training',\n        ];\n      }\n    }\n\n    const result = {\n      score,\n      grade,\n      description,\n      level,\n      color,\n      percentile: Math.round(score),\n      passed: score >= HELPERS_CONSTANTS.SCORING.PASSING_THRESHOLD,\n    };\n\n    if (includeAdvice) {\n      result.advice = advice;\n    }\n\n    // Accessibility features\n    if (includeAccessibility) {\n      result.accessibility = {\n        ariaLabel: `Ethics score: ${score} out of 100, Grade ${grade}, ${description}`,\n        colorBlindSafeColor: this.getEthicsColor(score, {\n          colorBlindSafe: true,\n        }),\n        highContrastColor: this.getEthicsColor(score, { highContrast: true }),\n        screenReaderText: this.formatForScreenReader(\n          `Your ethics score is ${score} points out of 100, earning a grade of ${grade}, which is considered ${description.toLowerCase()}.`\n        ),\n      };\n    }\n\n    return result;\n  }\n\n  /**\n   * Generate contextual ethics insights\n   * @param {number} oldValue - Previous score\n   * @param {number} newValue - Current score\n   * @param {string} category - Category name\n   * @param {Object} options - Insight options\n   * @returns {Object} Insight information\n   */\n  static generateEthicsInsight(oldValue, newValue, category, options = {}) {\n    const {\n      includePercentage = true,\n      includeRecommendations = true,\n      includeAccessibility = true,\n    } = options;\n\n    const change = newValue - oldValue;\n    const absChange = Math.abs(change);\n    const percentageChange = oldValue > 0 ? (change / oldValue) * 100 : 0;\n\n    let intensity = 'slightly';\n    let significance = 'minor';\n\n    if (absChange > HELPERS_CONSTANTS.SCORING.SIGNIFICANT_CHANGE_THRESHOLD) {\n      intensity = 'significantly';\n      significance = 'major';\n    } else if (absChange > 10) {\n      intensity = 'moderately';\n      significance = 'moderate';\n    }\n\n    const direction = change > 0 ? 'improved' : 'declined';\n    const directionColor = change > 0 ? '#00aa00' : '#aa0000';\n\n    let message = `${category} has ${intensity} ${direction} by ${absChange} points`;\n    if (includePercentage && oldValue > 0) {\n      message += ` (${Math.abs(percentageChange).toFixed(1)}%)`;\n    }\n\n    const insight = {\n      category,\n      oldValue,\n      newValue,\n      change,\n      absChange,\n      percentageChange,\n      direction,\n      intensity,\n      significance,\n      message,\n      color: directionColor,\n      trend: change > 0 ? 'positive' : change < 0 ? 'negative' : 'stable',\n    };\n\n    if (includeRecommendations) {\n      insight.recommendations = this.generateEthicsRecommendations(\n        newValue,\n        category,\n        change\n      );\n    }\n\n    if (includeAccessibility) {\n      insight.accessibility = {\n        ariaLabel: `${category}: ${direction} from ${oldValue} to ${newValue} points`,\n        screenReaderText: this.formatForScreenReader(message),\n        announcement: `${category} score has ${direction} ${intensity}. New score: ${newValue} points.`,\n      };\n    }\n\n    return insight;\n  }\n\n  /**\n   * Generate contextual recommendations based on ethics performance\n   * @param {number} score - Current score\n   * @param {string} category - Category name\n   * @param {number} change - Score change\n   * @returns {Array} Array of recommendations\n   */\n  static generateEthicsRecommendations(score, category, change = 0) {\n    const recommendations = [];\n\n    // Score-based recommendations\n    if (score < HELPERS_CONSTANTS.SCORING.POOR_PERFORMANCE_THRESHOLD) {\n      recommendations.push(\n        `Critical: ${category} requires immediate attention and improvement`\n      );\n      recommendations.push('Consider consulting with ethics experts');\n      recommendations.push('Review fundamental ethical principles');\n    } else if (\n      score < HELPERS_CONSTANTS.SCORING.AVERAGE_PERFORMANCE_THRESHOLD\n    ) {\n      recommendations.push(`${category} needs improvement to meet standards`);\n      recommendations.push('Implement additional training or guidelines');\n    } else if (\n      score < HELPERS_CONSTANTS.SCORING.EXCELLENT_PERFORMANCE_THRESHOLD\n    ) {\n      recommendations.push(\n        `${category} is performing well but has room for excellence`\n      );\n      recommendations.push('Fine-tune processes for optimal performance');\n    } else {\n      recommendations.push(\n        `Excellent ${category} performance - maintain current standards`\n      );\n    }\n\n    // Change-based recommendations\n    if (change < HELPERS_CONSTANTS.SCORING.DECLINING_TREND_THRESHOLD) {\n      recommendations.push('Investigate causes of recent decline');\n      recommendations.push('Implement corrective measures immediately');\n    } else if (change > 10) {\n      recommendations.push('Identify successful practices to replicate');\n      recommendations.push('Document improvements for future reference');\n    }\n\n    // Category-specific recommendations\n    const categorySpecific = {\n      privacy: [\n        'Review data collection practices',\n        'Ensure transparent privacy policies',\n        'Implement data minimization principles',\n      ],\n      fairness: [\n        'Audit for algorithmic bias',\n        'Ensure equal treatment across demographics',\n        'Implement fairness metrics and monitoring',\n      ],\n      transparency: [\n        'Improve explainability of decisions',\n        'Provide clear documentation',\n        'Enable user understanding of processes',\n      ],\n      accountability: [\n        'Establish clear responsibility chains',\n        'Implement audit trails',\n        'Create feedback mechanisms',\n      ],\n    };\n\n    const categoryKey = category.toLowerCase();\n    if (categorySpecific[categoryKey]) {\n      recommendations.push(...categorySpecific[categoryKey].slice(0, 2));\n    }\n\n    return recommendations.slice(\n      0,\n      HELPERS_CONSTANTS.SCORING.MAX_RECOMMENDATIONS\n    ); // Limit to 5 recommendations\n  } // Enhanced Simulation utilities with accessibility and performance\n  /**\n   * Generate unique scenario identifier with metadata\n   * @param {Object} options - Generation options\n   * @returns {string} Unique scenario ID\n   */\n  static generateScenarioId(options = {}) {\n    const {\n      prefix = 'scenario',\n      includeTimestamp = true,\n      includeRandom = true,\n      includeVersion = false,\n      version = '1.0',\n    } = options;\n\n    const parts = [prefix];\n\n    if (includeTimestamp) {\n      parts.push(Date.now().toString());\n    }\n\n    if (includeRandom) {\n      parts.push(\n        Math.random()\n          .toString(HELPERS_CONSTANTS.GENERATION.ID_RADIX)\n          .substring(\n            HELPERS_CONSTANTS.GENERATION.ID_START_INDEX,\n            HELPERS_CONSTANTS.GENERATION.ID_END_INDEX\n          )\n      );\n    }\n\n    if (includeVersion) {\n      parts.push(`v${version}`);\n    }\n\n    return parts.join('_');\n  }\n\n  /**\n   * Enhanced progress bar with accessibility features\n   * @param {number} current - Current progress value\n   * @param {number} total - Total value\n   * @param {Object} options - Progress bar options\n   * @returns {Object} Progress bar data\n   */\n  static createProgressBar(current, total, options = {}) {\n    const {\n      width = 200,\n      includePercentage = true,\n      includeEstimate = false,\n      startTime = null,\n      precision = 1,\n      accessibleText = true,\n    } = options;\n\n    const safeTotal = Math.max(total, 1);\n    const safeCurrent = Math.max(0, Math.min(current, safeTotal));\n    const percentage = (safeCurrent / safeTotal) * 100;\n    const progressWidth = (percentage / 100) * width;\n\n    const progress = {\n      current: safeCurrent,\n      total: safeTotal,\n      percentage: this.roundTo(percentage, precision),\n      width: this.roundTo(progressWidth, precision),\n      completed: safeCurrent >= safeTotal,\n      remaining: safeTotal - safeCurrent,\n    };\n\n    // Text representations\n    progress.text = `${safeCurrent}/${safeTotal}`;\n    if (includePercentage) {\n      progress.percentageText = `${progress.percentage}%`;\n    }\n\n    // Time estimation\n    if (includeEstimate && startTime && safeCurrent > 0) {\n      const elapsed = Date.now() - startTime;\n      const rate = safeCurrent / elapsed;\n      const estimatedTotal = safeTotal / rate;\n      const remaining = estimatedTotal - elapsed;\n\n      progress.timeEstimate = {\n        elapsed: this.formatDuration(elapsed),\n        remaining: this.formatDuration(Math.max(0, remaining)),\n        total: this.formatDuration(estimatedTotal),\n      };\n    }\n\n    // Accessibility features\n    if (accessibleText) {\n      progress.accessibility = {\n        ariaValueNow: safeCurrent,\n        ariaValueMin: 0,\n        ariaValueMax: safeTotal,\n        ariaLabel: `Progress: ${safeCurrent} of ${safeTotal} completed`,\n        ariaValueText: `${progress.percentage}% complete`,\n        screenReaderText: this.formatForScreenReader(\n          `Progress is ${progress.percentage} percent complete. ${progress.remaining} items remaining.`\n        ),\n      };\n    }\n\n    return progress;\n  }\n\n  /**\n   * Generate comprehensive simulation report with accessibility\n   * @param {Object} simulation - Simulation data\n   * @param {Object} options - Report options\n   * @returns {Object} Detailed simulation report\n   */\n  static generateSimulationReport(simulation, options = {}) {\n    const {\n      includeMetrics = true,\n      includeInsights = true,\n      includeRecommendations = true,\n      includeAccessibility = true,\n    } = options;\n\n    if (!simulation || typeof simulation !== 'object') {\n      throw new Error('Invalid simulation data provided');\n    }\n\n    const ethicsScore = this.calculateEthicsScore(\n      simulation.ethicsMetrics || new Map()\n    );\n    const grade = this.getEthicsGrade(ethicsScore, {\n      includeAdvice: true,\n      includeAccessibility,\n    });\n\n    const report = {\n      metadata: {\n        simulationId: simulation.id || this.generateScenarioId(),\n        title: simulation.title || 'Untitled Simulation',\n        completedAt: new Date().toISOString(),\n        duration: simulation.state?.timeElapsed || 0,\n        version: simulation.version || '1.0',\n        reportGenerated: Date.now(),\n      },\n      performance: {\n        score: ethicsScore,\n        grade: grade.grade,\n        gradeDescription: grade.description,\n        level: grade.level,\n        passed: grade.passed,\n      },\n      statistics: {\n        decisions: simulation.state?.decisions?.length || 0,\n        scenarios: simulation.scenarios?.length || 0,\n        completionRate: this.calculateCompletionRate(simulation),\n        averageDecisionTime: this.calculateAverageDecisionTime(simulation),\n      },\n    };\n\n    // Include detailed metrics\n    if (includeMetrics && simulation.ethicsMetrics) {\n      report.ethicsMetrics = this.processEthicsMetrics(\n        simulation.ethicsMetrics\n      );\n    }\n\n    // Generate insights\n    if (includeInsights) {\n      report.insights = this.generateSimulationInsights(simulation);\n    }\n\n    // Generate recommendations\n    if (includeRecommendations) {\n      report.recommendations =\n        this.generateSimulationRecommendations(simulation);\n    }\n\n    // Accessibility features\n    if (includeAccessibility) {\n      report.accessibility = {\n        summary: this.formatForScreenReader(\n          `Simulation ${report.metadata.title} completed with a score of ${ethicsScore} points, earning grade ${grade.grade}.`\n        ),\n        ariaLabel: `Simulation report for ${report.metadata.title}`,\n        keyFindings: this.generateAccessibleSummary(report),\n        navigation: this.generateReportNavigation(report),\n      };\n    }\n\n    return report;\n  }\n\n  /**\n   * Calculate simulation completion rate\n   * @param {Object} simulation - Simulation data\n   * @returns {number} Completion rate (0-100)\n   */\n  static calculateCompletionRate(simulation) {\n    if (!simulation.scenarios || simulation.scenarios.length === 0) return 0;\n\n    const completedScenarios = simulation.scenarios.filter(\n      scenario => scenario.completed || scenario.status === 'completed'\n    ).length;\n\n    return this.roundTo(\n      (completedScenarios / simulation.scenarios.length) * 100,\n      1\n    );\n  }\n\n  /**\n   * Calculate average decision time\n   * @param {Object} simulation - Simulation data\n   * @returns {number} Average decision time in milliseconds\n   */\n  static calculateAverageDecisionTime(simulation) {\n    const decisions = simulation.state?.decisions || [];\n    if (decisions.length === 0) return 0;\n\n    const totalTime = decisions.reduce((sum, decision) => {\n      return sum + (decision.timeSpent || decision.duration || 0);\n    }, 0);\n\n    return Math.round(totalTime / decisions.length);\n  }\n\n  /**\n   * Process ethics metrics for reporting\n   * @param {Map|Object} metrics - Raw metrics data\n   * @returns {Object} Processed metrics\n   */\n  static processEthicsMetrics(metrics) {\n    const processed = {};\n\n    const processMetric = (metric, key) => {\n      if (typeof metric === 'object' && metric !== null) {\n        processed[key] = {\n          value: metric.value || 0,\n          weight: metric.weight || 1,\n          label: metric.label || key,\n          description: metric.description || '',\n          category: metric.category || 'general',\n        };\n      } else if (typeof metric === 'number') {\n        processed[key] = {\n          value: metric,\n          weight: 1,\n          label: key,\n          description: '',\n          category: 'general',\n        };\n      }\n    };\n\n    if (metrics instanceof Map) {\n      metrics.forEach(processMetric);\n    } else if (typeof metrics === 'object') {\n      Object.entries(metrics).forEach(([key, metric]) =>\n        processMetric(metric, key)\n      );\n    }\n\n    return processed;\n  }\n\n  /**\n   * Generate insights from simulation data\n   * @param {Object} simulation - Simulation data\n   * @returns {Array} Array of insights\n   */\n  static generateSimulationInsights(simulation) {\n    const insights = [];\n    const decisions = simulation.state?.decisions || [];\n    const metrics = simulation.ethicsMetrics || new Map();\n\n    // Time-based insights\n    if (decisions.length > 0) {\n      const avgDecisionTime = this.calculateAverageDecisionTime(simulation);\n      insights.push({\n        type: 'performance',\n        category: 'time',\n        message: `Average decision time: ${this.formatDuration(avgDecisionTime)}`,\n        value: avgDecisionTime,\n        benchmark: 30000, // 30 seconds\n        status:\n          avgDecisionTime <= HELPERS_CONSTANTS.TIME.GOOD_DECISION_TIME\n            ? 'good'\n            : 'attention',\n      });\n\n      // Decision pattern analysis\n      const quickDecisions = decisions.filter(\n        d => (d.timeSpent || 0) < HELPERS_CONSTANTS.TIME.QUICK_DECISION_TIME\n      ).length;\n      const slowDecisions = decisions.filter(\n        d => (d.timeSpent || 0) > HELPERS_CONSTANTS.TIME.SLOW_DECISION_TIME\n      ).length;\n\n      if (\n        quickDecisions >\n        decisions.length * HELPERS_CONSTANTS.TIME.QUICK_DECISION_RATIO\n      ) {\n        insights.push({\n          type: 'behavior',\n          category: 'decision-speed',\n          message:\n            'Tendency to make quick decisions - consider taking more time for complex scenarios',\n          value: quickDecisions,\n          status: 'caution',\n        });\n      }\n\n      if (\n        slowDecisions >\n        decisions.length * HELPERS_CONSTANTS.ANALYSIS.SLOW_DECISION_RATIO\n      ) {\n        insights.push({\n          type: 'behavior',\n          category: 'decision-speed',\n          message:\n            'Some decisions took longer than usual - this suggests careful consideration',\n          value: slowDecisions,\n          status: 'positive',\n        });\n      }\n    }\n\n    // Ethics performance insights\n    const processMetricInsight = (metric, name) => {\n      const value = typeof metric === 'object' ? metric.value : metric;\n      const label = typeof metric === 'object' ? metric.label : name;\n\n      if (typeof value === 'number') {\n        if (value >= HELPERS_CONSTANTS.ANALYSIS.HIGH_PERFORMANCE_THRESHOLD) {\n          insights.push({\n            type: 'ethics',\n            category: name,\n            message: `Strong performance in ${label}`,\n            value,\n            status: 'excellent',\n          });\n        } else if (\n          value <= HELPERS_CONSTANTS.ANALYSIS.LOW_PERFORMANCE_THRESHOLD\n        ) {\n          insights.push({\n            type: 'ethics',\n            category: name,\n            message: `Opportunity to improve ${label}`,\n            value,\n            status: 'needs-improvement',\n          });\n        }\n      }\n    };\n\n    if (metrics instanceof Map) {\n      metrics.forEach(processMetricInsight);\n    } else if (typeof metrics === 'object') {\n      Object.entries(metrics).forEach(([name, metric]) =>\n        processMetricInsight(metric, name)\n      );\n    }\n\n    return insights.slice(0, 10); // Limit to 10 insights\n  }\n\n  /**\n   * Generate recommendations from simulation data\n   * @param {Object} simulation - Simulation data\n   * @returns {Array} Array of recommendations\n   */\n  static generateSimulationRecommendations(simulation) {\n    const recommendations = [];\n    const ethicsScore = this.calculateEthicsScore(\n      simulation.ethicsMetrics || new Map()\n    );\n    const completionRate = this.calculateCompletionRate(simulation);\n\n    // Score-based recommendations\n    if (ethicsScore < HELPERS_CONSTANTS.ANALYSIS.ETHICS_WARNING_THRESHOLD) {\n      recommendations.push({\n        priority: 'high',\n        category: 'ethics',\n        title: 'Review Ethical Principles',\n        description:\n          'Consider reviewing the ethical principles before retrying',\n        action: 'study',\n        resources: ['Ethics Guidelines', 'Decision Framework'],\n      });\n\n      recommendations.push({\n        priority: 'high',\n        category: 'process',\n        title: 'Take More Time',\n        description:\n          'Take more time to consider the consequences of each decision',\n        action: 'reflect',\n        resources: ['Decision Checklist', 'Impact Assessment'],\n      });\n    }\n\n    // Completion-based recommendations\n    if (\n      completionRate < HELPERS_CONSTANTS.ANALYSIS.COMPLETION_WARNING_THRESHOLD\n    ) {\n      recommendations.push({\n        priority: 'medium',\n        category: 'completion',\n        title: 'Complete All Scenarios',\n        description:\n          'Try to complete all scenarios for a comprehensive evaluation',\n        action: 'continue',\n        resources: ['Scenario Guide', 'Progress Tracker'],\n      });\n    }\n\n    // Metric-specific recommendations\n    const processMetricRecommendation = (metric, name) => {\n      const value = typeof metric === 'object' ? metric.value : metric;\n      const label = typeof metric === 'object' ? metric.label : name;\n\n      if (\n        typeof value === 'number' &&\n        value < HELPERS_CONSTANTS.ANALYSIS.CRITICAL_VALUE_THRESHOLD\n      ) {\n        recommendations.push({\n          priority: 'medium',\n          category: 'improvement',\n          title: `Improve ${label}`,\n          description: `Focus on improving ${label} in future simulations`,\n          action: 'focus',\n          resources: [`${label} Guide`, 'Best Practices'],\n        });\n      }\n    };\n\n    const metrics = simulation.ethicsMetrics || new Map();\n    if (metrics instanceof Map) {\n      metrics.forEach(processMetricRecommendation);\n    } else if (typeof metrics === 'object') {\n      Object.entries(metrics).forEach(([name, metric]) =>\n        processMetricRecommendation(metric, name)\n      );\n    }\n\n    return recommendations.slice(\n      0,\n      HELPERS_CONSTANTS.ANALYSIS.EXTENDED_RECOMMENDATIONS\n    ); // Limit to 8 recommendations\n  }\n\n  /**\n   * Generate accessible summary for screen readers\n   * @param {Object} report - Report data\n   * @returns {string} Accessible summary\n   */\n  static generateAccessibleSummary(report) {\n    const parts = [\n      `Simulation ${report.metadata.title} has been completed.`,\n      `Final score: ${report.performance.score} out of 100 points.`,\n      `Grade: ${report.performance.grade}, ${report.performance.gradeDescription}.`,\n      `${report.statistics.decisions} decisions made across ${report.statistics.scenarios} scenarios.`,\n    ];\n\n    if (report.insights && report.insights.length > 0) {\n      parts.push(`${report.insights.length} key insights identified.`);\n    }\n\n    if (report.recommendations && report.recommendations.length > 0) {\n      parts.push(\n        `${report.recommendations.length} recommendations provided for improvement.`\n      );\n    }\n\n    return this.formatForScreenReader(parts.join(' '));\n  }\n\n  /**\n   * Generate navigation structure for report accessibility\n   * @param {Object} report - Report data\n   * @returns {Array} Navigation structure\n   */\n  static generateReportNavigation(report) {\n    return [\n      { section: 'metadata', label: 'Simulation Information', priority: 1 },\n      { section: 'performance', label: 'Performance Summary', priority: 1 },\n      { section: 'statistics', label: 'Statistics', priority: 2 },\n      ...(report.ethicsMetrics\n        ? [{ section: 'ethicsMetrics', label: 'Ethics Metrics', priority: 2 }]\n        : []),\n      ...(report.insights\n        ? [{ section: 'insights', label: 'Insights', priority: 3 }]\n        : []),\n      ...(report.recommendations\n        ? [\n            {\n              section: 'recommendations',\n              label: 'Recommendations',\n              priority: 3,\n            },\n          ]\n        : []),\n    ];\n  } // Enhanced File utilities with security and accessibility\n  /**\n   * Secure file download with validation and accessibility\n   * @param {string|Blob} content - File content\n   * @param {string} filename - File name\n   * @param {Object} options - Download options\n   */\n  static downloadFile(content, filename, options = {}) {\n    const {\n      mimeType = 'text/plain',\n      charset = 'utf-8',\n      validateFilename = true,\n      announceDownload = true,\n      maxSizeBytes = HELPERS_CONSTANTS.FILE_SIZE.DEFAULT_TEXT_LIMIT_MB *\n        HELPERS_CONSTANTS.FILE_SIZE.BYTES_PER_KB *\n        HELPERS_CONSTANTS.FILE_SIZE.KB_PER_MB, // 100MB default limit\n      allowedExtensions = null,\n    } = options;\n\n    // Validate filename for security\n    if (validateFilename) {\n      const validation = this.validateFilename(filename, { allowedExtensions });\n      if (!validation.valid) {\n        throw new Error(`Invalid filename: ${validation.error}`);\n      }\n      filename = validation.sanitized;\n    }\n\n    // Create blob with proper encoding\n    let blob;\n    if (content instanceof Blob) {\n      blob = content;\n    } else {\n      const fullMimeType = mimeType.includes('charset')\n        ? mimeType\n        : `${mimeType};charset=${charset}`;\n      blob = new Blob([content], { type: fullMimeType });\n    }\n\n    // Check file size\n    if (blob.size > maxSizeBytes) {\n      throw new Error(\n        `File size (${blob.size} bytes) exceeds maximum allowed size (${maxSizeBytes} bytes)`\n      );\n    }\n\n    // Create secure download\n    const url = URL.createObjectURL(blob);\n\n    try {\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = filename;\n      link.style.display = 'none';\n\n      // Accessibility attributes\n      link.setAttribute('aria-label', `Download ${filename}`);\n\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n\n      // Announce download to screen readers\n      if (announceDownload) {\n        this.announceToScreenReader(\n          `Download started for ${filename}`,\n          'polite'\n        );\n      }\n    } finally {\n      // Clean up object URL\n      setTimeout(\n        () => URL.revokeObjectURL(url),\n        HELPERS_CONSTANTS.TIME.URL_CLEANUP_DELAY\n      );\n    }\n  }\n\n  /**\n   * Validate filename for security and compatibility\n   * @param {string} filename - Filename to validate\n   * @param {Object} options - Validation options\n   * @returns {Object} Validation result\n   */\n  static validateFilename(filename, options = {}) {\n    const {\n      maxLength = 255,\n      allowedExtensions = null,\n      allowSpaces = true,\n      allowUnicode = true,\n    } = options;\n\n    if (typeof filename !== 'string') {\n      return { valid: false, error: 'Filename must be a string' };\n    }\n\n    if (filename.length === 0) {\n      return { valid: false, error: 'Filename cannot be empty' };\n    }\n\n    if (filename.length > maxLength) {\n      return {\n        valid: false,\n        error: `Filename too long (max ${maxLength} characters)`,\n      };\n    }\n\n    // Check for dangerous characters\n    const dangerousChars = /[<>:\"|?*\\\\/]/;\n    // Check for control characters (0-31)\n    const hasControlChars = filename\n      .split('')\n      .some(\n        char =>\n          char.charCodeAt(0) <\n          HELPERS_CONSTANTS.FILE_SIZE.CONTROL_CHAR_THRESHOLD\n      );\n    if (dangerousChars.test(filename) || hasControlChars) {\n      return { valid: false, error: 'Filename contains invalid characters' };\n    }\n\n    // Check for reserved names (Windows)\n    const reservedNames = /^(CON|PRN|AUX|NUL|COM[1-9]|LPT[1-9])(\\.|$)/i;\n    if (reservedNames.test(filename)) {\n      return { valid: false, error: 'Filename uses a reserved name' };\n    }\n\n    // Validate extension if specified\n    if (allowedExtensions) {\n      const extension = filename.split('.').pop()?.toLowerCase();\n      if (!extension || !allowedExtensions.includes(extension)) {\n        return {\n          valid: false,\n          error: `File extension not allowed. Allowed: ${allowedExtensions.join(', ')}`,\n        };\n      }\n    }\n\n    // Sanitize filename\n    let sanitized = filename;\n\n    if (!allowSpaces) {\n      sanitized = sanitized.replace(/\\s+/g, '_');\n    }\n\n    if (!allowUnicode) {\n      // Remove non-ASCII characters (keep only printable ASCII)\n      sanitized = sanitized.replace(/[^\\u0020-\\u007F]/g, '');\n    }\n\n    // Remove leading/trailing dots and spaces\n    sanitized = sanitized.trim().replace(/^\\.+|\\.+$/g, '');\n\n    return {\n      valid: true,\n      sanitized,\n      original: filename,\n    };\n  }\n\n  /**\n   * Enhanced file reading with progress and error handling\n   * @param {File} file - File to read\n   * @param {Object} options - Reading options\n   * @returns {Promise} File content promise\n   */\n  static readFileAsText(file, options = {}) {\n    const {\n      encoding = 'UTF-8',\n      maxSizeBytes = HELPERS_CONSTANTS.FILE_SIZE.DEFAULT_BINARY_LIMIT_MB *\n        HELPERS_CONSTANTS.FILE_SIZE.BYTES_PER_KB *\n        HELPERS_CONSTANTS.FILE_SIZE.KB_PER_MB, // 50MB default\n      onProgress = null,\n      validateType = true,\n      allowedTypes = ['text/plain', 'text/csv', 'application/json', 'text/xml'],\n    } = options;\n\n    return new Promise((resolve, reject) => {\n      if (!(file instanceof File)) {\n        reject(new Error('Invalid file object'));\n        return;\n      }\n\n      // Validate file size\n      if (file.size > maxSizeBytes) {\n        reject(\n          new Error(\n            `File size (${file.size} bytes) exceeds maximum (${maxSizeBytes} bytes)`\n          )\n        );\n        return;\n      }\n\n      // Validate file type\n      if (validateType && !allowedTypes.includes(file.type)) {\n        reject(\n          new Error(\n            `File type ${file.type} not allowed. Allowed: ${allowedTypes.join(', ')}`\n          )\n        );\n        return;\n      }\n\n      const reader = new FileReader();\n\n      reader.onload = e => {\n        try {\n          resolve(e.target.result);\n        } catch (error) {\n          reject(new Error(`Failed to read file: ${error.message}`));\n        }\n      };\n\n      reader.onerror = () => {\n        reject(new Error('File reading failed'));\n      };\n\n      reader.onabort = () => {\n        reject(new Error('File reading was aborted'));\n      };\n\n      // Progress tracking\n      if (onProgress && typeof onProgress === 'function') {\n        reader.onprogress = e => {\n          if (e.lengthComputable) {\n            const progress = (e.loaded / e.total) * 100;\n            onProgress(progress, e.loaded, e.total);\n          }\n        };\n      }\n\n      reader.readAsText(file, encoding);\n    });\n  }\n\n  /**\n   * Read file as data URL with validation\n   * @param {File} file - File to read\n   * @param {Object} options - Reading options\n   * @returns {Promise} Data URL promise\n   */\n  static readFileAsDataURL(file, options = {}) {\n    const {\n      maxSizeBytes = HELPERS_CONSTANTS.FILE_SIZE.SMALL_BINARY_LIMIT_MB *\n        HELPERS_CONSTANTS.FILE_SIZE.BYTES_PER_KB *\n        HELPERS_CONSTANTS.FILE_SIZE.KB_PER_MB, // 10MB for binary files\n      allowedTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp'],\n      onProgress = null,\n    } = options;\n\n    return new Promise((resolve, reject) => {\n      if (!(file instanceof File)) {\n        reject(new Error('Invalid file object'));\n        return;\n      }\n\n      if (file.size > maxSizeBytes) {\n        reject(new Error(`File size exceeds maximum allowed size`));\n        return;\n      }\n\n      if (!allowedTypes.includes(file.type)) {\n        reject(new Error(`File type not allowed`));\n        return;\n      }\n\n      const reader = new FileReader();\n\n      reader.onload = e => resolve(e.target.result);\n      reader.onerror = () => reject(new Error('File reading failed'));\n      reader.onabort = () => reject(new Error('File reading was aborted'));\n\n      if (onProgress && typeof onProgress === 'function') {\n        reader.onprogress = e => {\n          if (e.lengthComputable) {\n            onProgress((e.loaded / e.total) * 100);\n          }\n        };\n      }\n\n      reader.readAsDataURL(file);\n    });\n  }\n\n  /**\n   * Parse CSV file with accessibility features\n   * @param {string} csvText - CSV text content\n   * @param {Object} options - Parsing options\n   * @returns {Object} Parsed CSV data with metadata\n   */\n  static parseCSV(csvText, options = {}) {\n    const {\n      delimiter = ',',\n      hasHeader = true,\n      skipEmptyLines = true,\n      maxRows = 10000,\n      validateData = true,\n    } = options;\n\n    if (typeof csvText !== 'string') {\n      throw new Error('CSV content must be a string');\n    }\n\n    const lines = csvText.split('\\n');\n    const result = {\n      headers: [],\n      data: [],\n      metadata: {\n        totalRows: lines.length,\n        totalColumns: 0,\n        parsedRows: 0,\n        skippedRows: 0,\n        errors: [],\n      },\n    };\n\n    let currentRow = 0;\n\n    // Parse header if specified\n    if (hasHeader && lines.length > 0) {\n      result.headers = this.parseCSVLine(lines[0], delimiter);\n      result.metadata.totalColumns = result.headers.length;\n      currentRow = 1;\n    }\n\n    // Parse data rows\n    for (\n      let i = currentRow;\n      i < lines.length && result.data.length < maxRows;\n      i++\n    ) {\n      const line = lines[i].trim();\n\n      if (skipEmptyLines && line === '') {\n        result.metadata.skippedRows++;\n        continue;\n      }\n\n      try {\n        const row = this.parseCSVLine(line, delimiter);\n\n        if (validateData && hasHeader && row.length !== result.headers.length) {\n          result.metadata.errors.push(`Row ${i + 1}: Column count mismatch`);\n          continue;\n        }\n\n        result.data.push(\n          hasHeader\n            ? Object.fromEntries(\n                result.headers.map((header, idx) => [header, row[idx] || ''])\n              )\n            : row\n        );\n        result.metadata.parsedRows++;\n      } catch (error) {\n        result.metadata.errors.push(`Row ${i + 1}: ${error.message}`);\n      }\n    }\n\n    return result;\n  }\n\n  /**\n   * Parse single CSV line\n   * @param {string} line - CSV line\n   * @param {string} delimiter - Field delimiter\n   * @returns {Array} Parsed fields\n   */\n  static parseCSVLine(line, delimiter = ',') {\n    const fields = [];\n    let current = '';\n    let inQuotes = false;\n    let i = 0;\n\n    while (i < line.length) {\n      const char = line[i];\n\n      if (char === '\"') {\n        if (inQuotes && line[i + 1] === '\"') {\n          // Escaped quote\n          current += '\"';\n          i += 2;\n        } else {\n          // Toggle quote state\n          inQuotes = !inQuotes;\n          i++;\n        }\n      } else if (char === delimiter && !inQuotes) {\n        // Field separator\n        fields.push(current.trim());\n        current = '';\n        i++;\n      } else {\n        current += char;\n        i++;\n      }\n    }\n\n    // Add the last field\n    fields.push(current.trim());\n\n    return fields;\n  }\n\n  /**\n   * Export data as CSV with accessibility\n   * @param {Array} data - Data to export\n   * @param {Object} options - Export options\n   * @returns {string} CSV string\n   */\n  static exportToCSV(data, options = {}) {\n    const {\n      headers = null,\n      delimiter = ',',\n      includeHeaders = true,\n      quote = '\"',\n      lineBreak = '\\n',\n    } = options;\n\n    if (!Array.isArray(data) || data.length === 0) {\n      return '';\n    }\n\n    const csvLines = [];\n\n    // Determine headers\n    let csvHeaders = headers;\n    if (!csvHeaders && data.length > 0) {\n      if (typeof data[0] === 'object' && data[0] !== null) {\n        csvHeaders = Object.keys(data[0]);\n      }\n    }\n\n    // Add headers if requested\n    if (includeHeaders && csvHeaders) {\n      csvLines.push(\n        csvHeaders\n          .map(h => this.escapeCSVField(h, delimiter, quote))\n          .join(delimiter)\n      );\n    }\n\n    // Add data rows\n    data.forEach(row => {\n      let csvRow;\n      if (Array.isArray(row)) {\n        csvRow = row.map(field => this.escapeCSVField(field, delimiter, quote));\n      } else if (typeof row === 'object' && row !== null) {\n        csvRow = csvHeaders\n          ? csvHeaders.map(header =>\n              this.escapeCSVField(row[header], delimiter, quote)\n            )\n          : Object.values(row).map(field =>\n              this.escapeCSVField(field, delimiter, quote)\n            );\n      } else {\n        csvRow = [this.escapeCSVField(row, delimiter, quote)];\n      }\n      csvLines.push(csvRow.join(delimiter));\n    });\n\n    return csvLines.join(lineBreak);\n  }\n\n  /**\n   * Escape CSV field value\n   * @param {*} field - Field value\n   * @param {string} delimiter - Field delimiter\n   * @param {string} quote - Quote character\n   * @returns {string} Escaped field\n   */\n  static escapeCSVField(field, delimiter = ',', quote = '\"') {\n    if (field == null) return '';\n\n    const str = String(field);\n    const needsQuoting =\n      str.includes(delimiter) ||\n      str.includes(quote) ||\n      str.includes('\\n') ||\n      str.includes('\\r');\n\n    if (needsQuoting) {\n      return quote + str.replace(new RegExp(quote, 'g'), quote + quote) + quote;\n    }\n\n    return str;\n  } // Enhanced Animation utilities with accessibility and performance\n  /**\n   * Enhanced easing functions with accessibility considerations\n   */\n  static easeInOut(t, options = {}) {\n    const { respectReducedMotion = true, strength = 1 } = options;\n\n    if (\n      respectReducedMotion &&\n      window.matchMedia('(prefers-reduced-motion: reduce)').matches\n    ) {\n      return t; // Linear for reduced motion\n    }\n\n    const adjustedT = Math.pow(t, strength);\n    return adjustedT < HELPERS_CONSTANTS.ANIMATION.EASING_THRESHOLD\n      ? 2 * adjustedT * adjustedT\n      : -1 +\n          (HELPERS_CONSTANTS.ANIMATION.EASING_FACTOR_4 -\n            HELPERS_CONSTANTS.ANIMATION.EASING_FACTOR_2 * adjustedT) *\n            adjustedT;\n  }\n\n  static easeIn(t, options = {}) {\n    const { respectReducedMotion = true, strength = 2 } = options;\n\n    if (\n      respectReducedMotion &&\n      window.matchMedia('(prefers-reduced-motion: reduce)').matches\n    ) {\n      return t;\n    }\n\n    return Math.pow(t, strength);\n  }\n\n  static easeOut(t, options = {}) {\n    const { respectReducedMotion = true, strength = 2 } = options;\n\n    if (\n      respectReducedMotion &&\n      window.matchMedia('(prefers-reduced-motion: reduce)').matches\n    ) {\n      return t;\n    }\n\n    return 1 - Math.pow(1 - t, strength);\n  }\n\n  /**\n   * Bounce easing function\n   * @param {number} t - Time progress (0-1)\n   * @param {Object} options - Easing options\n   * @returns {number} Eased value\n   */\n  static easeBounce(t, options = {}) {\n    const { respectReducedMotion = true } = options;\n\n    if (\n      respectReducedMotion &&\n      window.matchMedia('(prefers-reduced-motion: reduce)').matches\n    ) {\n      return t;\n    }\n\n    if (t < 1 / HELPERS_CONSTANTS.ANIMATION.BOUNCE_DIVISOR) {\n      return HELPERS_CONSTANTS.ANIMATION.BOUNCE_MULTIPLIER * t * t;\n    } else if (\n      t <\n      HELPERS_CONSTANTS.ANIMATION.BOUNCE_OFFSET_2 /\n        HELPERS_CONSTANTS.ANIMATION.BOUNCE_DIVISOR\n    ) {\n      return (\n        HELPERS_CONSTANTS.ANIMATION.BOUNCE_MULTIPLIER *\n          (t -=\n            HELPERS_CONSTANTS.ANIMATION.BOUNCE_OFFSET_1_5 /\n            HELPERS_CONSTANTS.ANIMATION.BOUNCE_DIVISOR) *\n          t +\n        HELPERS_CONSTANTS.ANIMATION.BOUNCE_RETURN_0_75\n      );\n    } else if (\n      t <\n      HELPERS_CONSTANTS.ANIMATION.BOUNCE_OFFSET_2_5 /\n        HELPERS_CONSTANTS.ANIMATION.BOUNCE_DIVISOR\n    ) {\n      return (\n        HELPERS_CONSTANTS.ANIMATION.BOUNCE_MULTIPLIER *\n          (t -=\n            HELPERS_CONSTANTS.ANIMATION.BOUNCE_OFFSET_2_25 /\n            HELPERS_CONSTANTS.ANIMATION.BOUNCE_DIVISOR) *\n          t +\n        HELPERS_CONSTANTS.ANIMATION.BOUNCE_RETURN_0_9375\n      );\n    } else {\n      return (\n        HELPERS_CONSTANTS.ANIMATION.BOUNCE_MULTIPLIER *\n          (t -=\n            HELPERS_CONSTANTS.ANIMATION.BOUNCE_OFFSET_2_625 /\n            HELPERS_CONSTANTS.ANIMATION.BOUNCE_DIVISOR) *\n          t +\n        HELPERS_CONSTANTS.ANIMATION.BOUNCE_RETURN_0_984375\n      );\n    }\n  }\n\n  /**\n   * Elastic easing function\n   * @param {number} t - Time progress (0-1)\n   * @param {Object} options - Easing options\n   * @returns {number} Eased value\n   */\n  static easeElastic(t, options = {}) {\n    const {\n      respectReducedMotion = true,\n      amplitude = 1,\n      period = 0.3,\n    } = options;\n\n    if (\n      respectReducedMotion &&\n      window.matchMedia('(prefers-reduced-motion: reduce)').matches\n    ) {\n      return t;\n    }\n\n    if (t === 0 || t === 1) return t;\n\n    const s = period / HELPERS_CONSTANTS.ANIMATION.ELASTIC_PERIOD_DIVISOR;\n    return -(\n      amplitude *\n      Math.pow(2, 10 * (t -= 1)) *\n      Math.sin(((t - s) * (2 * Math.PI)) / period)\n    );\n  }\n\n  /**\n   * Advanced animation with accessibility and performance features\n   * @param {Object} options - Animation options\n   * @returns {Object} Animation controller\n   */\n  static animate(options = {}) {\n    const {\n      duration = 300,\n      easing = this.easeInOut,\n      updateCallback = null,\n      completeCallback = null,\n      respectReducedMotion = true,\n      fps = null,\n      pauseOnVisibilityChange = true,\n      trackPerformance = false,\n    } = options;\n\n    if (typeof updateCallback !== 'function') {\n      throw new Error('updateCallback is required');\n    }\n\n    // Respect user's motion preferences\n    const prefersReducedMotion =\n      respectReducedMotion &&\n      window.matchMedia('(prefers-reduced-motion: reduce)').matches;\n\n    const actualDuration = prefersReducedMotion\n      ? Math.min(duration, 100)\n      : duration;\n    const frameInterval = fps ? 1000 / fps : null;\n\n    let startTime = null;\n    let animationId = null;\n    let paused = false;\n    let pausedAt = 0;\n    let totalPausedTime = 0;\n    let lastFrameTime = 0;\n    let frameCount = 0;\n    let cancelled = false;\n\n    const performance = trackPerformance\n      ? {\n          startTime: 0,\n          frameCount: 0,\n          droppedFrames: 0,\n          averageFrameTime: 0,\n          totalFrameTime: 0,\n        }\n      : null;\n\n    const tick = currentTime => {\n      if (cancelled) return;\n\n      if (!startTime) {\n        startTime = currentTime;\n        if (performance) performance.startTime = currentTime;\n      }\n\n      const elapsed = currentTime - startTime - totalPausedTime;\n      const progress = Math.min(elapsed / actualDuration, 1);\n\n      // Frame rate limiting\n      if (frameInterval && currentTime - lastFrameTime < frameInterval) {\n        animationId = requestAnimationFrame(tick);\n        return;\n      }\n\n      // Performance tracking\n      if (performance && frameCount > 0) {\n        const frameDuration = currentTime - lastFrameTime;\n        performance.totalFrameTime += frameDuration;\n        performance.frameCount++;\n\n        if (frameDuration > HELPERS_CONSTANTS.TIME.FRAME_RATE_TARGET) {\n          // > 60fps threshold\n          performance.droppedFrames++;\n        }\n\n        performance.averageFrameTime =\n          performance.totalFrameTime / performance.frameCount;\n      }\n\n      lastFrameTime = currentTime;\n      frameCount++;\n\n      if (!paused) {\n        const easedProgress =\n          typeof easing === 'function'\n            ? easing(progress, { respectReducedMotion })\n            : progress;\n\n        try {\n          updateCallback(easedProgress, progress, elapsed);\n        } catch (error) {\n          logger.error('Animation update callback error:', error);\n          controller.cancel();\n          return;\n        }\n      }\n\n      if (progress < 1) {\n        animationId = requestAnimationFrame(tick);\n      } else {\n        if (completeCallback && typeof completeCallback === 'function') {\n          try {\n            completeCallback(performance);\n          } catch (error) {\n            logger.error('Animation complete callback error:', error);\n          }\n        }\n      }\n    };\n\n    // Visibility change handling\n    const handleVisibilityChange = () => {\n      if (pauseOnVisibilityChange) {\n        if (document.hidden && !paused) {\n          controller.pause();\n        } else if (!document.hidden && paused) {\n          controller.resume();\n        }\n      }\n    };\n\n    if (pauseOnVisibilityChange) {\n      document.addEventListener('visibilitychange', handleVisibilityChange);\n    }\n\n    const controller = {\n      start() {\n        if (!cancelled && !animationId) {\n          animationId = requestAnimationFrame(tick);\n        }\n        return this;\n      },\n\n      pause() {\n        if (!paused && animationId) {\n          paused = true;\n          pausedAt = performance.now();\n          cancelAnimationFrame(animationId);\n          animationId = null;\n        }\n        return this;\n      },\n\n      resume() {\n        if (paused) {\n          paused = false;\n          totalPausedTime += performance.now() - pausedAt;\n          animationId = requestAnimationFrame(tick);\n        }\n        return this;\n      },\n\n      cancel() {\n        cancelled = true;\n        if (animationId) {\n          cancelAnimationFrame(animationId);\n          animationId = null;\n        }\n        if (pauseOnVisibilityChange) {\n          document.removeEventListener(\n            'visibilitychange',\n            handleVisibilityChange\n          );\n        }\n        return this;\n      },\n\n      getProgress() {\n        if (!startTime) return 0;\n        const elapsed = performance.now() - startTime - totalPausedTime;\n        return Math.min(elapsed / actualDuration, 1);\n      },\n\n      isPaused() {\n        return paused;\n      },\n\n      isCancelled() {\n        return cancelled;\n      },\n\n      getPerformance() {\n        return performance ? { ...performance } : null;\n      },\n    };\n\n    return controller;\n  }\n\n  /**\n   * Create a spring animation with physics\n   * @param {Object} options - Spring options\n   * @returns {Object} Spring animation controller\n   */\n  static createSpringAnimation(options = {}) {\n    const {\n      from = 0,\n      to = 1,\n      stiffness = 100,\n      damping = 10,\n      mass = 1,\n      precision = 0.01,\n      updateCallback = null,\n      completeCallback = null,\n      respectReducedMotion = true,\n    } = options;\n\n    if (\n      respectReducedMotion &&\n      window.matchMedia('(prefers-reduced-motion: reduce)').matches\n    ) {\n      // For reduced motion, use simple linear interpolation\n      return this.animate({\n        duration: 200,\n        easing: t => t,\n        updateCallback: progress => {\n          const value = from + (to - from) * progress;\n          if (updateCallback) updateCallback(value, progress);\n        },\n        completeCallback,\n        respectReducedMotion: false,\n      });\n    }\n\n    let currentValue = from;\n    let velocity = 0;\n    let startTime = null;\n    let animationId = null;\n    let cancelled = false;\n\n    const tick = currentTime => {\n      if (cancelled) return;\n\n      if (!startTime) startTime = currentTime;\n\n      const deltaTime = Math.min(\n        (currentTime - (startTime || currentTime)) / 1000,\n        HELPERS_CONSTANTS.ANIMATION.FRAME_DELTA_TARGET\n      );\n      startTime = currentTime;\n\n      // Spring physics calculations\n      const springForce = -stiffness * (currentValue - to);\n      const dampingForce = -damping * velocity;\n      const acceleration = (springForce + dampingForce) / mass;\n\n      velocity += acceleration * deltaTime;\n      currentValue += velocity * deltaTime;\n\n      if (updateCallback) {\n        updateCallback(\n          currentValue,\n          Math.abs(to - currentValue) / Math.abs(to - from)\n        );\n      }\n\n      // Check if spring has settled\n      const isSettled =\n        Math.abs(to - currentValue) < precision &&\n        Math.abs(velocity) < precision;\n\n      if (!isSettled) {\n        animationId = requestAnimationFrame(tick);\n      } else {\n        currentValue = to; // Snap to final value\n        if (updateCallback) updateCallback(currentValue, 1);\n        if (completeCallback) completeCallback();\n      }\n    };\n\n    return {\n      start() {\n        if (!cancelled && !animationId) {\n          animationId = requestAnimationFrame(tick);\n        }\n        return this;\n      },\n\n      cancel() {\n        cancelled = true;\n        if (animationId) {\n          cancelAnimationFrame(animationId);\n          animationId = null;\n        }\n        return this;\n      },\n\n      getCurrentValue() {\n        return currentValue;\n      },\n\n      getVelocity() {\n        return velocity;\n      },\n\n      isCancelled() {\n        return cancelled;\n      },\n    };\n  }\n\n  /**\n   * Batch multiple animations with coordination\n   * @param {Array} animations - Array of animation configurations\n   * @param {Object} options - Batch options\n   * @returns {Object} Batch controller\n   */\n  static createAnimationBatch(animations, options = {}) {\n    const {\n      sequential = false,\n      delay = 0,\n      onProgress = null,\n      onComplete = null,\n    } = options;\n\n    const controllers = [];\n    let completedCount = 0;\n    let started = false;\n\n    const handleAnimationComplete = () => {\n      completedCount++;\n      const progress = completedCount / animations.length;\n\n      if (onProgress) onProgress(progress);\n\n      if (completedCount === animations.length && onComplete) {\n        onComplete();\n      }\n    };\n\n    const createAnimation = (config, _index) => {\n      const animationConfig = {\n        ...config,\n        completeCallback: () => {\n          if (config.completeCallback) config.completeCallback();\n          handleAnimationComplete();\n        },\n      };\n\n      return this.animate(animationConfig);\n    };\n\n    // Create all animation controllers\n    animations.forEach((config, index) => {\n      controllers.push(createAnimation(config, index));\n    });\n\n    return {\n      start() {\n        if (started) return this;\n        started = true;\n\n        if (sequential) {\n          // Start animations one after another\n          const startNext = index => {\n            if (index < controllers.length) {\n              setTimeout(\n                () => {\n                  controllers[index].start();\n                  startNext(index + 1);\n                },\n                index === 0 ? delay : 0\n              );\n            }\n          };\n          startNext(0);\n        } else {\n          // Start all animations simultaneously\n          setTimeout(() => {\n            controllers.forEach(controller => controller.start());\n          }, delay);\n        }\n\n        return this;\n      },\n\n      pause() {\n        controllers.forEach(controller => controller.pause());\n        return this;\n      },\n\n      resume() {\n        controllers.forEach(controller => controller.resume());\n        return this;\n      },\n\n      cancel() {\n        controllers.forEach(controller => controller.cancel());\n        return this;\n      },\n\n      getProgress() {\n        return completedCount / animations.length;\n      },\n\n      getControllers() {\n        return [...controllers];\n      },\n    };\n  }\n}\n\n// Global cleanup function for better memory management\nwindow.addEventListener('beforeunload', () => {\n  HelperCache.clear();\n});\n\n// Initialize theme monitoring\nif (typeof window !== 'undefined') {\n  ThemeHelpers.createThemeObserver((property, value) => {\n    // Emit custom event for theme changes\n    window.dispatchEvent(\n      new CustomEvent('themeChange', {\n        detail: { property, value },\n      })\n    );\n  });\n}\n\n// Export for ES6 modules\nexport default Helpers;\n"],"names":["HELPERS_CONSTANTS","HelperCache","key","value","ttl","expiry","entry","a","b","__publicField","ThemeHelpers","prefersHighContrast","prefersReducedMotion","theme","element","colors","currentTheme","callback","observers","contrastQuery","contrastHandler","e","motionQuery","motionHandler","cleanup","Helpers","min","max","start","end","factor","inputMin","inputMax","outputMin","outputMax","number","decimals","values","validValues","v","mid","average","squaredDiffs","x","y","meanX","meanY","numerator","sumSqX","sumSqY","i","deltaX","deltaY","denominator","array","shuffled","j","count","keyFn","groups","item","seen","size","chunks","depth","acc","val","arrays","result","criteria","criterion","direction","aVal","bVal","str","g","text","maxLength","suffix","html","div","length","charset","charsetLength","randomValues","options","expandAbbreviations","addPunctuation","slowDown","formatted","abbr","full","regex","issues","score","sentences","words","w","avgWordsPerSentence","milliseconds","includeMilliseconds","verbose","screenReader","seconds","minutes","COMMON","hours","days","parts","timestamp","format","date","dateOptions","precise","shortForm","diff","units","unit","unitName","plural","nextUnit","remainder","nextUnitName","nextPlural","input","commonFormats","startDate","endDate","excludedDays","current","hex","char","r","color1","color2","rgb1","rgb2","highContrast","colorBlindSafe","luminance1","luminance2","lighter","darker","rgb","rs","gs","bs","c","foreground","background","level","ratio","requirements","req","baseColor","steps","lightBackground","palette","lightVariation","lightContrast","color","outputFormat","hsl","rgbMatch","namedColor","h","l","d","tag","className","attributes","dataKey","dataValue","event","handler","child","includeMargin","includePadding","relativeTo","rect","styles","position","margin","padding","relativeRect","threshold","partial","checkOpacity","checkDisplay","returnDetails","viewport","visibility","intersectionWidth","intersectionHeight","intersectionArea","elementArea","behavior","block","inline","offset","respectReducedMotion","focus","announceToScreenReader","actualBehavior","targetY","announcement","message","priority","announcer","trigger","content","delay","hideDelay","id","tooltip","showTimeout","hideTimeout","showTooltip","triggerRect","tooltipRect","top","left","hideTooltip","func","wait","immediate","maxWait","trackPerformance","context","timeout","maxTimeout","lastCallTime","debounced","args","currentTime","ctx","later","duration","logger","callNow","limit","leading","trailing","lastFunc","lastRan","now","resetAfter","trackCalls","called","callCount","onceFunction","once","passive","capture","debounceTime","throttleTime","preventDefault","stopPropagation","processedHandler","originalHandler","eventOptions","container","selector","circular","skipHidden","announceNavigation","currentIndex","elements","updateElements","el","navigate","oldIndex","targetElement","keydownHandler","email","allowInternational","blockedDomains","requireTld","domain","securityIssues","url","allowedProtocols","allowLocalhost","allowPrivateIps","urlObj","ip","range","password","minLength","requireUppercase","requireLowercase","requireNumbers","requireSymbols","blockedPatterns","provideFeedback","feedback","errors","hasUppercase","hasLowercase","hasNumbers","hasSymbols","pattern","commonPatterns","strength","allowHtml","allowUrls","trimWhitespace","removeInvisibleChars","normalizeUnicode","sanitized","recommendations","hasLabel","hasAriaLabel","hasAriaLabelledBy","hasAriaInvalid","bgColor","textColor","contrastInfo","includeVersion","includeFeatureSupport","respectPrivacy","ua","info","browsers","browser","match","version","canvas","test","testElement","prop","includeOrientation","includePixelRatio","includeTouchPoints","width","height","deviceType","breakpoint","deviceInfo","preferences","includeMemory","includeConnection","respectBattery","metrics","timing","connection","battery","normalizationMethod","minScore","maxScore","defaultWeight","penalizeIncomplete","totalScore","totalWeight","validMetrics","processMetric","metric","_key","weight","importance","finalScore","harmonicSum","sum","m","includeAdvice","includeAccessibility","grade","description","advice","oldValue","newValue","category","includePercentage","includeRecommendations","change","absChange","percentageChange","intensity","significance","directionColor","insight","categorySpecific","categoryKey","prefix","includeTimestamp","includeRandom","total","includeEstimate","startTime","precision","accessibleText","safeTotal","safeCurrent","percentage","progressWidth","progress","elapsed","rate","estimatedTotal","remaining","simulation","includeMetrics","includeInsights","ethicsScore","report","completedScenarios","scenario","decisions","totalTime","decision","processed","insights","avgDecisionTime","quickDecisions","slowDecisions","processMetricInsight","name","label","completionRate","processMetricRecommendation","filename","mimeType","validateFilename","announceDownload","maxSizeBytes","allowedExtensions","validation","blob","fullMimeType","link","allowSpaces","allowUnicode","dangerousChars","hasControlChars","extension","file","encoding","onProgress","validateType","allowedTypes","resolve","reject","reader","error","csvText","delimiter","hasHeader","skipEmptyLines","maxRows","validateData","lines","currentRow","line","row","header","idx","fields","inQuotes","data","headers","includeHeaders","quote","lineBreak","csvLines","csvHeaders","csvRow","field","t","adjustedT","amplitude","period","s","easing","updateCallback","completeCallback","fps","pauseOnVisibilityChange","actualDuration","frameInterval","animationId","paused","pausedAt","totalPausedTime","lastFrameTime","frameCount","cancelled","performance","tick","frameDuration","easedProgress","controller","handleVisibilityChange","from","to","stiffness","damping","mass","currentValue","velocity","deltaTime","springForce","dampingForce","acceleration","animations","sequential","onComplete","controllers","completedCount","started","handleAnimationComplete","createAnimation","config","_index","animationConfig","index","startNext","property"],"mappings":"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"}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tab Content & Modal Footer Test</title>
    <!-- Load all relevant CSS files in correct order -->
    <link rel="stylesheet" href="src/styles/main.css">
    <link rel="stylesheet" href="src/styles/advanced-ui-components.css">
    <link rel="stylesheet" href="src/styles/pre-launch-modal.css">
    <link rel="stylesheet" href="src/styles/bias-fairness.css">
    <link rel="stylesheet" href="src/styles/simulation-modal-consolidated.css">
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .test-title {
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #007cba;
        }
        .status {
            padding: 8px 12px;
            border-radius: 4px;
            font-weight: 600;
            margin-left: 10px;
        }
        .status.pass { background: #d4edda; color: #155724; }
        .status.fail { background: #f8d7da; color: #721c24; }
        .test-button {
            background: #007cba;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #0056a3;
        }
    </style>
</head>
<body>
    <h1>Tab Content & Modal Footer Visibility Test</h1>
    <p>Testing CSS conflicts and JavaScript tab management after fixes</p>

    <!-- Test Section 1: Pre-launch Modal Tab Content -->
    <div class="test-section">
        <h2 class="test-title">Pre-Launch Modal Tab Content Test <span id="tab-status" class="status fail">Testing...</span></h2>
        
        <div class="pre-launch-modal" style="position: relative; display: block; max-width: 600px;">
            <div class="modal-header">
                <h3 class="modal-title">Pre-Launch Modal Simulation</h3>
            </div>
            <div class="modal-body">
                <!-- Tab Navigation -->
                <nav class="pre-launch-tabs" role="tablist">
                    <button class="tab-button active" data-tab="overview" onclick="switchTab('overview')">
                        <span class="tab-icon">ðŸŽ¯</span> Overview
                    </button>
                    <button class="tab-button" data-tab="objectives" onclick="switchTab('objectives')">
                        <span class="tab-icon">ðŸ“š</span> Learning Goals
                    </button>
                    <button class="tab-button" data-tab="preparation" onclick="switchTab('preparation')">
                        <span class="tab-icon">ðŸš€</span> Get Ready
                    </button>
                </nav>
                
                <!-- Tab Content -->
                <div class="pre-launch-content">
                    <div class="tab-content active" id="tab-overview">
                        <div style="padding: 20px;">
                            <h4>Overview Tab Content</h4>
                            <p>This tab should be visible by default with the 'active' class.</p>
                            <p>CSS Rule: <code>.pre-launch-modal .tab-content.active { display: block !important; }</code></p>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="tab-objectives">
                        <div style="padding: 20px;">
                            <h4>Learning Goals Tab Content</h4>
                            <p>This tab should only be visible when clicked.</p>
                            <p>CSS Rule: <code>.pre-launch-modal .tab-content { display: none !important; }</code></p>
                        </div>
                    </div>
                    
                    <div class="tab-content" id="tab-preparation">
                        <div style="padding: 20px;">
                            <h4>Preparation Tab Content</h4>
                            <p>This tab should only be visible when clicked.</p>
                            <p>Scoped CSS prevents conflicts with bias-fairness.css rules.</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary">Maybe Later</button>
                <button class="btn btn-primary">Start Exploration</button>
            </div>
        </div>
    </div>

    <!-- Test Section 2: Bias Fairness Tab Content -->
    <div class="test-section">
        <h2 class="test-title">Bias Fairness Tab Content Test <span id="bias-tab-status" class="status fail">Testing...</span></h2>
        
        <div class="bias-simulation-container" style="max-width: 600px;">
            <div class="results-tabs">
                <button class="tab-button active" onclick="switchBiasTab('results')">Results</button>
                <button class="tab-button" onclick="switchBiasTab('analytics')">Analytics</button>
                <button class="tab-button" onclick="switchBiasTab('comparison')">Comparison</button>
            </div>
            
            <div class="tab-content active" id="bias-results">
                <div style="padding: 20px; background: #f8f9fa; border-radius: 6px;">
                    <h4>Bias Simulation Results</h4>
                    <p>This should be visible with scoped CSS rules.</p>
                    <p>Rule: <code>.bias-simulation-container .tab-content.active { display: block; }</code></p>
                </div>
            </div>
            
            <div class="tab-content" id="bias-analytics">
                <div style="padding: 20px; background: #f8f9fa; border-radius: 6px;">
                    <h4>Analytics Tab</h4>
                    <p>Should only show when clicked.</p>
                </div>
            </div>
            
            <div class="tab-content" id="bias-comparison">
                <div style="padding: 20px; background: #f8f9fa; border-radius: 6px;">
                    <h4>Comparison Tab</h4>
                    <p>Should only show when clicked.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Test Section 3: Modal Footer Test -->
    <div class="test-section">
        <h2 class="test-title">Modal Footer Test <span id="footer-status" class="status fail">Testing...</span></h2>
        
        <div class="modal-backdrop visible" style="position: relative; background: none;">
            <div class="modal-dialog" style="position: relative; transform: none; max-width: 500px;">
                <div class="modal-header">
                    <h3 class="modal-title">Modal Footer Visibility Test</h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <p>This modal tests whether the modal footer is visible and properly styled.</p>
                    <p>The footer should appear below with flex layout and proper spacing.</p>
                </div>
                <div class="modal-footer">
                    <button class="modal-button secondary">Cancel</button>
                    <button class="modal-button primary">Confirm</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Test Controls -->
    <div class="test-section">
        <h2 class="test-title">Test Controls</h2>
        <button class="test-button" onclick="runVisibilityTest()">Run Visibility Test</button>
        <button class="test-button" onclick="checkComputedStyles()">Check Computed Styles</button>
        <button class="test-button" onclick="toggleDevMode()">Toggle Dev Mode</button>
        
        <div id="test-results" style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 6px; display: none;">
            <h4>Test Results:</h4>
            <pre id="results-text"></pre>
        </div>
    </div>

    <script>
        // Tab switching for pre-launch modal
        function switchTab(tabId) {
            // Remove active from all tab buttons
            document.querySelectorAll('.pre-launch-tabs .tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Add active to clicked button
            document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');
            
            // Hide all tab content in pre-launch modal
            document.querySelectorAll('.pre-launch-modal .tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(`tab-${tabId}`).classList.add('active');
            
            console.log(`Switched to tab: ${tabId}`);
        }

        // Tab switching for bias fairness
        function switchBiasTab(tabId) {
            // Remove active from all bias tab buttons
            document.querySelectorAll('.results-tabs .tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Add active to clicked button
            event.target.classList.add('active');
            
            // Hide all bias tab content
            document.querySelectorAll('.bias-simulation-container .tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(`bias-${tabId}`).classList.add('active');
            
            console.log(`Switched to bias tab: ${tabId}`);
        }

        // Visibility test
        function runVisibilityTest() {
            const results = {
                prelaunchTabs: testPrelaunchTabs(),
                biasTabs: testBiasTabs(),
                modalFooter: testModalFooter()
            };
            
            updateTestStatus('tab-status', results.prelaunchTabs);
            updateTestStatus('bias-tab-status', results.biasTabs);
            updateTestStatus('footer-status', results.modalFooter);
            
            document.getElementById('test-results').style.display = 'block';
            document.getElementById('results-text').textContent = JSON.stringify(results, null, 2);
        }

                        function testPrelaunchTabs() {
            const activeTab = document.querySelector('.pre-launch-modal .tab-content.active');
            const hiddenTab = document.querySelector('.pre-launch-modal .tab-content:not(.active)');
            
            const activeVisible = window.getComputedStyle(activeTab).display === 'block';
            const hiddenInvisible = window.getComputedStyle(hiddenTab).display === 'none';
            
            return activeVisible && hiddenInvisible;
        }

        function testBiasTabs() {
            const activeTab = document.querySelector('.bias-simulation-container .tab-content.active');
            const hiddenTab = document.querySelector('.bias-simulation-container .tab-content:not(.active)');
            
            if (!activeTab || !hiddenTab) return false;
            
            const activeVisible = window.getComputedStyle(activeTab).display === 'block';
            const hiddenInvisible = window.getComputedStyle(hiddenTab).display === 'none';
            
            return activeVisible && hiddenInvisible;
        }

        function testModalFooter() {
            const footer = document.querySelector('.modal-footer');
            const display = window.getComputedStyle(footer).display;
            const visibility = window.getComputedStyle(footer).visibility;
            
            return display === 'flex' && visibility === 'visible';
        }

        function updateTestStatus(elementId, passed) {
            const element = document.getElementById(elementId);
            element.className = `status ${passed ? 'pass' : 'fail'}`;
            element.textContent = passed ? 'PASS' : 'FAIL';
        }

        function checkComputedStyles() {
            const elements = [
                { name: 'Pre-launch Active Tab', el: document.querySelector('.pre-launch-modal .tab-content.active') },
                { name: 'Pre-launch Hidden Tab', el: document.querySelector('.pre-launch-modal .tab-content:not(.active)') },
                { name: 'Bias Active Tab', el: document.querySelector('.bias-simulation-container .tab-content.active') },
                { name: 'Bias Hidden Tab', el: document.querySelector('.bias-simulation-container .tab-content:not(.active)') },
                { name: 'Modal Footer', el: document.querySelector('.modal-footer') }
            ];
            
            let output = 'COMPUTED STYLES ANALYSIS:\\n\\n';
            elements.forEach(({ name, el }) => {
                if (el) {
                    const styles = window.getComputedStyle(el);
                    output += `${name}:\\n`;
                    output += `  display: ${styles.display}\\n`;
                    output += `  visibility: ${styles.visibility}\\n`;
                    output += `  opacity: ${styles.opacity}\\n`;
                    output += `  z-index: ${styles.zIndex}\\n\\n`;
                }
            });
            
            document.getElementById('test-results').style.display = 'block';
            document.getElementById('results-text').textContent = output;
        }

        let devMode = false;
        function toggleDevMode() {
            devMode = !devMode;
            if (devMode) {
                document.body.style.position = 'relative';
                document.body.insertAdjacentHTML('beforeend', `
                    <div style="position: fixed; top: 10px; right: 10px; background: #000; color: #0f0; padding: 10px; font-family: monospace; font-size: 12px; z-index: 9999; border-radius: 4px;">
                        DEV MODE: Check console for real-time style changes
                    </div>
                `);
                
                // Monitor for changes
                const observer = new MutationObserver(() => {
                    console.log('DOM changed - re-running visibility test');
                    runVisibilityTest();
                });
                observer.observe(document.body, { childList: true, subtree: true, attributes: true });
            }
        }

        // Run initial test
        setTimeout(runVisibilityTest, 500);
    </script>
</body>
</html>

/*
 * CSS Layers Architecture Fix
 * Copyright 2025 Armando Sori - Licensed under Apache License, Version 2.0
 * 
 * Fixes styling issues caused by CSS layers migration
 * Load this file AFTER css-layers.css to apply fixes
 */

/* Ensure design tokens take precedence in the tokens layer */
@layer tokens {
  :root {
    /* Ensure design-tokens.css values are used consistently */
    --color-primary: #1a73e8 !important;
    --color-primary-dark: #1565c0 !important;
    --color-primary-light: #42a5f5 !important;
    --font-size-base: 1rem !important;
  }
}

/* Fix any base layer conflicts */
@layer base {
  /* Ensure body styles are applied correctly */
  body {
    font-family: var(
      --font-family-base,
      var(
        --font-family-primary,
        "Segoe UI",
        Tahoma,
        Geneva,
        Verdana,
        sans-serif
      )
    );
    font-size: var(--font-size-base, 1rem);
    line-height: var(--line-height-base, 1.6);
    color: var(--color-text, var(--color-text-primary, #1f2937));
    background-color: var(--color-background, #ffffff);
  }

  /* Fix heading styles */
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    color: var(--color-text, var(--color-text-primary, #1f2937));
    font-family: inherit;
  }
}

/* Fix component layer styles */
@layer components {
  /* Ensure navigation styles work correctly */
  .header,
  .navigation,
  .nav {
    background-color: var(--nav-bg-primary, rgba(255, 255, 255, 0.95));
  }

  /* Fix button styles */
  .btn,
  .button,
  button {
    font-family: inherit;
    font-size: var(--btn-font-size, var(--font-size-base, 1rem));
  }

  .btn-primary,
  .button-primary {
    background-color: var(--color-primary);
    border-color: var(--color-primary);
    color: var(--color-white, #ffffff);
  }

  .btn-primary:hover,
  .btn-primary:focus,
  .button-primary:hover,
  .button-primary:focus {
    background-color: var(--color-primary-dark);
    border-color: var(--color-primary-dark);
  }

  /* Fix hero section */
  .hero {
    background: linear-gradient(
      135deg,
      var(--color-primary) 0%,
      var(--color-primary-light) 100%
    );
    color: var(--color-white, #ffffff);
  }

  /* Fix category sections */
  .category-header,
  .categories-section {
    font-size: var(--font-size-base, 1rem);
  }
}

/* Fix utility layer */
@layer utilities {
  /* Ensure state management classes work */
  .state-loading {
    opacity: 0;
    transform: translateY(20px);
    pointer-events: none;
  }

  .state-loaded {
    opacity: 1;
    transform: translateY(0);
    pointer-events: auto;
  }

  /* Font scaling utilities */
  .font-size-small,
  .font-scale-small {
    font-size: calc(var(--font-size-base) * 0.875) !important;
  }

  .font-size-medium,
  .font-scale-medium {
    font-size: calc(var(--font-size-base) * 1) !important;
  }

  .font-size-large,
  .font-scale-large {
    font-size: calc(var(--font-size-base) * 1.125) !important;
  }

  .font-size-extra-large,
  .font-scale-extra-large {
    font-size: calc(var(--font-size-base) * 1.25) !important;
  }
}

/* Override layer for critical fixes */
@layer overrides {
  /* Force design system compliance */
  html {
    --color-primary: #1a73e8 !important;
    --color-primary-dark: #1565c0 !important;
    --color-primary-light: #42a5f5 !important;
    --font-size-base: 1rem !important;
  }

  /* Ensure loaded state works */
  html.loaded {
    scroll-behavior: smooth;
  }

  html.loaded .hero,
  html.loaded .hero-content,
  html.loaded .categories-section {
    opacity: 1;
    transform: translateY(0);
    transition:
      opacity 0.6s ease-out,
      transform 0.6s ease-out;
  }

  /* Fix focus styles */
  :focus-visible {
    outline: 2px solid var(--color-primary) !important;
    outline-offset: 2px !important;
  }

  /* Ensure accessibility is maintained */
  .sr-only {
    position: absolute !important;
    width: 1px !important;
    height: 1px !important;
    padding: 0 !important;
    margin: -1px !important;
    overflow: hidden !important;
    clip: rect(0, 0, 0, 0) !important;
    white-space: nowrap !important;
    border: 0 !important;
  }
}

/* Development debugging */
@media (max-width: 1) {
  /* This will never apply but helps with debugging */
  body::before {
    content: "CSS Layers Fix Applied";
    position: fixed;
    top: 0;
    left: 0;
    background: green;
    color: white;
    padding: 2px 5px;
    font-size: 10px;
    z-index: 10000;
    pointer-events: none;
  }
}

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GDPR Cookie Notice Demo - SimulateAI</title>

    <!-- CSS Layers Architecture -->
    <link rel="stylesheet" href="./src/styles/css-layers.css" />
    <link
      rel="stylesheet"
      href="./src/styles/components/gdpr-cookie-notice.css"
    />

    <style>
      body {
        padding: var(--spacing-6);
        max-width: 800px;
        margin: 0 auto;
        line-height: var(--line-height-relaxed);
      }

      .demo-section {
        margin-bottom: var(--spacing-8);
        padding: var(--spacing-6);
        border: 1px solid var(--color-border);
        border-radius: var(--border-radius-lg);
        background: var(--color-background-subtle);
      }

      .demo-buttons {
        display: flex;
        gap: var(--spacing-3);
        flex-wrap: wrap;
        margin-top: var(--spacing-4);
      }

      .demo-btn {
        padding: var(--spacing-3) var(--spacing-4);
        background: var(--color-primary);
        color: var(--color-primary-contrast);
        border: none;
        border-radius: var(--border-radius-md);
        cursor: pointer;
        font-weight: var(--font-weight-medium);
        transition: background-color 0.2s ease;
      }

      .demo-btn:hover {
        background: var(--color-primary-hover);
      }

      .demo-btn.secondary {
        background: var(--color-background);
        color: var(--color-text-primary);
        border: 1px solid var(--color-border);
      }

      .demo-btn.secondary:hover {
        background: var(--color-background-hover);
      }

      .consent-status {
        margin-top: var(--spacing-4);
        padding: var(--spacing-4);
        background: var(--color-background);
        border-radius: var(--border-radius-md);
        border: 1px solid var(--color-border);
      }

      .consent-status h4 {
        margin: 0 0 var(--spacing-2) 0;
        color: var(--color-text-primary);
      }

      .consent-status pre {
        margin: 0;
        color: var(--color-text-secondary);
        font-size: var(--font-size-sm);
        white-space: pre-wrap;
        word-break: break-word;
      }

      .theme-toggle {
        position: fixed;
        top: var(--spacing-4);
        right: var(--spacing-4);
        z-index: 1000;
      }
    </style>
  </head>
  <body>
    <button class="demo-btn theme-toggle" onclick="toggleTheme()">
      üåì Toggle Theme
    </button>

    <h1>GDPR Cookie Notice Demo</h1>
    <p>
      This demo shows the GDPR-compliant cookie notice for SimulateAI. The
      notice integrates with the existing DataHandler system and follows all
      established architectural patterns.
    </p>

    <div class="demo-section">
      <h2>üç™ Cookie Notice Controls</h2>
      <p>Use these controls to test the cookie notice functionality:</p>

      <div class="demo-buttons">
        <button class="demo-btn" onclick="showCookieNotice()">
          Show Cookie Notice
        </button>
        <button class="demo-btn secondary" onclick="clearConsent()">
          Clear Consent (Reset)
        </button>
        <button class="demo-btn secondary" onclick="checkConsentStatus()">
          Check Consent Status
        </button>
      </div>

      <div class="consent-status" id="consentStatus">
        <h4>Consent Status:</h4>
        <pre id="consentData">Loading...</pre>
      </div>
    </div>

    <div class="demo-section">
      <h2>üìã GDPR Compliance Features</h2>
      <ul>
        <li>
          <strong>Privacy by Design:</strong> Essential cookies only by default
        </li>
        <li>
          <strong>Granular Control:</strong> Users can choose specific cookie
          types
        </li>
        <li>
          <strong>Consent Expiry:</strong> Consent expires after 13 months (GDPR
          best practice)
        </li>
        <li>
          <strong>Easy Withdrawal:</strong> Users can change preferences anytime
        </li>
        <li>
          <strong>Data Integration:</strong> Seamlessly integrates with existing
          DataHandler
        </li>
        <li>
          <strong>Analytics Integration:</strong> Automatically updates Google
          Analytics consent
        </li>
      </ul>
    </div>

    <div class="demo-section">
      <h2>üõ†Ô∏è Implementation Details</h2>
      <p>The cookie notice follows SimulateAI's architectural standards:</p>
      <ul>
        <li>
          <strong>CSS Layers:</strong> Properly structured in components layer
          with dark mode overrides
        </li>
        <li>
          <strong>DataHandler Integration:</strong> Uses existing consent
          management system
        </li>
        <li>
          <strong>Event System:</strong> Integrates with GlobalEventManager for
          component communication
        </li>
        <li>
          <strong>Accessibility:</strong> Full keyboard navigation and screen
          reader support
        </li>
        <li><strong>Responsive:</strong> Works on all device sizes</li>
        <li>
          <strong>Performance:</strong> Lightweight with minimal impact on page
          load
        </li>
      </ul>
    </div>

    <div class="demo-section">
      <h2>üéØ Usage in Production</h2>
      <p>To add the cookie notice to any page, simply include:</p>
      <pre
        style="
          background: var(--color-background);
          padding: var(--spacing-3);
          border-radius: var(--border-radius-sm);
          margin-top: var(--spacing-3);
        "
      >
&lt;!-- Include CSS --&gt;
&lt;link rel="stylesheet" href="./src/styles/components/gdpr-cookie-notice.css"&gt;

&lt;!-- Include JavaScript --&gt;
&lt;script src="./src/js/components/gdpr-cookie-notice.js"&gt;&lt;/script&gt;
&lt;script src="./src/js/utils/gdpr-init.js"&gt;&lt;/script&gt;
        </pre
      >
      <p>
        The notice will automatically initialize when the page loads and
        DataHandler is available.
      </p>
    </div>

    <!-- Core Dependencies (Mocked for Demo) -->
    <script>
      // Mock DataHandler for demo purposes
      class MockDataHandler {
        constructor() {
          this.storage = new Map();
        }

        async getData(key) {
          const data = localStorage.getItem(`simulateai_${key}`);
          return data ? JSON.parse(data) : null;
        }

        async saveData(key, data) {
          localStorage.setItem(`simulateai_${key}`, JSON.stringify(data));
          return true;
        }

        async saveConsentData(data) {
          return this.saveData("legacy_consent", data);
        }

        async getConsentData() {
          return this.getData("legacy_consent");
        }
      }

      // Initialize mock DataHandler
      window.dataHandler = new MockDataHandler();
      window.DataHandler = MockDataHandler;

      // Mock GlobalEventManager
      window.globalEventManager = {
        handleEvent: (type, data) => {
          console.log("GlobalEventManager event:", type, data);
        },
      };

      // Mock Analytics
      window.simpleAnalytics = {
        enable: () => console.log("SimpleAnalytics enabled"),
        disable: () => console.log("SimpleAnalytics disabled"),
      };
    </script>

    <!-- GDPR Cookie Notice -->
    <script src="./src/js/components/gdpr-cookie-notice.js"></script>
    <script src="./src/js/utils/gdpr-init.js"></script>

    <!-- Demo Controls -->
    <script>
      function showCookieNotice() {
        if (window.gdprCookieNotice) {
          window.gdprCookieNotice.showPreferences();
        } else {
          alert(
            "Cookie notice not initialized yet. Please wait a moment and try again.",
          );
        }
      }

      async function clearConsent() {
        if (window.dataHandler) {
          await window.dataHandler.saveData("gdpr_cookie_consent", null);
          localStorage.removeItem("simulateai_gdpr_cookie_consent");
          alert(
            "Consent cleared! Refresh the page to see the cookie notice again.",
          );
        }
      }

      async function checkConsentStatus() {
        if (window.GDPRUtils) {
          const consent = await window.GDPRUtils.getConsentData();
          const statusElement = document.getElementById("consentData");

          if (consent) {
            statusElement.textContent = JSON.stringify(consent, null, 2);
          } else {
            statusElement.textContent =
              "No consent data found. Cookie notice should be visible.";
          }
        }
      }

      function toggleTheme() {
        document.body.classList.toggle("dark-mode");
      }

      // Auto-check consent status on load
      setTimeout(() => {
        checkConsentStatus();
      }, 1000);

      // Listen for consent changes
      window.addEventListener("gdprConsentChanged", (event) => {
        console.log("Demo: Consent changed", event.detail);
        setTimeout(checkConsentStatus, 500);
      });
    </script>
  </body>
</html>

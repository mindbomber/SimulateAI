<!--
Copyright 2025 Armando Sori

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<!doctype html>
<html lang="en">
  <head>
    <!-- Google Analytics is initialized via centralized service (no inline gtag to avoid double-init) -->

    <!-- Optional emergency Firebase fix: load only when explicitly enabled -->
    <script>
      (function () {
        try {
          var enabled =
            /[?&]emergencyFix=1\b/.test(location.search) ||
            (function () {
              try {
                return (
                  localStorage.getItem("emergency_firebase_fix") === "true"
                );
              } catch (_) {
                return false;
              }
            })();
          if (enabled) {
            var s = document.createElement("script");
            s.src = "./firebase-emergency-fix.js";
            s.async = true;
            document.head.appendChild(s);
          }
        } catch (_) {}
      })();
    </script>

    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />
    <meta name="theme-color" content="#1a73e8" />
    <meta name="color-scheme" content="light dark" />
    <meta name="page-id" content="home" />

    <!-- Early theme-preload shim: apply correct theme before CSS to prevent FOUC -->
    <style id="theme-preload-style">
      html.theme-preload,
      html.theme-preload * {
        transition: none !important;
        animation: none !important;
      }
    </style>
    <script>
      (function () {
        try {
          // Unified storage key with backward-compatible fallback
          var val = null;
          try {
            val = localStorage.getItem("simulateai_theme_preference");
          } catch (_) {}
          if (!val) {
            try {
              // legacy keys fallback
              val =
                localStorage.getItem("simulateai_theme") ||
                localStorage.getItem("theme");
            } catch (_) {}
          }
          var prefersDark = false;
          try {
            prefersDark =
              window.matchMedia &&
              window.matchMedia("(prefers-color-scheme: dark)").matches;
          } catch (_) {}
          var theme =
            val === "dark" || val === "light" || val === "system"
              ? val === "system"
                ? prefersDark
                  ? "dark"
                  : "light"
                : val
              : prefersDark
                ? "dark"
                : "light";

          // Disable transitions during first paint and align UA widgets
          var root = document.documentElement;
          root.classList.add("theme-preload");
          root.style.colorScheme = theme;

          // Apply theme classes to <html> immediately (body may not exist yet)
          root.classList.remove("theme-dark", "theme-light", "dark-mode");
          if (theme === "dark") {
            root.classList.add("theme-dark", "dark-mode");
            // Temporary dark background/text to avoid white flash before CSS loads
            root.style.backgroundColor = "#0d1117";
            root.style.color = "#f0f6fc";
          } else {
            root.classList.add("theme-light");
          }

          // When body becomes available, mirror classes onto it
          var syncBody = function () {
            var b = document.body;
            if (!b) return;
            b.classList.remove("theme-dark", "theme-light", "dark-mode");
            if (theme === "dark") {
              b.classList.add("theme-dark", "dark-mode");
            } else {
              b.classList.add("theme-light");
            }
          };

          if (document.body) {
            syncBody();
          } else {
            // Use a micro task to catch early body creation without waiting for full DOMContentLoaded
            var mo = new MutationObserver(function () {
              if (document.body) {
                try {
                  syncBody();
                } catch (_) {}
                try {
                  mo.disconnect();
                } catch (_) {}
              }
            });
            mo.observe(root, { childList: true, subtree: true });
            // Fallback to DOMContentLoaded if needed
            document.addEventListener("DOMContentLoaded", syncBody, {
              once: true,
            });
          }

          // Remove preload class and temporary inline styles after load to re-enable transitions
          window.addEventListener(
            "load",
            function () {
              root.classList.remove("theme-preload");
              // Clean up temporary inline styles set for dark preload
              root.style.removeProperty("background-color");
              root.style.removeProperty("color");
            },
            { once: true },
          );
        } catch (e) {
          /* no-op */
        }
      })();
    </script>

    <!-- Base URL for custom domain - will be removed for localhost -->
    <base href="/" id="custom-domain-base" />

    <!-- Firebase ESM import map removed; bundler/npm resolves Firebase modules -->

    <title>SimulateAI App - Interactive AI Ethics Simulations Platform</title>
    <meta
      name="description"
      content="Interactive AI ethics platform for researchers, enthusiasts, educators and learners. Explore AI safety, machine learning ethics, and artificial intelligence philosophy through open-ended, consequence-driven simulations that mirror real-world scenarios."
    />
    <meta
      name="keywords"
      content="AI ethics education, robotics ethics, AI researchers, AI enthusiasts, artificial intelligence philosophy, machine learning ethics, AI safety research, computational ethics, ISTE standards, interactive simulations, educator resources, PhET-inspired learning, consequence-driven education, open-ended exploration, moral philosophy"
    />
    <meta name="author" content="SimulateAI Educational Platform" />

    <!-- SEO Enhancement -->
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://simulateai.io/app.html" />

    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website" />
    <meta
      property="og:title"
      content="SimulateAI App - Interactive AI Ethics Simulations Platform"
    />
    <meta
      property="og:description"
      content="Experience hands-on AI ethics education through interactive simulations designed for educators and students"
    />
    <meta property="og:url" content="https://simulateai.io/app.html" />
    <meta
      property="og:image"
      content="https://simulateai.io/src/assets/images/app-preview.jpg"
    />
    <meta property="og:site_name" content="SimulateAI" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@SimulateAI" />
    <meta
      name="twitter:title"
      content="SimulateAI App - Interactive AI Ethics Platform"
    />
    <meta
      name="twitter:description"
      content="Hands-on AI ethics education through interactive simulations"
    />

    <!-- Accessibility -->
    <meta
      name="accessibility-features"
      content="keyboard-navigation,skip-links,high-contrast,large-text,screen-reader-support"
    />

    <!-- Structured Data for WebApplication -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "SimulateAI App",
        "description": "Interactive AI ethics education platform with simulation-based learning",
        "url": "https://simulateai.io/app.html",
        "applicationCategory": "EducationalApplication",
        "operatingSystem": "Web Browser",
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "USD"
        },
        "publisher": {
          "@type": "Organization",
          "name": "SimulateAI"
        }
      }
    </script>

    <!-- Critical CSS - Inline for FOUC prevention -->
    <style>
      :root {
        --primary: #1a73e8;
        --bg: #ffffff;
        --text: #333333;
        --font: "Inter", -apple-system, BlinkMacSystemFont, sans-serif;
        --header-h: 80px;
        --modal-z: 9999;
      }

      /* Animation for hero demo visual feedback */
      @keyframes fadeInOut {
        0% {
          opacity: 0;
          transform: translateX(-50%) translateY(-10px);
        }
        20% {
          opacity: 1;
          transform: translateX(-50%) translateY(0);
        }
        80% {
          opacity: 1;
          transform: translateX(-50%) translateY(0);
        }
        100% {
          opacity: 0;
          transform: translateX(-50%) translateY(-10px);
        }
      }

      /* Universal selector moved to main.css for complete reset */
      body {
        font-family: var(--font);
        /* Inherit theme colors from html to avoid white flash before CSS loads */
        color: inherit;
        background: transparent;
        margin: 0;
        line-height: 1.6;
        font-size: 16px;
      }
      .modal-backdrop {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: var(--modal-z);
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
        /* Use flexbox for centering */
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .modal-backdrop.visible {
        opacity: 1;
        pointer-events: auto;
      }
      .modal-dialog {
        /* Remove fixed positioning - let flexbox handle centering */
        position: relative;
        /* Remove explicit positioning that conflicts with flexbox */
        /* top: 50%; left: 50%; transform: translate(-50%, -50%); */
        background: var(--bg);
        border-radius: 8px;
        max-width: 90vw;
        max-height: 90vh;
        width: 600px;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
      }
      /* Header styles moved to shared-navigation.css for consolidation */
      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
      }
      .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 0.5rem 1rem;
        border: none;
        border-radius: 4px;
        background: var(--primary);
        color: white;
        text-decoration: none;
        cursor: pointer;
        transition: opacity 0.2s ease;
      }
      .btn:hover {
        opacity: 0.9;
      }
      input,
      select,
      textarea {
        font-family: inherit;
        font-size: inherit;
      }
      .sr-only {
        position: absolute !important;
        width: 1px !important;
        height: 1px !important;
        padding: 0 !important;
        margin: -1px !important;
        overflow: hidden !important;
        clip: rect(0, 0, 0, 0) !important;
        white-space: nowrap !important;
        border: 0 !important;
      }
      .loading {
        opacity: 0.7;
        pointer-events: none;
      }
      /* Dark mode variables are applied via @layer overrides in css-layers.css */
    </style>

    <!-- Styles - Optimized load order for CSS architecture -->
    <!-- 0. CSS Layers definition - MUST LOAD FIRST -->
    <link rel="preload" href="src/styles/css-layers.css" as="style" />
    <link rel="stylesheet" href="src/styles/css-layers.css" />

    <!-- 1. Design tokens foundation - MUST LOAD FIRST -->
    <link rel="preload" href="src/styles/design-tokens.css" as="style" />
    <link rel="stylesheet" href="src/styles/design-tokens.css" />

    <!-- 1.1. Early theme is handled by the inline theme-preload shim -->

    <!-- 2. Media queries foundation -->
    <link rel="stylesheet" href="src/styles/media.css" />

    <!-- 3. Base styles -->
    <link rel="stylesheet" href="src/styles/main.css" />
    <link rel="stylesheet" href="src/styles/accessibility.css" />
    <link rel="stylesheet" href="src/styles/navigation-highlight-fix.css" />

    <!-- 4. Base component styles -->
    <link rel="stylesheet" href="src/styles/simulations.css" />
    <link rel="stylesheet" href="src/styles/layout-components.css" />

    <!-- Shared Navigation Component (moved up for proper cascade) -->
    <link rel="stylesheet" href="src/styles/shared-navigation.css" />

    <!-- 5. Advanced component systems -->
    <link rel="stylesheet" href="src/styles/advanced-ui-components.css" />
    <link rel="stylesheet" href="src/styles/enhanced-objects.css" />

    <!-- 6. Utility components -->
    <link rel="stylesheet" href="src/styles/input-utility-components.css" />
    <link rel="stylesheet" href="src/styles/form-input-components.css" />

    <!-- 7. UI utility components -->
    <link rel="stylesheet" href="src/styles/notification-toast.css" />
    <link rel="stylesheet" href="src/styles/onboarding-tour.css" />
    <link rel="stylesheet" href="src/styles/scenario-modal.css" />
    <link rel="stylesheet" href="src/styles/scenario-reflection-modal.css" />
    <link rel="stylesheet" href="src/styles/radar-chart.css" />
    <link rel="stylesheet" href="src/styles/session-settings.css" />
    <link rel="stylesheet" href="src/styles/profile-customization.css" />
    <link
      rel="stylesheet"
      href="src/styles/components/gdpr-cookie-notice.css"
    />

    <link rel="stylesheet" href="src/styles/card-component.css" />
    <link rel="stylesheet" href="src/styles/loader-spinner.css" />

    <!-- 8. Page-specific and theme styles -->
    <link rel="stylesheet" href="src/styles/hero-consolidated.css" />
    <link rel="stylesheet" href="src/styles/ethics-demo-section.css" />
    <link
      rel="stylesheet"
      href="src/styles/state-management-consolidated.css"
    />
    <link rel="stylesheet" href="src/styles/category-grid.css" />
    <link rel="stylesheet" href="src/styles/category-page.css" />

    <!-- Scenario Browser and Components -->
    <link rel="stylesheet" href="src/styles/scenario-browser.css" />

    <!-- Scenario Card Component (used by category-grid and scenario-browser) -->
    <link rel="stylesheet" href="src/styles/scenario-card.css" />

    <!-- Ethics Analysis Components -->
    <link rel="stylesheet" href="src/styles/ethics-analysis.css" />

    <!-- User Interaction Components -->
    <link rel="stylesheet" href="src/styles/user-metadata-collector.css" />

    <!-- Community and Support Features -->
    <link rel="stylesheet" href="src/styles/donor-flair-display.css" />

    <!-- 9. Layout fixes and overrides -->
    <link rel="stylesheet" href="src/styles/layout-fixes.css" />

    <!-- 10. Ethics Explorer overrides (moved before consolidated modal) -->
    <link rel="stylesheet" href="src/styles/ethics-explorer.css" />

    <!-- Badge System -->
    <link rel="stylesheet" href="src/styles/badge-modal.css" />

    <!-- Community Features -->
    <link rel="stylesheet" href="src/styles/community-features.css" />

    <!-- 11. Modal system - consolidated architecture (loaded LAST for highest specificity) -->
    <link
      rel="stylesheet"
      href="src/styles/simulation-modal-consolidated.css"
    />

    <!-- Back to Top Component -->
    <link rel="stylesheet" href="src/styles/back-to-top.css" />

    <!-- Floating Tabs Consolidated Styles -->
    <link rel="stylesheet" href="src/styles/floating-tabs-consolidated.css" />

    <!-- Settings Menu Component -->
    <link rel="stylesheet" href="src/styles/settings-menu.css" />
    <!-- Footer Component Styles -->
    <link rel="stylesheet" href="src/styles/footer.css" />
    <link rel="stylesheet" href="src/styles/appearance-settings.css" />

    <!-- Icons and Favicons -->
    <link rel="icon" type="image/svg+xml" href="src/assets/icons/favicon.svg" />
    <link rel="icon" href="/favicon.ico" sizes="any" />
    <link rel="icon" type="image/png" href="src/assets/icons/favicon.png" />
    <link rel="apple-touch-icon" href="src/assets/icons/apple-touch-icon.png" />
    <meta
      name="msapplication-TileImage"
      content="src/assets/icons/favicon.svg"
    />

    <link rel="manifest" href="/manifest.json" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="SimulateAI" />
    <!-- Preload critical resources -->
    <link rel="preload" href="src/styles/main.css" as="style" />
    <link rel="preload" href="src/styles/accessibility.css" as="style" />
    <link rel="modulepreload" href="src/js/app.js" />
    <link rel="modulepreload" href="src/js/app-startup.js" />

    <!-- DNS prefetch / preconnect for external resources -->
    <link rel="dns-prefetch" href="//unpkg.com" />
    <link
      rel="preconnect"
      href="https://www.googletagmanager.com"
      crossorigin
    />
    <link rel="preconnect" href="https://www.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

    <!-- Resource hints -->
    <link rel="prefetch" href="src/js/core/engine.js" />
    <link rel="prefetch" href="src/js/core/accessibility.js" />
    <link rel="prefetch" href="src/js/core/animation-manager.js" />

    <!-- Scroll restoration configuration -->
    <script>
      // Configure scroll restoration (safe to do in head)
      if ("scrollRestoration" in history) {
        history.scrollRestoration = "manual";
      }

      // Single initialization function to prevent duplicate calls
      let pageInitialized = false;

      function initializePage() {
        if (pageInitialized) {
          return; // Prevent duplicate initialization
        }
        pageInitialized = true;

        // Only reset scroll position if there's no hash (don't interfere with navigation)
        if (!window.location.hash) {
          window.scrollTo(0, 0);
        }

        // Set loaded state for animations
        if (window.DOMClassManager) {
          window.DOMClassManager.setLoadedState(true);
        } else {
          document.documentElement.classList.add("loaded");
        }
      }

      // Single event listener setup
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", initializePage, {
          once: true,
        });
      } else {
        // DOM already loaded
        initializePage();
      }
    </script>

    <!-- Inert polyfill for older browsers -->
    <script>
      // Check if inert is supported, if not defer polyfill loading
      if (!("inert" in HTMLElement.prototype)) {
        // Use dynamic import with safe fallback for older browsers
        import("https://unpkg.com/wicg-inert@3.1.2/dist/inert.min.js").catch(
          () => {
            try {
              var s = document.createElement("script");
              s.src = "https://unpkg.com/wicg-inert@3.1.2/dist/inert.min.js";
              s.defer = true;
              document.head.appendChild(s);
            } catch (_) {}
          },
        );
      }
    </script>

    <!-- Remove base URL for localhost development -->
    <script>
      (function () {
        var h = window.location.hostname;
        var isLocal =
          h === "localhost" ||
          h === "127.0.0.1" ||
          h === "::1" ||
          h.startsWith("192.168.") ||
          h.endsWith(".local");
        if (isLocal) {
          const baseTag = document.getElementById("custom-domain-base");
          if (baseTag) {
            baseTag.remove();
          }
        }
      })();
    </script>
  </head>
  <body>
    <!-- Skip to content for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- ARIA live regions for announcements -->
    <div
      id="aria-live-polite"
      aria-live="polite"
      aria-atomic="true"
      class="sr-only"
    ></div>
    <div
      id="aria-live-assertive"
      aria-live="assertive"
      aria-atomic="true"
      class="sr-only"
    ></div>

    <!-- Status and notification area -->
    <div
      id="status-region"
      role="status"
      aria-live="polite"
      class="sr-only"
    ></div>

    <!-- Navigation container for SharedNavigation component injection -->
    <div id="navigation-container"></div>

    <!-- Main Content -->
    <main id="main-content" class="main-content" role="main">
      <!-- Hero Section -->
      <section class="hero layout-container-responsive" id="home">
        <div class="hero-content">
          <h2 class="hero-title">Welcome to SimulateAI</h2>
          <div class="hero-actions">
            <!-- Primary actions row: Start Exploring + Test Scenario -->
            <div class="primary-actions-row">
              <button
                class="btn btn-primary touch-target"
                id="start-learning"
                aria-describedby="start-learning-description"
                title="Navigate to Ethics Categories section"
              >
                Start Exploring
              </button>
              <span id="start-learning-description" class="sr-only">
                Navigate to the Ethics Categories section to explore thematic
                categories of ethical dilemmas
              </span>

              <!-- Debug: Test scenario modal button -->
              <button
                id="test-scenario-modal"
                class="btn btn-outline touch-target"
              >
                Test Scenario
              </button>
            </div>

            <!-- Classroom Collaboration Buttons (second row) -->
            <div class="classroom-actions-group">
              <button
                class="btn btn-secondary touch-target"
                id="create-classroom"
                aria-describedby="create-classroom-description"
                title="Create a classroom for real-time collaboration"
              >
                👨‍🏫 Create Classroom
              </button>
              <span id="create-classroom-description" class="sr-only">
                Create a new classroom to lead students through scenarios in
                real-time
              </span>

              <button
                class="btn btn-outline touch-target"
                id="join-classroom"
                aria-describedby="join-classroom-description"
                title="Join an existing classroom session"
              >
                🎓 Join Classroom
              </button>
              <span id="join-classroom-description" class="sr-only">
                Join an existing classroom session using a classroom code
              </span>
            </div>
          </div>

          <!-- Support Research Donation Button removed -->
        </div>
      </section>

      <!-- Interactive Ethics Demo Section -->
      <section
        class="ethics-demo-section layout-container-responsive"
        id="ethics-demo"
      >
        <div class="demo-section-header">
          <h2 class="demo-section-title">Interactive Ethics Radar Chart</h2>
          <p class="demo-section-description">
            Experience how ethical decisions affect multiple dimensions
            simultaneously. Click the buttons to see different decision patterns
            and understand the complex relationships between ethical principles.
          </p>
        </div>

        <div class="demo-horizontal-layout">
          <!-- Demo Controls Panel -->
          <div class="demo-controls-panel">
            <h3 class="controls-title">Try Different Ethical Approaches</h3>
            <p class="controls-description">
              Each button represents a different ethical framework. Watch how
              the radar chart changes to show their unique priorities:
            </p>

            <!-- Demo Control Buttons -->
            <div class="demo-controls-grid horizontal">
              <!-- Feedback popover positioned within grid -->
              <div id="hero-demo-feedback" class="demo-feedback-popover">
                <div class="popover-content"></div>
                <div class="popover-arrow"></div>
              </div>

              <button
                class="demo-btn"
                data-pattern="utilitarian"
                aria-label="Apply utilitarian ethics pattern to the radar chart"
                onclick="simulateEthicsPattern('utilitarian', this)"
              >
                <span class="btn-label">Utilitarian</span>
                <span class="btn-description"
                  >Greatest good for greatest number</span
                >
              </button>
              <button
                class="demo-btn"
                data-pattern="deontological"
                aria-label="Apply rights-based ethics pattern to the radar chart"
                onclick="simulateEthicsPattern('deontological', this)"
              >
                <span class="btn-label">Rights-Based</span>
                <span class="btn-description"
                  >Universal moral rules and duties</span
                >
              </button>
              <button
                class="demo-btn"
                data-pattern="virtue"
                aria-label="Apply virtue ethics pattern to the radar chart"
                onclick="simulateEthicsPattern('virtue', this)"
              >
                <span class="btn-label">Virtue Ethics</span>
                <span class="btn-description"
                  >Character-based moral excellence</span
                >
              </button>
              <button
                class="demo-btn"
                data-pattern="balanced"
                aria-label="Apply balanced ethics pattern to the radar chart"
                onclick="simulateEthicsPattern('balanced', this)"
              >
                <span class="btn-label">Balanced</span>
                <span class="btn-description"
                  >Integrative multi-principle approach</span
                >
              </button>
            </div>

            <!-- Polite orientation suggestion for mobile users -->
            <div class="orientation-suggestion">
              <span class="rotate-icon">📱↻</span>
              <span class="message-text"
                >For the best experience, try rotating your device to landscape
                mode!</span
              >
            </div>
          </div>

          <!-- Radar Chart Panel -->
          <div class="radar-chart-panel">
            <div id="hero-ethics-chart" class="radar-chart-wrapper"></div>
          </div>
        </div>

        <!-- Collapsible Help Sections -->
        <div class="demo-help-sections">
          <!-- Instructions Accordion -->
          <div class="radar-instructions-accordion">
            <div class="accordion-item">
              <div
                class="accordion-header"
                role="button"
                tabindex="0"
                aria-expanded="false"
                onclick="toggleRadarInstructions()"
              >
                <span class="accordion-icon">▶</span>
                <span class="accordion-title">💡 How to Read the Chart</span>
              </div>
              <div class="accordion-content collapsed">
                <div class="accordion-content-inner">
                  <p>
                    <strong>Hover over any point</strong> on the radar chart to
                    see detailed information about that ethical dimension. Each
                    point shows:
                  </p>
                  <ul>
                    <li>
                      <strong>Axis Name:</strong> The specific ethical principle
                      (e.g., Fairness, Sustainability)
                    </li>
                    <li>
                      <strong>Score Value:</strong> How strongly this approach
                      emphasizes that principle (1-5 scale)
                    </li>
                    <li>
                      <strong>Description:</strong> What this principle means
                      and why it matters
                    </li>
                    <li>
                      <strong>Impact Level:</strong> Whether the emphasis is
                      low, moderate, or high
                    </li>
                  </ul>
                  <p>
                    The <strong>shape and size</strong> of the radar pattern
                    shows the overall ethical "signature" of each approach. A
                    larger, more balanced shape indicates consideration of
                    multiple principles, while a smaller or skewed shape shows
                    focused emphasis on specific values.
                  </p>
                </div>
              </div>
            </div>
          </div>

          <!-- Ethics Glossary Accordion -->
          <div class="ethics-glossary-accordion">
            <div class="accordion-item">
              <div
                class="accordion-header"
                role="button"
                tabindex="0"
                aria-expanded="false"
                onclick="toggleEthicsGlossary()"
              >
                <span class="accordion-icon">▶</span>
                <span class="accordion-title"
                  >📚 Ethical Dimensions Glossary</span
                >
              </div>
              <div class="accordion-content collapsed">
                <div class="accordion-content-inner">
                  <div class="glossary-grid">
                    <div class="glossary-item">
                      <h4>Fairness</h4>
                      <p>
                        Treats all individuals and groups equitably, ensuring
                        unbiased and just outcomes for everyone involved.
                      </p>
                    </div>
                    <div class="glossary-item">
                      <h4>Sustainability</h4>
                      <p>
                        Supports long-term ecological and social well-being,
                        considering environmental and societal impacts.
                      </p>
                    </div>
                    <div class="glossary-item">
                      <h4>Autonomy</h4>
                      <p>
                        Respects individual control and self-determination,
                        preserving people's ability to make their own choices.
                      </p>
                    </div>
                    <div class="glossary-item">
                      <h4>Beneficence</h4>
                      <p>
                        Promotes well-being and prevents harm, actively working
                        to benefit individuals and communities.
                      </p>
                    </div>
                    <div class="glossary-item">
                      <h4>Transparency</h4>
                      <p>
                        Provides openness in decision-making processes, ensuring
                        clarity about how and why decisions are made.
                      </p>
                    </div>
                    <div class="glossary-item">
                      <h4>Accountability</h4>
                      <p>
                        Ensures clear responsibility for decisions, with
                        mechanisms for oversight and consequences for actions.
                      </p>
                    </div>
                    <div class="glossary-item">
                      <h4>Privacy</h4>
                      <p>
                        Protects personal information and data rights,
                        safeguarding individual confidentiality and control over
                        personal data.
                      </p>
                    </div>
                    <div class="glossary-item">
                      <h4>Proportionality</h4>
                      <p>
                        Balances benefits against severity of impact, ensuring
                        responses are appropriate to the situation's scale and
                        context.
                      </p>
                    </div>
                  </div>

                  <div class="glossary-note">
                    <p>
                      <strong>Remember:</strong> These dimensions often interact
                      and sometimes conflict with each other. Real ethical
                      decision-making involves thoughtfully balancing these
                      competing values based on context, stakeholder needs, and
                      long-term consequences.
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Categories Grid -->
      <section
        class="categories-section layout-container-responsive"
        id="categories"
      >
        <div class="main-section-header">
          <h2 class="main-section-title">Simulation Library</h2>
          <p class="main-section-description">
            Explore AI ethics through interactive simulations. Browse by
            thematic categories or view all scenarios individually. Each
            simulation presents real-world ethical dilemmas where you can
            explore consequences, examine different perspectives, and discover
            solutions through guided decision-making.
          </p>

          <!-- View Toggle Controls -->
          <div
            class="view-toggle-controls"
            role="radiogroup"
            aria-label="Choose view type"
          >
            <button
              type="button"
              class="view-toggle-btn active touch-target"
              data-view="category"
              role="radio"
              aria-checked="true"
              aria-label="Category view - show scenarios grouped by category"
              title="Category view - show scenarios grouped by category"
            >
              <span class="toggle-icon">📂</span>
              <span class="toggle-text">Category View</span>
            </button>
            <button
              type="button"
              class="view-toggle-btn touch-target"
              data-view="scenario"
              role="radio"
              aria-checked="false"
              aria-label="Scenario view - show all scenarios as individual cards"
              title="Scenario view - show all scenarios as individual cards"
            >
              <span class="toggle-icon">🎯</span>
              <span class="toggle-text">Scenario View</span>
            </button>
            <div class="keyboard-hint" title="Press 'V' key to toggle views">
              <span class="hint-text">Press <kbd>V</kbd> to toggle</span>
            </div>
          </div>
        </div>

        <!-- Category Grid View (current) -->
        <div
          class="categories-grid view-content active"
          data-view="category"
          role="grid"
          aria-label="Available ethics categories"
        >
          <!-- Category cards will be dynamically generated -->
        </div>

        <!-- Scenario Grid View (new) -->
        <div
          class="scenarios-grid view-content"
          data-view="scenario"
          role="grid"
          aria-label="All available scenarios"
          style="display: none"
        >
          <!-- Scenario Controls Toolbar -->
          <div
            class="scenario-controls-toolbar"
            role="toolbar"
            aria-label="Scenario filtering and search controls"
          >
            <!-- Search -->
            <div class="search-container">
              <div class="search-input-wrapper">
                <svg
                  class="search-icon"
                  viewBox="0 0 20 20"
                  fill="currentColor"
                  aria-hidden="true"
                >
                  <path
                    fill-rule="evenodd"
                    d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z"
                    clip-rule="evenodd"
                  />
                </svg>
                <input
                  type="search"
                  class="search-input"
                  placeholder="Search scenarios, titles, and tags..."
                  aria-label="Search scenarios by title, description, or tags"
                  autocomplete="off"
                  spellcheck="false"
                  aria-expanded="false"
                  aria-haspopup="listbox"
                  role="combobox"
                />
                <button
                  type="button"
                  class="search-clear"
                  aria-label="Clear search"
                  style="display: none"
                >
                  <svg
                    viewBox="0 0 20 20"
                    fill="currentColor"
                    aria-hidden="true"
                  >
                    <path
                      d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"
                    />
                  </svg>
                </button>

                <!-- Autocomplete Dropdown -->
                <div
                  class="search-autocomplete-dropdown"
                  role="listbox"
                  aria-label="Search suggestions"
                  style="display: none"
                >
                  <div class="autocomplete-section">
                    <div class="autocomplete-section-header">Scenarios</div>
                    <div class="autocomplete-scenarios"></div>
                  </div>
                  <div class="autocomplete-section">
                    <div class="autocomplete-section-header">Tags</div>
                    <div class="autocomplete-tags"></div>
                  </div>
                  <div class="autocomplete-no-results" style="display: none">
                    <div class="no-results-text">No matches found</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Filters and Sort -->
            <div class="controls-group">
              <!-- Sort -->
              <div class="sort-container">
                <button
                  type="button"
                  class="sort-btn"
                  aria-label="Sort scenarios"
                  aria-expanded="false"
                  aria-haspopup="listbox"
                >
                  <svg
                    class="sort-icon"
                    viewBox="0 0 20 20"
                    fill="currentColor"
                    aria-hidden="true"
                  >
                    <path
                      fill-rule="evenodd"
                      d="M10 3a.75.75 0 01.55.24l3.25 3.5a.75.75 0 11-1.1 1.02L10 4.852 7.3 7.76a.75.75 0 01-1.1-1.02l3.25-3.5A.75.75 0 0110 3zm-3.76 9.2a.75.75 0 011.06.04l2.7 2.908 2.7-2.908a.75.75 0 111.1 1.02l-3.25 3.5a.75.75 0 01-1.1 0l-3.25-3.5a.75.75 0 01.04-1.06z"
                      clip-rule="evenodd"
                    />
                  </svg>
                  <span class="sort-text">Sort: A-Z</span>
                  <svg
                    class="chevron-icon"
                    viewBox="0 0 20 20"
                    fill="currentColor"
                    aria-hidden="true"
                  >
                    <path
                      fill-rule="evenodd"
                      d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
                      clip-rule="evenodd"
                    />
                  </svg>
                </button>
                <div
                  class="sort-dropdown"
                  role="listbox"
                  aria-label="Select sorting method"
                >
                  <button
                    type="button"
                    class="sort-option active"
                    data-sort="alphabetical"
                    role="option"
                    aria-selected="true"
                  >
                    <span class="option-text">Sort: A-Z</span>
                    <svg
                      class="check-icon"
                      viewBox="0 0 20 20"
                      fill="currentColor"
                      aria-hidden="true"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z"
                        clip-rule="evenodd"
                      />
                    </svg>
                  </button>
                  <button
                    type="button"
                    class="sort-option"
                    data-sort="category"
                    role="option"
                    aria-selected="false"
                  >
                    <span class="option-text">By Category</span>
                    <svg
                      class="check-icon"
                      viewBox="0 0 20 20"
                      fill="currentColor"
                      aria-hidden="true"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z"
                        clip-rule="evenodd"
                      />
                    </svg>
                  </button>
                  <button
                    type="button"
                    class="sort-option"
                    data-sort="difficulty"
                    role="option"
                    aria-selected="false"
                  >
                    <span class="option-text">By Difficulty</span>
                    <svg
                      class="check-icon"
                      viewBox="0 0 20 20"
                      fill="currentColor"
                      aria-hidden="true"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z"
                        clip-rule="evenodd"
                      />
                    </svg>
                  </button>
                  <button
                    type="button"
                    class="sort-option"
                    data-sort="newest"
                    role="option"
                    aria-selected="false"
                  >
                    <span class="option-text">Newest First</span>
                    <svg
                      class="check-icon"
                      viewBox="0 0 20 20"
                      fill="currentColor"
                      aria-hidden="true"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z"
                        clip-rule="evenodd"
                      />
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Scenario count will be displayed here -->
          <div class="scenario-count" style="display: none">
            <p class="count-text">
              Showing <span class="count-number">0</span> scenarios
            </p>
          </div>
          <!-- Individual scenario cards will be dynamically generated -->
        </div>
      </section>

      <!-- Donor Appreciation Section -->
      <section
        class="donor-appreciation-section layout-container-responsive"
        id="donor-appreciation"
      >
        <div class="main-section-header">
          <h2 class="main-section-title">🙏 Thank You to Our Contributors</h2>
          <p class="main-section-description">
            Your support makes ethical AI education accessible to everyone
          </p>
        </div>

        <!-- Donor Wall -->
        <div class="donor-wall-container">
          <div class="donor-wall-header">
            <h3 class="donor-wall-title">Our Amazing Community</h3>
            <p class="donor-wall-subtitle">
              Every contribution, big or small, helps us democratize ethical AI
              education and reach learners worldwide. Meet the incredible people
              who believe in our mission and make this work possible.
            </p>

            <!-- Donor Wall Filters -->
            <div
              class="donor-wall-filters"
              role="tablist"
              aria-label="Donor display filters"
            >
              <button
                class="filter-btn active"
                data-filter="recent"
                role="tab"
                aria-selected="true"
                aria-controls="donor-carousel"
              >
                Most Recent
              </button>
              <button
                class="filter-btn"
                data-filter="top"
                role="tab"
                aria-selected="false"
                aria-controls="donor-carousel"
              >
                Top Contributors
              </button>
              <button
                class="filter-btn"
                data-filter="messages"
                role="tab"
                aria-selected="false"
                aria-controls="donor-carousel"
              >
                With Messages
              </button>
            </div>
          </div>

          <!-- Donor Carousel -->
          <div
            class="donor-carousel-container"
            id="donor-carousel"
            role="tabpanel"
          >
            <div class="donor-carousel">
              <button
                class="carousel-nav carousel-prev"
                aria-label="Previous donors"
                disabled
              >
                <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                  <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z" />
                </svg>
              </button>

              <div class="donor-cards-track">
                <div class="donor-cards-container">
                  <!-- Donor cards will be dynamically populated here -->

                  <!-- Example donor card structure (will be generated by JS) -->
                  <div class="donor-card" data-visibility="username">
                    <div class="donor-avatar">
                      <img
                        src="src/assets/avatars/default-avatar.svg"
                        alt="Donor avatar"
                      />
                      <div
                        class="donor-badge gold-tier"
                        aria-label="Gold tier contributor"
                      ></div>
                    </div>
                    <div class="donor-info">
                      <h4 class="donor-name">Alex Chen</h4>
                      <p class="donor-since">Supporting since Nov 2024</p>
                      <div class="donor-reflection">
                        <p>
                          "Ethical AI education is the foundation of our digital
                          future."
                        </p>
                      </div>
                    </div>
                  </div>

                  <!-- Anonymous donor card example -->
                  <div class="donor-card" data-visibility="anonymous">
                    <div class="donor-avatar">
                      <div
                        class="anonymous-avatar"
                        aria-label="Anonymous contributor"
                      ></div>
                      <div
                        class="donor-badge silver-tier"
                        aria-label="Silver tier contributor"
                      ></div>
                    </div>
                    <div class="donor-info">
                      <h4 class="donor-name">Anonymous Supporter</h4>
                      <p class="donor-since">Recent contributor</p>
                    </div>
                  </div>
                </div>
              </div>

              <button
                class="carousel-nav carousel-next"
                aria-label="Next donors"
              >
                <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                  <path d="M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z" />
                </svg>
              </button>
            </div>

            <!-- Carousel Indicators -->
            <div
              class="carousel-indicators"
              role="tablist"
              aria-label="Donor page indicators"
            >
              <button
                class="indicator active"
                data-slide="0"
                role="tab"
                aria-selected="true"
                aria-label="Page 1"
              ></button>
              <button
                class="indicator"
                data-slide="1"
                role="tab"
                aria-selected="false"
                aria-label="Page 2"
              ></button>
              <button
                class="indicator"
                data-slide="2"
                role="tab"
                aria-selected="false"
                aria-label="Page 3"
              ></button>
            </div>
          </div>

          <!-- Donor Stats Summary -->
          <div class="donor-stats-summary">
            <div class="stat-item">
              <span class="stat-number" data-stat="total-donors">127</span>
              <span class="stat-label">Contributors</span>
            </div>
            <div class="stat-item">
              <span class="stat-number" data-stat="this-month">23</span>
              <span class="stat-label">This Month</span>
            </div>
            <div class="stat-item">
              <span class="stat-number" data-stat="countries">12</span>
              <span class="stat-label">Countries</span>
            </div>
          </div>
        </div>

        <!-- Support CTA -->
        <div class="support-cta">
          <h3>Join Our Mission</h3>
          <p>
            Ready to support ethical AI education? Even a small contribution of
            $5 demonstrates your commitment to building a more ethical future
            with artificial intelligence.
          </p>
          <div class="cta-buttons">
            <a href="donate.html" class="btn btn-primary"
              >💖 Support Our Mission</a
            >
            <a href="about.html" class="btn btn-outline">Learn More About Us</a>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer will be inserted by professional-footer.js -->
    <div id="footer-placeholder"></div>

    <!-- Simulation Modal - Updated to use advanced-ui-components.css modal system -->
    <div
      id="simulation-modal"
      class="modal-backdrop"
      role="dialog"
      aria-modal="true"
      aria-hidden="true"
      aria-labelledby="modal-title"
      inert
    >
      <div class="modal-dialog">
        <div class="modal-header">
          <h2 id="modal-title" class="modal-title"></h2>
          <button
            class="modal-close"
            aria-label="Close simulation"
            type="button"
          >
            <span aria-hidden="true">×</span>
          </button>
        </div>
        <div class="modal-body">
          <div
            id="simulation-container"
            class="simulation-container"
            role="main"
            aria-label="Interactive simulation"
          >
            <!-- Active simulation will be loaded here -->
          </div>

          <div
            class="simulation-controls"
            role="complementary"
            aria-label="Simulation controls and metrics"
          >
            <div class="ethics-meters">
              <!-- Enhanced ethics meters with visual engine will be loaded here -->
              <div class="ethics-meters-header">
                <h3>Ethics Monitoring</h3>
                <p>
                  Track how your decisions affect different ethical dimensions
                </p>
              </div>
              <div
                class="meters-container"
                role="group"
                aria-label="Ethics meters"
              >
                <!-- Enhanced meters will be dynamically created here -->
              </div>
            </div>

            <div class="simulation-actions">
              <div class="actions-header">
                <h3>Simulation Controls</h3>
              </div>
              <div
                class="actions-container"
                role="group"
                aria-label="Simulation action buttons"
              >
                <!-- Enhanced interactive buttons will be created here -->
                <button
                  class="btn btn-secondary"
                  id="reset-simulation"
                  style="display: none"
                  type="button"
                >
                  <span class="btn-text">Reset</span>
                  <span class="btn-description sr-only"
                    >Reset the current simulation to start over</span
                  >
                </button>
                <button
                  class="btn btn-primary"
                  id="next-scenario"
                  style="display: none"
                  type="button"
                >
                  <span class="btn-text">Next Scenario</span>
                  <span class="btn-description sr-only"
                    >Continue to the next scenario</span
                  >
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Loading indicator -->
    <div id="loading" class="loading" aria-hidden="true" role="status">
      <div class="loading-spinner" aria-hidden="true"></div>
      <p class="loading-text">Loading simulation...</p>
      <div
        class="loading-progress"
        role="progressbar"
        aria-label="Loading progress"
        aria-valuenow="0"
        aria-valuemin="0"
        aria-valuemax="100"
      >
        <div class="progress-bar"></div>
      </div>
    </div>

    <!-- Error boundary -->
    <div
      id="error-boundary"
      class="error-boundary"
      role="alert"
      aria-hidden="true"
    >
      <div class="error-content">
        <h2>Something went wrong</h2>
        <p class="error-message"></p>
        <div class="error-actions">
          <button class="btn btn-primary" id="retry-action" type="button">
            Try Again
          </button>
          <button class="btn btn-secondary" id="report-error" type="button">
            Report Issue
          </button>
        </div>
      </div>
    </div>

    <!-- Firebase SDK Scripts -->
    <!-- Note: Firebase SDK is imported via ES modules in firebase-service.js -->

    <!-- Scripts -->
    <script type="module" src="src/js/services/firebase-service.js"></script>
    <!-- Core event system and environment config should load early to avoid race conditions -->
    <!-- Event Manager - Must load BEFORE other modules to prevent race conditions -->
    <script type="module" src="src/js/utils/event-manager.js"></script>
    <!-- Event Dispatcher for Component Communication -->
    <script type="module" src="src/js/utils/event-dispatcher.js"></script>
    <!-- Environment configuration (consumers should also import explicitly) -->
    <script type="module" src="src/js/utils/env-config.js"></script>

    <!-- Early components -->
    <script
      type="module"
      src="src/js/components/notification-toast.js"
    ></script>
    <script type="module" src="src/js/components/modal-utility.js"></script>

    <!-- CSS Layers Diagnostic Tool (development only) -->
    <script type="module">
      window.__simulateaiDevFlags =
        window.__simulateaiDevFlags ||
        (() => {
          const h = location.hostname;
          const isDevHost =
            ["localhost", "127.0.0.1", "::1"].includes(h) ||
            h.startsWith("192.168.") ||
            h.endsWith(".local");
          const debugFlag =
            localStorage.getItem("debug") === "true" ||
            sessionStorage.getItem("debug") === "true";
          return { isDevHost, debugFlag };
        })();
      if (
        window.__simulateaiDevFlags.isDevHost ||
        window.__simulateaiDevFlags.debugFlag
      ) {
        import("/src/utils/css-layers-diagnostic.js");
      }
    </script>

    <!-- JSON SSOT Configuration System - Initialize before app.js -->
    <script type="module" src="src/js/app-startup.js"></script>

    <script type="module" src="src/js/app.js"></script>
    <script
      type="module"
      src="src/js/components/enhanced-donation-widget.js"
    ></script>
    <script
      type="module"
      src="src/js/components/donor-flair-display.js"
    ></script>
    <link rel="stylesheet" href="src/styles/enhanced-donation-widget.css" />

    <!-- Professional Donor Wall -->
    <link rel="stylesheet" href="src/styles/donor-wall.css" />

    <script type="module">
      // Initialize enhanced donation widget and donor flair - consolidated initialization
      function initializeDonationComponents() {
        // Debug tracking
        if (window.debugInitTracker) {
          window.debugInitTracker.events.push({
            time: Date.now(),
            event: "initializeDonationComponents",
            readyState: document.readyState,
          });
        }

        if (
          window.EnhancedDonationWidget &&
          document.getElementById("homepage-donation-button")
        ) {
          window.EnhancedDonationWidget.init("homepage-donation-button", {
            title: "💖 Support SimulateAI Research",
            subtitle:
              "Help us continue developing open-source AI ethics education resources",
            style: "accordion",
            showBenefits: true,
          });
        }

        // Initialize donor appreciation section
        if (window.DonorFlairDisplay) {
          const flairDisplay = new window.DonorFlairDisplay();

          // Sample donors for demonstration - in production this would come from your backend
          const sampleDonors = [
            {
              displayName: "Alex Chen",
              flair: "gold",
              supportSince: "2024-11-01",
            },
            {
              displayName: "Dr. Sarah Williams",
              flair: "silver",
              supportSince: "2024-12-15",
            },
            {
              displayName: "Mike Rodriguez",
              flair: "bronze",
              supportSince: "2025-01-03",
            },
            {
              displayName: "Emma Thompson",
              flair: "silver",
              supportSince: "2024-10-20",
            },
            {
              displayName: "David Kim",
              flair: "bronze",
              supportSince: "2025-01-10",
            },
          ];

          flairDisplay.createDonorAppreciationSection(
            "#donor-appreciation-container",
            sampleDonors,
          );
        }
      }

      // Use a more efficient initialization approach
      if (document.readyState === "loading") {
        document.addEventListener(
          "DOMContentLoaded",
          initializeDonationComponents,
          { once: true },
        );
      } else {
        // DOM already loaded, initialize immediately
        initializeDonationComponents();
      }
    </script>

    <!-- Donation Preferences Component -->
    <script
      type="module"
      src="src/js/components/donation-preferences.js"
    ></script>

    <!-- Chart.js library for radar charts - UMD version -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <!-- Chart.js loaded successfully - debug logs removed for cleaner console output -->

    <script type="module" src="src/js/components/card-component.js"></script>
    <script type="module" src="src/js/components/loader-spinner.js"></script>
    <script
      type="module"
      src="src/js/components/form-input-components.js"
    ></script>
    <script
      type="module"
      src="src/js/components/modal-footer-manager.js"
    ></script>
    <script type="module" src="src/js/components/main-grid.js"></script>

    <!-- Performance monitoring -->
    <script>
      // Enhanced performance monitoring for our modernized engine
      if ("performance" in window && "mark" in performance) {
        performance.mark("page-start");

        window.addEventListener(
          "load",
          () => {
            performance.mark("page-loaded");
            performance.measure("page-load-time", "page-start", "page-loaded");

            // Report to our analytics system
            const measure = performance.getEntriesByName("page-load-time")[0];
            if (measure && window.SimpleAnalytics) {
              window.SimpleAnalytics.trackPerformance(
                "page-load",
                measure.duration,
              );
            }
          },
          { once: true },
        );
      }

      // Enhanced error handling
      window.addEventListener("error", (event) => {
        // Log error for debugging (console allowed in HTML for error handling)
        if (window.ErrorBoundary) {
          window.ErrorBoundary.handleError(event.error);
        }
      });

      window.addEventListener("unhandledrejection", (event) => {
        // Log promise rejection for debugging (console allowed in HTML for error handling)
        if (window.ErrorBoundary) {
          window.ErrorBoundary.handleError(event.reason);
        }
      });
    </script>

    <!-- Include shared navigation component -->
    <script type="module" src="src/js/components/shared-navigation.js"></script>

    <!-- Back to Top Component -->
    <script type="module" src="src/js/components/back-to-top.js"></script>

    <!-- Settings Manager Component -->
    <script type="module" src="src/js/components/settings-manager.js"></script>

    <!-- Event system loaded earlier to prevent race conditions -->

    <!-- Intentional Logout System -->
    <script
      type="module"
      src="src/js/styles/intentional-logout.css.js"
    ></script>
    <script
      type="module"
      src="src/js/components/intentional-logout-manager.js"
    ></script>

    <!-- Donation Tracker Utility -->
    <script type="module" src="src/js/utils/donation-tracker.js"></script>

    <!-- Floating Action Tab Component -->
    <script
      type="module"
      src="src/js/components/floating-action-tab.js"
    ></script>

    <!-- Floating Surprise Tab Component -->
    <script
      type="module"
      src="src/js/components/floating-surprise-tab.js"
    ></script>
    <script type="module" src="src/js/components/floating-tour-tab.js"></script>

    <!-- Include donor appreciation component -->
    <script
      type="module"
      src="src/js/components/donor-appreciation.js"
    ></script>

    <!-- Professional Donor Wall Component -->
    <script
      type="module"
      src="src/js/components/professional-donor-wall.js"
    ></script>

    <!-- Professional Footer Component -->
    <script
      type="module"
      src="src/js/components/professional-footer.js"
    ></script>

    <!-- GDPR Cookie Notice -->
    <script
      type="module"
      src="src/js/components/gdpr-cookie-notice.js"
    ></script>
    <script type="module" src="src/js/utils/gdpr-init.js"></script>

    <!-- Development analyzers: load only on local/dev or when debug flag is enabled -->
    <script type="module">
      const flags = window.__simulateaiDevFlags || {
        isDevHost: false,
        debugFlag: false,
      };
      if (flags.isDevHost || flags.debugFlag) {
        import("/src/utils/theme-validator.js");
        import("/src/utils/css-performance-analyzer.js");
        import("/src/utils/state-management-analyzer.js");
        import("/src/utils/css-layers-migration-analyzer.js");
      }
    </script>
  </body>
</html>

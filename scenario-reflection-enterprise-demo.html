<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Enhanced Scenario Reflection Modal - Enterprise Demo</title>
    <link rel="stylesheet" href="src/css/app.css" />
    <link rel="stylesheet" href="src/css/components/modal.css" />
    <link
      rel="stylesheet"
      href="src/css/components/scenario-reflection-modal.css"
    />
    <style>
      body {
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        margin: 0;
        padding: 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
      }

      .demo-container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        border-radius: 12px;
        padding: 30px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      }

      .demo-header {
        text-align: center;
        margin-bottom: 40px;
      }

      .demo-header h1 {
        color: #2c3e50;
        margin-bottom: 10px;
      }

      .demo-header p {
        color: #7f8c8d;
        font-size: 1.1em;
      }

      .feature-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .feature-card {
        background: #f8f9fa;
        border-radius: 8px;
        padding: 20px;
        border-left: 4px solid #3498db;
      }

      .feature-card h3 {
        color: #2c3e50;
        margin: 0 0 10px 0;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .feature-card p {
        color: #7f8c8d;
        margin: 0;
        line-height: 1.5;
      }

      .demo-buttons {
        display: flex;
        gap: 15px;
        justify-content: center;
        flex-wrap: wrap;
        margin: 30px 0;
      }

      .demo-btn {
        background: linear-gradient(45deg, #3498db, #2980b9);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 16px;
        font-weight: 500;
        transition: all 0.3s ease;
        min-width: 180px;
      }

      .demo-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
      }

      .demo-btn.enterprise {
        background: linear-gradient(45deg, #e74c3c, #c0392b);
      }

      .demo-btn.accessibility {
        background: linear-gradient(45deg, #9b59b6, #8e44ad);
      }

      .demo-btn.analytics {
        background: linear-gradient(45deg, #f39c12, #e67e22);
      }

      .health-monitor {
        background: #ecf0f1;
        border-radius: 8px;
        padding: 20px;
        margin: 20px 0;
      }

      .metrics-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-top: 15px;
      }

      .metric-item {
        background: white;
        padding: 15px;
        border-radius: 6px;
        text-align: center;
        border: 1px solid #bdc3c7;
      }

      .metric-value {
        font-size: 1.5em;
        font-weight: bold;
        color: #2c3e50;
      }

      .metric-label {
        color: #7f8c8d;
        font-size: 0.9em;
        margin-top: 5px;
      }

      .status-indicators {
        display: flex;
        gap: 10px;
        margin-top: 20px;
        flex-wrap: wrap;
      }

      .status-indicator {
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 0.9em;
        font-weight: 500;
      }

      .status-indicator.active {
        background: #2ecc71;
        color: white;
      }

      .status-indicator.monitoring {
        background: #3498db;
        color: white;
      }

      .status-indicator.analytics {
        background: #f39c12;
        color: white;
      }
    </style>
  </head>

  <body>
    <div class="demo-container">
      <div class="demo-header">
        <h1>üöÄ Enhanced Scenario Reflection Modal</h1>
        <p>
          Enterprise-grade component with monitoring, analytics, and
          accessibility features
        </p>
      </div>

      <div class="feature-grid">
        <div class="feature-card">
          <h3>üè• Health Monitoring</h3>
          <p>
            Real-time component health tracking with circuit breaker patterns,
            error monitoring, and performance metrics collection.
          </p>
        </div>

        <div class="feature-card">
          <h3>üìä Advanced Analytics</h3>
          <p>
            Comprehensive user interaction tracking, community engagement
            metrics, and behavioral analysis with enterprise event dispatching.
          </p>
        </div>

        <div class="feature-card">
          <h3>‚ôø Enhanced Accessibility</h3>
          <p>
            ARIA live regions, keyboard navigation enhancements, high contrast
            support, and reduced motion preferences detection.
          </p>
        </div>

        <div class="feature-card">
          <h3>üé® Theme Adaptation</h3>
          <p>
            Automatic dark/light mode detection, CSS custom property
            integration, and user preference responsiveness.
          </p>
        </div>

        <div class="feature-card">
          <h3>‚ö° Performance Tracking</h3>
          <p>
            Detailed initialization timing, component lifecycle monitoring, and
            optimization opportunity identification.
          </p>
        </div>

        <div class="feature-card">
          <h3>üîß Circuit Breaker</h3>
          <p>
            Fault tolerance patterns with automatic recovery, failure threshold
            management, and graceful degradation.
          </p>
        </div>
      </div>

      <div class="health-monitor">
        <h3>üìà Live Component Health Monitor</h3>
        <div class="metrics-grid">
          <div class="metric-item">
            <div class="metric-value" id="interaction-count">0</div>
            <div class="metric-label">User Interactions</div>
          </div>
          <div class="metric-item">
            <div class="metric-value" id="error-count">0</div>
            <div class="metric-label">Errors Tracked</div>
          </div>
          <div class="metric-item">
            <div class="metric-value" id="circuit-breaker-state">Closed</div>
            <div class="metric-label">Circuit Breaker</div>
          </div>
          <div class="metric-item">
            <div class="metric-value" id="uptime">0ms</div>
            <div class="metric-label">Component Uptime</div>
          </div>
        </div>

        <div class="status-indicators">
          <span class="status-indicator active">‚úÖ Enterprise Monitoring</span>
          <span class="status-indicator monitoring">üìä Health Tracking</span>
          <span class="status-indicator analytics"
            >üìà Performance Analytics</span
          >
        </div>
      </div>

      <div class="demo-buttons">
        <button class="demo-btn" onclick="openScenarioReflectionModal('basic')">
          üéØ Basic Scenario Reflection
        </button>

        <button
          class="demo-btn enterprise"
          onclick="openScenarioReflectionModal('enterprise')"
        >
          üè¢ Enterprise Mode
        </button>

        <button
          class="demo-btn accessibility"
          onclick="openScenarioReflectionModal('accessibility')"
        >
          ‚ôø Accessibility Enhanced
        </button>

        <button
          class="demo-btn analytics"
          onclick="openScenarioReflectionModal('analytics')"
        >
          üìä Analytics Focus
        </button>
      </div>

      <div style="text-align: center; color: #7f8c8d; margin-top: 30px">
        <p>
          <strong>Enterprise Features:</strong> Health monitoring, circuit
          breaker patterns, advanced analytics, enhanced accessibility, theme
          adaptation, performance tracking
        </p>
      </div>
    </div>

    <!-- Scripts -->
    <script src="src/js/utils/modal-utility.js"></script>
    <script src="src/js/utils/simple-analytics.js"></script>
    <script src="src/js/utils/config/scenario-reflection-config.js"></script>
    <script src="src/js/utils/simple-state-management.js"></script>
    <script src="src/js/utils/event-dispatcher.js"></script>
    <script src="src/js/data/simulation-info.js"></script>
    <script src="src/js/components/scenario-reflection-modal.js"></script>

    <script>
      // Mock scenario data for testing
      const mockScenarioData = {
        title: "AI Healthcare Assistant Decision",
        description:
          "An AI system must decide whether to recommend experimental treatment",
        options: [
          {
            id: "recommend",
            text: "Recommend experimental treatment",
            ethicalWeight: { benefit: 8, harm: 3, autonomy: 6, justice: 7 },
          },
          {
            id: "conservative",
            text: "Suggest conservative treatment",
            ethicalWeight: { benefit: 5, harm: 2, autonomy: 8, justice: 8 },
          },
          {
            id: "refer",
            text: "Refer to human specialist",
            ethicalWeight: { benefit: 6, harm: 1, autonomy: 9, justice: 6 },
          },
        ],
      };

      let currentModalInstance = null;

      // Demo functions
      function openScenarioReflectionModal(mode = "basic") {
        const options = {
          categoryId: "healthcare-ai",
          scenarioId: "treatment-recommendation",
          scenarioData: mockScenarioData,
          selectedOption: mockScenarioData.options[0],
          enterpriseMonitoring: mode === "enterprise" || mode === "analytics",
          enhancedAccessibility:
            mode === "accessibility" || mode === "enterprise",
          advancedAnalytics: mode === "analytics" || mode === "enterprise",
        };

        console.log(
          `üöÄ Opening Scenario Reflection Modal in ${mode} mode:`,
          options,
        );

        try {
          currentModalInstance = new ScenarioReflectionModal(options);
          updateHealthMonitor();
        } catch (error) {
          console.error("‚ùå Failed to create modal:", error);
        }
      }

      // Update health monitor display
      function updateHealthMonitor() {
        if (!currentModalInstance) return;

        const metrics = currentModalInstance.getHealthMetrics();
        if (!metrics) return;

        document.getElementById("interaction-count").textContent =
          metrics.interactions;
        document.getElementById("error-count").textContent = metrics.errors;
        document.getElementById("circuit-breaker-state").textContent =
          metrics.circuitBreakerState;
        document.getElementById("uptime").textContent =
          `${Math.round(metrics.uptime)}ms`;
      }

      // Update monitor every second
      setInterval(updateHealthMonitor, 1000);

      // Listen for enterprise events
      if (window.eventDispatcher) {
        eventDispatcher.on("component-ready", (data) => {
          console.log("üéâ Component ready:", data);
          updateHealthMonitor();
        });

        eventDispatcher.on("user-interaction", (data) => {
          console.log("üëÜ User interaction:", data);
          updateHealthMonitor();
        });

        eventDispatcher.on("error-occurred", (data) => {
          console.log("‚ùå Error occurred:", data);
          updateHealthMonitor();
        });
      }

      console.log("üéØ Enhanced Scenario Reflection Modal demo ready!");
      console.log(
        "Features: Enterprise monitoring, health tracking, analytics, accessibility",
      );
    </script>
  </body>
</html>

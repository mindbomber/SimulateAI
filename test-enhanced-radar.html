<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Radar Chart Test - SimulateAI</title>
    <link rel="stylesheet" href="src/styles/radar-chart.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .test-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 2rem;
            margin: 1rem 0;
            border-radius: 16px;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.1),
                0 4px 16px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .controls {
            display: flex;
            gap: 1rem;
            margin: 1rem 0;
            flex-wrap: wrap;
        }
        button {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        button:active {
            transform: translateY(0);
        }
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 2rem;
        }
        h1 {
            color: white;
            text-align: center;
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        .container > p {
            color: rgba(255, 255, 255, 0.9);
            text-align: center;
            font-size: 1.1rem;
            margin-bottom: 2rem;
        }
        #debug-info {
            background: rgba(0, 0, 0, 0.8);
            color: #00ff00;
            padding: 1rem;
            border-radius: 8px;
            font-family: monospace;
            margin: 1rem 0;
            max-height: 200px;
            overflow-y: auto;
        }
        .radar-chart-container {
            min-height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéØ Enhanced Radar Chart Test</h1>
        <p>Testing the visually enhanced radar chart system for ethical decision visualization</p>
        
        <div id="debug-info">Initializing...</div>
        
        <div class="test-section">
            <h2>Real-time Scenario Radar Chart</h2>
            <p>Watch the dramatic visual enhancements as you make ethical decisions</p>
            
            <div class="controls">
                <button onclick="simulateAnswer('positive')">üü¢ Positive Impact</button>
                <button onclick="simulateAnswer('negative')">üî¥ Negative Impact</button>
                <button onclick="simulateAnswer('mixed')">üü° Mixed Impact</button>
                <button onclick="resetChart()">‚Üª Reset to Neutral</button>
            </div>
            
            <div class="grid">
                <div>
                    <h3>Current Scenario</h3>
                    <p id="scenario-description">
                        <strong>üöÉ Trolley Problem: Autonomous Vehicle Split</strong><br>
                        An AV must decide between hitting five pedestrians or swerving into a wall, killing the passenger.
                    </p>
                    <div id="answer-feedback"></div>
                </div>
                <div>
                    <div class="scenario-radar">
                        <div class="radar-title">‚ö° Ethical Impact Analysis</div>
                        <div class="radar-subtitle">Real-time preview of your decision impact</div>
                        <div id="scenario-chart" class="radar-chart-container">Loading chart...</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>Category Results Radar Chart</h2>
            <p>Experience the enhanced final results visualization</p>
            
            <div class="controls">
                <button onclick="showResults('balanced')">‚öñÔ∏è Balanced Results</button>
                <button onclick="showResults('utilitarian')">üìä Utilitarian Results</button>
                <button onclick="showResults('deontological')">üìã Deontological Results</button>
            </div>
            
            <div class="results-radar">
                <div class="radar-title">üèÜ Category Completion: Trolley Problem</div>
                <div class="radar-subtitle">Your ethical decision patterns across all scenarios</div>
                <div id="results-chart" class="radar-chart-container">Loading chart...</div>
            </div>
        </div>
    </div>

    <script>
        // Debug logging
        function log(message) {
            const debugEl = document.getElementById('debug-info');
            debugEl.innerHTML += '<br>' + new Date().toLocaleTimeString() + ': ' + message;
            debugEl.scrollTop = debugEl.scrollHeight;
            console.log(message);
        }
        
        log('Starting initialization...');
        log('Chart.js available: ' + (typeof Chart !== 'undefined'));
        
        // Simplified radar chart creation
        let scenarioChart, resultsChart;
        
        function createRadarChart(canvasId, title) {
            const canvas = document.createElement('canvas');
            canvas.width = 400;
            canvas.height = 400;
            canvas.id = canvasId + '-canvas';
            
            const container = document.getElementById(canvasId);
            container.innerHTML = '';
            container.appendChild(canvas);
            
            const ctx = canvas.getContext('2d');
            
            return new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Fairness', 'Sustainability', 'Autonomy', 'Beneficence', 
                            'Transparency', 'Accountability', 'Privacy', 'Proportionality'],
                    datasets: [{
                        label: title,
                        data: [3, 3, 3, 3, 3, 3, 3, 3],
                        backgroundColor: 'rgba(102, 126, 234, 0.2)',
                        borderColor: 'rgba(102, 126, 234, 0.8)',
                        borderWidth: 3,
                        pointBackgroundColor: [
                            '#667eea', '#764ba2', '#f093fb', '#f5576c',
                            '#4facfe', '#00f2fe', '#43e97b', '#38f9d7'
                        ],
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 6,
                        pointHoverRadius: 10,
                        tension: 0.2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: {
                        duration: 750,
                        easing: 'easeInOutQuart'
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                font: {
                                    size: 14,
                                    weight: '500'
                                },
                                color: '#2d3748',
                                usePointStyle: true
                            }
                        },
                        title: {
                            display: true,
                            text: title,
                            font: {
                                size: 18,
                                weight: 'bold'
                            },
                            color: '#1a202c'
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            min: 0,
                            max: 5,
                            ticks: {
                                stepSize: 1,
                                display: true,
                                backdropColor: 'rgba(255, 255, 255, 0.8)',
                                font: {
                                    size: 12,
                                    weight: '500'
                                },
                                color: '#4a5568'
                            },
                            grid: {
                                color: (context) => {
                                    const colors = [
                                        'rgba(239, 68, 68, 0.2)',   // 0 - red
                                        'rgba(245, 101, 101, 0.15)', // 1 - light red
                                        'rgba(251, 191, 36, 0.15)',  // 2 - yellow
                                        'rgba(156, 163, 175, 0.2)',  // 3 - gray (neutral)
                                        'rgba(34, 197, 94, 0.15)',   // 4 - light green
                                        'rgba(22, 163, 74, 0.2)'     // 5 - green
                                    ];
                                    return colors[context.index] || 'rgba(156, 163, 175, 0.1)';
                                },
                                lineWidth: 2
                            },
                            angleLines: {
                                color: 'rgba(156, 163, 175, 0.3)',
                                lineWidth: 1.5
                            },
                            pointLabels: {
                                display: true,
                                font: {
                                    size: 14,
                                    weight: '600'
                                },
                                color: '#2d3748'
                            }
                        }
                    }
                }
            });
        }
        
        // Initialize charts
        function initCharts() {
            try {
                log('Creating scenario chart...');
                scenarioChart = createRadarChart('scenario-chart', '‚ö° Decision Impact');
                log('Scenario chart created successfully');
                
                log('Creating results chart...');
                resultsChart = createRadarChart('results-chart', 'üèÜ Final Results');
                log('Results chart created successfully');
                
                log('All charts initialized!');
            } catch (error) {
                log('Error creating charts: ' + error.message);
                console.error('Chart creation error:', error);
            }
        }
        
        // Simulate answer selection with enhanced visuals
        window.simulateAnswer = function(type) {
            const impacts = {
                positive: [5, 4, 4, 5, 4, 4, 3, 4],
                negative: [1, 2, 2, 1, 2, 2, 3, 2],
                mixed: [4, 2, 5, 2, 4, 1, 3, 3]
            };
            
            if (scenarioChart && impacts[type]) {
                log('Applying ' + type + ' impact...');
                
                // Add visual feedback
                const chartContainer = document.querySelector('.scenario-radar');
                chartContainer.classList.add('radar-updating');
                
                setTimeout(() => {
                    scenarioChart.data.datasets[0].data = impacts[type];
                    
                    // Update colors based on impact
                    const colors = impacts[type].map(score => {
                        if (score <= 1) return '#ef4444';
                        if (score <= 2) return '#f87171';
                        if (score < 3) return '#fbbf24';
                        if (score === 3) return '#9ca3af';
                        if (score < 5) return '#22c55e';
                        return '#16a34a';
                    });
                    
                    scenarioChart.data.datasets[0].pointBackgroundColor = colors;
                    scenarioChart.data.datasets[0].borderColor = colors[0];
                    scenarioChart.data.datasets[0].backgroundColor = colors[0] + '20';
                    
                    scenarioChart.update('active');
                    
                    chartContainer.classList.remove('radar-updating');
                    chartContainer.classList.add('radar-updated');
                    
                    setTimeout(() => {
                        chartContainer.classList.remove('radar-updated');
                    }, 600);
                    
                    log('Chart updated with ' + type + ' values');
                }, 300);
                
                // Enhanced feedback
                const feedback = document.getElementById('answer-feedback');
                const impactColor = type === 'positive' ? '#22c55e' : type === 'negative' ? '#ef4444' : '#f59e0b';
                const impactEmoji = type === 'positive' ? '‚úÖ' : type === 'negative' ? '‚ùå' : '‚ö†Ô∏è';
                
                feedback.innerHTML = `
                    <div style="
                        padding: 1.5rem; 
                        background: linear-gradient(135deg, ${impactColor}15 0%, ${impactColor}05 100%);
                        border-radius: 12px; 
                        margin-top: 1rem;
                        border-left: 4px solid ${impactColor};
                        backdrop-filter: blur(10px);
                        transform: scale(0.95);
                        animation: feedbackPop 0.3s ease forwards;
                    ">
                        <strong style="color: ${impactColor};">${impactEmoji} Answer Impact:</strong> 
                        <span style="color: #4a5568;">You chose a <strong>${type}</strong> impact answer. 
                        Watch the dramatic changes in the radar chart!</span>
                    </div>
                    <style>
                        @keyframes feedbackPop {
                            to { transform: scale(1); }
                        }
                    </style>
                `;
            }
        };
        
        // Reset chart
        window.resetChart = function() {
            if (scenarioChart) {
                log('Resetting chart to neutral...');
                scenarioChart.data.datasets[0].data = [3, 3, 3, 3, 3, 3, 3, 3];
                scenarioChart.data.datasets[0].pointBackgroundColor = '#9ca3af';
                scenarioChart.data.datasets[0].borderColor = 'rgba(102, 126, 234, 0.8)';
                scenarioChart.data.datasets[0].backgroundColor = 'rgba(102, 126, 234, 0.2)';
                scenarioChart.update('active');
                document.getElementById('answer-feedback').innerHTML = '';
                log('Chart reset to neutral state');
            }
        };
        
        // Show different result patterns
        window.showResults = function(pattern) {
            const patterns = {
                balanced: [3, 3, 3, 3, 3, 3, 3, 3],
                utilitarian: [2, 4, 2, 5, 2, 3, 2, 4],
                deontological: [5, 3, 5, 3, 4, 5, 4, 3]
            };
            
            if (resultsChart && patterns[pattern]) {
                log('Showing ' + pattern + ' results pattern...');
                resultsChart.data.datasets[0].data = patterns[pattern];
                
                // Update colors
                const colors = patterns[pattern].map(score => {
                    if (score <= 1) return '#ef4444';
                    if (score <= 2) return '#f87171';
                    if (score < 3) return '#fbbf24';
                    if (score === 3) return '#9ca3af';
                    if (score < 5) return '#22c55e';
                    return '#16a34a';
                });
                
                resultsChart.data.datasets[0].pointBackgroundColor = colors;
                resultsChart.update('active');
                log('Results updated to ' + pattern + ' pattern');
            }
        };
        
        // Initialize when page loads
        if (typeof Chart !== 'undefined') {
            log('Chart.js is ready, initializing charts...');
            initCharts();
        } else {
            log('Chart.js not available, waiting...');
            setTimeout(() => {
                if (typeof Chart !== 'undefined') {
                    initCharts();
                } else {
                    log('Chart.js failed to load');
                }
            }, 1000);
        }
    </script>
</body>
</html>
